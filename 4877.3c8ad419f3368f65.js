"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[4877],{93861:(A,v,r)=>{r.d(v,{e:()=>g});class g{constructor(n){this.id=n&&n.id||null,this.station_name=n&&n.station_name||"",this.status=n&&n.status||0,this.orcudomain=n&&n.orcudomain||"",this.port=n&&n.port||0,this.site_code=n&&n.site_code||0,this.ho_role=n&&n.ho_role||0,this.userws=n&&n.userws||"",this.passwordws=n&&n.passwordws||"",this.sync_every_x_minutes=n&&n.sync_every_x_minutes||0,this.first_sync=n&&n.first_sync||"",this.last_sync=n&&n.last_sync||"",this.userhocommunicator=n&&n.userhocommunicator||"",this.passhocommunicator=n&&n.passhocommunicator||"",this.geolocation=n&&n.geolocation||"",this.sync_status=n&&n.sync_status||0,this.last_fail_update=n&&n.last_fail_update||"",this.max_sync_attempts=n&&n.max_sync_attempts||0,this.current_failed_attempts=n&&n.current_failed_attempts||0,this.map_of_products_done=n&&n.map_of_products_done||0,this.type=n&&n.type||0,this.pump_status_every_x_seconds=n&&n.pump_status_every_x_seconds||0,this.mobile_delivery_mean_id=n&&n.mobile_delivery_mean_id||0,this.mobile_calibration_mean_id=n&&n.mobile_calibration_mean_id||0,this.mobile_initial_inventory=n&&n.mobile_initial_inventory||0,this.mobile_initial_inventory_timestamp=n&&n.mobile_initial_inventory_timestamp||0,this.mobile_unique_product_id=n&&n.mobile_unique_product_id||0,this.accountant_name=n&&n.accountant_name||"",this.accountant_email=n&&n.accountant_email||"",this.weighing_machine=n&&n.weighing_machine||0,this.chemical_analysis_machine=n&&n.chemical_analysis_machine||0,this.delivery_pumps=n&&n.delivery_pumps||[],this.cv_configuration_id=n&&n.cv_configuration_id||0,this.controller_type=n&&n.controller_type||0}}},63314:(A,v,r)=>{r.d(v,{q:()=>b});var g=r(48966),s=r(5e3),n=r(30277),p=r(20773);let b=(()=>{class h{constructor(c,m){this.dialog=c,this.data=m,c.disableClose=!0}ngOnInit(){}}return h.\u0275fac=function(c){return new(c||h)(s.Y36(g.so),s.Y36(g.WI))},h.\u0275cmp=s.Xpm({type:h,selectors:[["progress-dialog"]],decls:7,vars:3,consts:[[1,"progress-dialog-container"],["mat-dialog-title",""],["mat-dialog-content",""],["fxLayout","column","fxLayoutAlign","start center",1,"preview-content"],["diameter","100","strokeWidth","12","color","warn","mode","determinate",3,"value"]],template:function(c,m){1&c&&(s.TgZ(0,"div",0),s.TgZ(1,"h1",1),s._uU(2),s.qZA(),s.TgZ(3,"div",2),s._uU(4),s.qZA(),s.TgZ(5,"div",3),s._UZ(6,"mat-progress-spinner",4),s.qZA(),s.qZA()),2&c&&(s.xp6(2),s.Oqu(m.data.title),s.xp6(2),s.Oqu(m.data.message),s.xp6(2),s.Q6J("value",m.data.percent))},directives:[g.uh,g.xY,n.xw,n.Wh,p.Ou],styles:[".progress-dialog-container[_ngcontent-%COMP%]{width:300px;height:290px;overflow:unset;padding:0}.progress-dialog-container[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]{margin-bottom:-20px;padding:0;text-align:center;font-size:20px}.progress-dialog-container[_ngcontent-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{background:#0f192a;font-size:24px;text-align:center;color:#f5f5f5;width:auto;padding:20px}.progress-dialog-container[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]{padding:60px}"]}),h})()},64877:(A,v,r)=>{r.r(v),r.d(v,{StationsTableModule:()=>me});var g=r(69808),s=r(93075),n=r(61264),p=r(4940),b=r(7057),h=r(3299),Z=r(86087),c=r(84847),m=r(32075),u=r(18444),d=r(63314),f=r(96831),S=r(92198),O=r(88914),L=r(14499),R=r(93861),y=r(70655);class B{constructor(l){this.id=l&&l.id||null,this.site_code=l&&l.site_code||0,this.pump_id=l&&l.pump_id||null,this.pump_head=l&&l.pump_head||null,this.pump_side=l&&l.pump_side||null,this.status_code=l&&l.status_code||0,this.station_id=l&&l.station_id||null}}var M=r(50150),C=r(48966),Y=r(37425),G=r(9360),q=r(52190),t=r(5e3),V=r(15702),$=r(31405),J=r(57261),K=r(59968),j=r(36551),N=r(25245),F=r(30277),I=r(92081);let X=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["loading"]],decls:2,vars:0,consts:[["id","pause",1,"loader"],["id","spinner"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.qZA())},styles:["#spinner[_ngcontent-%COMP%]{-webkit-animation:frames 1s infinite linear;animation:frames 1s infinite linear;background:transparent;border:.75vw solid #FFF;border-radius:100%;border-top-color:#0827b4;width:10vw;height:10vw;opacity:.6;padding:0;position:absolute;z-index:999;left:45%;top:45%}@-webkit-keyframes frames{0%{transform:rotate(0)}to{transform:rotate(359deg)}}@keyframes frames{0%{transform:rotate(0)}to{transform:rotate(359deg)}}#pause[_ngcontent-%COMP%]{display:block;background:rgba(0,0,0,.7) no-repeat 0 0;width:100%;height:100%;position:fixed;bottom:0;left:0;z-index:1000}.loader[_ngcontent-%COMP%]{position:absolute}"]}),a})();var U=r(67322),z=r(77531),W=r(74107),w=r(47423),tt=r(4834),et=r(90508),ot=r(32368),P=r(70024),Q=r(86856),at=r(77446);const st=["stationsModalForm"];function it(a,l){if(1&a&&(t.TgZ(0,"loading"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij("",e.isLoading," Conectando...")}}function nt(a,l){1&a&&t._uU(0,"Datos generales")}function rt(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.type)}}function lt(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.num_permiso+e.num_contrato_o_asignacion)}}function ct(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"form",8),t.YNc(1,nt,1,0,"ng-template",9),t.TgZ(2,"div",10),t.TgZ(3,"div",11),t.TgZ(4,"mat-form-field",12),t.TgZ(5,"mat-label"),t._uU(6,"N\xfamero de estaci\xf3n"),t.qZA(),t.TgZ(7,"input",13),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(8,"mat-form-field",12),t.TgZ(9,"mat-label"),t._uU(10,"Nombre de la estaci\xf3n"),t.qZA(),t._UZ(11,"input",14),t.qZA(),t.TgZ(12,"mat-form-field",12),t.TgZ(13,"mat-label"),t._uU(14,"Tipo de estaci\xf3n"),t.qZA(),t.TgZ(15,"mat-select",15),t.NdJ("selectionChange",function(i){return t.CHM(e),t.oxw().changeTypeOfStation(i)}),t.YNc(16,rt,2,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",10),t.TgZ(18,"div",11),t.TgZ(19,"mat-form-field",12),t.TgZ(20,"mat-label"),t._uU(21,"Ubicaci\xf3n de estaci\xf3n:"),t.qZA(),t._UZ(22,"input",17),t.TgZ(23,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().setPosition()}),t.TgZ(24,"mat-icon"),t._uU(25,"add_location"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"mat-form-field",12),t.TgZ(27,"mat-label"),t._uU(28,"Responsable de la estaci\xf3n"),t.qZA(),t._UZ(29,"input",19),t.qZA(),t.TgZ(30,"mat-form-field",12),t.TgZ(31,"mat-label"),t._uU(32,"Email del responsable de la estaci\xf3n"),t.qZA(),t._UZ(33,"input",20),t.qZA(),t.qZA(),t.qZA(),t.TgZ(34,"div",10),t.TgZ(35,"mat-form-field",12),t.TgZ(36,"mat-label"),t._uU(37,"Permiso CV del responsable"),t.qZA(),t.TgZ(38,"mat-select",21),t.YNc(39,lt,2,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(40,"div",22),t._UZ(41,"mat-divider"),t.qZA(),t.TgZ(42,"div",23),t.TgZ(43,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(44,"CANCELAR"),t.qZA(),t.TgZ(45,"button",25),t._uU(46,"SIGUIENTE"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("formGroup",e.stationsModalForm),t.xp6(16),t.Q6J("ngForOf",e.typesOfStation),t.xp6(23),t.Q6J("ngForOf",e.cvConfigurations),t.xp6(6),t.Q6J("disabled",e.stationsModalForm.invalid)}}function mt(a,l){1&a&&t._uU(0,"Par\xe1metros de comunicaci\xf3n")}function ut(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.type)}}function _t(a,l){if(1&a&&(t.TgZ(0,"button",25),t._uU(1,"SIGUIENTE"),t.qZA()),2&a){const e=t.oxw(2);t.Q6J("disabled",e.stationsModalForm.invalid)}}function pt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).submit()}),t._uU(1,"GUARDAR ESTACI\xd3N"),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",e.stationsModalForm.invalid)}}function dt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"form",8),t.YNc(1,mt,1,0,"ng-template",9),t.TgZ(2,"div",10),t.TgZ(3,"div",11),t.TgZ(4,"mat-form-field",12),t.TgZ(5,"mat-label"),t._uU(6,"Usuario para servicios web"),t.qZA(),t._UZ(7,"input",27),t.qZA(),t.TgZ(8,"mat-form-field",12),t.TgZ(9,"mat-label"),t._uU(10,"Contrase\xf1a para servicios web "),t.qZA(),t._UZ(11,"input",28),t.TgZ(12,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.hide=!i.hide}),t.TgZ(13,"mat-icon"),t._uU(14),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"mat-form-field",12),t.TgZ(16,"mat-label"),t._uU(17,"Host de la estaci\xf3n"),t.qZA(),t._UZ(18,"input",29),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",10),t.TgZ(20,"div",11),t.TgZ(21,"mat-form-field",12),t.TgZ(22,"mat-label"),t._uU(23,"Puerto de comunicaci\xf3n"),t.qZA(),t.TgZ(24,"input",30),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(25,"mat-form-field",12),t.TgZ(26,"mat-label"),t._uU(27,"Usuario de comunicaci\xf3n con HO "),t.qZA(),t._UZ(28,"input",31),t.qZA(),t.TgZ(29,"mat-form-field",12),t.TgZ(30,"mat-label"),t._uU(31,"Contrase\xf1a para usuario de comunicaci\xf3n con HO"),t.qZA(),t._UZ(32,"input",32),t.TgZ(33,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.hide=!i.hide}),t.TgZ(34,"mat-icon"),t._uU(35),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(36,"div",10),t.TgZ(37,"div",11),t.TgZ(38,"mat-form-field",12),t.TgZ(39,"mat-label"),t._uU(40,"Role de estaci\xf3n:"),t.qZA(),t.TgZ(41,"input",33),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(42,"mat-form-field",12),t.TgZ(43,"mat-label"),t._uU(44,"Frecuencia de sincronizaci\xf3n en minutos:"),t.qZA(),t.TgZ(45,"input",34),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(46,"mat-form-field",12),t.TgZ(47,"mat-label"),t._uU(48,"Segundos para actualizar estado de bombas:"),t.qZA(),t.TgZ(49,"input",35),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(50,"div",10),t.TgZ(51,"div",11),t.TgZ(52,"mat-form-field",12),t.TgZ(53,"mat-label"),t._uU(54,"N\xfamero m\xe1ximo de intentos de sincronizaci\xf3n:"),t.qZA(),t.TgZ(55,"input",36),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(56,"mat-form-field",12),t.TgZ(57,"mat-label"),t._uU(58,"Tipo de controlador"),t.qZA(),t.TgZ(59,"mat-select",37),t.YNc(60,ut,2,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(61,"div",38),t.TgZ(62,"mat-label"),t._uU(63,"Estatus:"),t.qZA(),t.TgZ(64,"mat-slide-toggle",39),t.NdJ("change",function(i){return t.CHM(e),t.oxw().setActiveStation(i)}),t._uU(65),t.qZA(),t.qZA(),t.TgZ(66,"div",22),t._UZ(67,"mat-divider"),t.qZA(),t.TgZ(68,"div",10),t.TgZ(69,"div",23),t.TgZ(70,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(71,"CANCELAR"),t.qZA(),t.TgZ(72,"button",40),t._uU(73,"ANTERIOR"),t.qZA(),t.YNc(74,_t,2,1,"button",41),t.YNc(75,pt,2,1,"button",42),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("formGroup",e.stationsCommForm),t.xp6(11),t.Q6J("type",e.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",e.hide),t.xp6(2),t.Oqu(e.hide?"visibility_off":"visibility"),t.xp6(18),t.Q6J("type",e.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",e.hide),t.xp6(2),t.Oqu(e.hide?"visibility_off":"visibility"),t.xp6(25),t.Q6J("ngForOf",e.controllerTypes),t.xp6(5),t.hij("",e.active_label," "),t.xp6(9),t.Q6J("ngIf",null!==e.station.id&&2===e.station.status&&e.remote_products.length>0),t.xp6(1),t.Q6J("ngIf",null===e.station.id||2!==e.station.status||!(e.remote_products.length>0))}}function ht(a,l){1&a&&t._uU(0,"Configuraci\xf3n para estaci\xf3n m\xf3vil")}function gt(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.NAME)}}function ft(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.NAME)}}function vt(a,l){if(1&a&&(t.TgZ(0,"button",54),t._uU(1,"SIGUIENTE "),t.qZA()),2&a){const e=t.oxw(2);t.Q6J("disabled",e.stationsMobileDataForm.invalid)}}function bt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).submit()}),t._uU(1,"GUARDAR ESTACI\xd3N "),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",e.stationsMobileDataForm.invalid)}}function Zt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",5),t.TgZ(1,"form",8),t.YNc(2,ht,1,0,"ng-template",9),t.TgZ(3,"div",11),t.TgZ(4,"mat-form-field",44),t.TgZ(5,"mat-label"),t._uU(6,"Dispositivo para llenado de tanque"),t.qZA(),t.TgZ(7,"mat-select",45),t.YNc(8,gt,2,2,"mat-option",16),t.qZA(),t.qZA(),t.TgZ(9,"mat-form-field",44),t.TgZ(10,"mat-label"),t._uU(11,"Dispositivo para jarreos de tanque"),t.qZA(),t.TgZ(12,"mat-select",46),t.YNc(13,ft,2,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",11),t.TgZ(15,"mat-form-field",12),t.TgZ(16,"mat-label"),t._uU(17,"Inventario inicial del tanque"),t.qZA(),t.TgZ(18,"input",47),t.NdJ("keypress",function(i){return t.CHM(e),t.oxw().integersOnly(i)}),t.qZA(),t.qZA(),t.TgZ(19,"mat-form-field",12),t.TgZ(20,"mat-label"),t._uU(21,"Desde fecha:"),t.qZA(),t._UZ(22,"input",48),t.TgZ(23,"mat-datepicker-toggle",49),t.TgZ(24,"mat-icon",50),t._uU(25,"date_range"),t.qZA(),t.qZA(),t._UZ(26,"ngx-mat-datetime-picker",null,51),t.qZA(),t.qZA(),t.TgZ(28,"div",22),t._UZ(29,"mat-divider"),t.qZA(),t.TgZ(30,"div",10),t.TgZ(31,"div",23),t.TgZ(32,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(33,"CANCELAR"),t.qZA(),t.TgZ(34,"button",52),t._uU(35,"ANTERIOR"),t.qZA(),t.YNc(36,vt,2,1,"button",53),t.YNc(37,bt,2,1,"button",42),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(27),o=t.oxw();t.Q6J("stepControl",o.stationsMobileDataForm),t.xp6(1),t.Q6J("formGroup",o.stationsMobileDataForm),t.xp6(7),t.Q6J("ngForOf",o.means),t.xp6(5),t.Q6J("ngForOf",o.means),t.xp6(9),t.Q6J("ngxMatDatetimePicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(13),t.Q6J("ngIf",null!==o.station.id&&2==o.station.status&&o.remote_products.length>0),t.xp6(1),t.Q6J("ngIf",null===o.station.id||2!=o.station.status||!(o.remote_products.length>0))}}function xt(a,l){1&a&&t._uU(0,"Configuraci\xf3n para estaci\xf3n est\xe1tica")}function Tt(a,l){if(1&a&&(t.TgZ(0,"div",63),t.TgZ(1,"mat-checkbox",64),t._uU(2),t.qZA(),t.qZA()),2&a){const e=l.$implicit;t.xp6(1),t.MGl("id","pump_",e.SIDE,""),t.MGl("formControlName","pump_",e.SIDE,""),t.xp6(1),t.hij("Bomba ",e.SIDE,"")}}function yt(a,l){if(1&a&&(t.TgZ(0,"button",54),t._uU(1,"SIGUIENTE "),t.qZA()),2&a){const e=t.oxw(2);t.Q6J("disabled",e.stationsStaticDataForm.invalid)}}function At(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",5),t.TgZ(1,"form",8),t.YNc(2,xt,1,0,"ng-template",9),t.TgZ(3,"div",55),t._uU(4,"Configuraciones adicionales para Seritrac."),t.qZA(),t.TgZ(5,"div",56),t.TgZ(6,"mat-checkbox",57),t._uU(7,"La estaci\xf3n utiliza b\xe1sculas antes de recibir combustible."),t.qZA(),t.qZA(),t.TgZ(8,"div",56),t.TgZ(9,"mat-checkbox",58),t._uU(10,"La estaci\xf3n realiza an\xe1lisis qu\xedmicos de combustible."),t.qZA(),t.qZA(),t._UZ(11,"mat-divider"),t.TgZ(12,"div",59),t._uU(13,"Bombas para registrar ingresos de combustible."),t.qZA(),t.YNc(14,Tt,3,3,"div",60),t.TgZ(15,"div",61),t.TgZ(16,"button",62),t.NdJ("click",function(){return t.CHM(e),t.oxw().checkAllPumps(!0)}),t.TgZ(17,"mat-icon"),t._uU(18,"check_box"),t.qZA(),t._uU(19,"\xa0Todas"),t.qZA(),t.TgZ(20,"button",62),t.NdJ("click",function(){return t.CHM(e),t.oxw().checkAllPumps(!1)}),t.TgZ(21,"mat-icon"),t._uU(22,"check_box_outline_blank"),t.qZA(),t._uU(23,"\xa0Ninguna"),t.qZA(),t.qZA(),t.TgZ(24,"div",22),t._UZ(25,"mat-divider"),t.qZA(),t.TgZ(26,"div",10),t.TgZ(27,"div",23),t.TgZ(28,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(29,"CANCELAR"),t.qZA(),t.TgZ(30,"button",52),t._uU(31,"ANTERIOR"),t.qZA(),t.YNc(32,yt,2,1,"button",53),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("stepControl",e.stationsStaticDataForm),t.xp6(1),t.Q6J("formGroup",e.stationsStaticDataForm),t.xp6(13),t.Q6J("ngForOf",e.pumps),t.xp6(18),t.Q6J("ngIf",null!==e.station.id&&2==e.station.status&&e.remote_products.length>0)}}function St(a,l){1&a&&t._uU(0,"Mapa de productos")}function Ct(a,l){if(1&a&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function It(a,l){if(1&a&&(t.TgZ(0,"div",67),t.TgZ(1,"mat-form-field",68),t.TgZ(2,"mat-label"),t._uU(3,"Id producto remoto:"),t.qZA(),t._UZ(4,"input",69),t.qZA(),t.TgZ(5,"mat-form-field",68),t.TgZ(6,"mat-label"),t._uU(7,"Nombre producto remoto:"),t.qZA(),t._UZ(8,"input",69),t.qZA(),t.TgZ(9,"mat-form-field",68),t.TgZ(10,"mat-label"),t._uU(11,"C\xf3digo remoto:"),t.qZA(),t._UZ(12,"input",69),t.qZA(),t.TgZ(13,"mat-form-field",70),t.TgZ(14,"mat-label"),t._uU(15,"Nombre producto HO"),t.qZA(),t.TgZ(16,"mat-select",71),t.YNc(17,Ct,2,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA()),2&a){const e=l.index,o=t.oxw(2);t.uIk("data-index",e),t.xp6(4),t.MGl("formControlName","remote_product_id_",e,""),t.xp6(4),t.MGl("formControlName","remote_product_name_",e,""),t.xp6(4),t.MGl("formControlName","remote_product_code_",e,""),t.xp6(4),t.MGl("formControlName","local_product_id_",e,""),t.xp6(1),t.Q6J("ngForOf",o.local_products)}}function Pt(a,l){if(1&a&&(t.TgZ(0,"button",54),t._uU(1,"SIGUIENTE "),t.qZA()),2&a){const e=t.oxw(2);t.Q6J("disabled",e.mapProductsFormGroup.invalid)}}function Mt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).submit()}),t._uU(1,"GUARDAR ESTACI\xd3N"),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",e.mapProductsFormGroup.invalid)}}function Ft(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",5),t.TgZ(1,"form",8),t.YNc(2,St,1,0,"ng-template",9),t.YNc(3,It,18,6,"div",65),t.TgZ(4,"div",10),t.TgZ(5,"div",23),t.TgZ(6,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(7,"CANCELAR"),t.qZA(),t.TgZ(8,"button",66),t._uU(9,"ANTERIOR"),t.qZA(),t.YNc(10,Pt,2,1,"button",53),t.YNc(11,Mt,2,1,"button",42),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("stepControl",e.mapProductsFormGroup),t.xp6(1),t.Q6J("formGroup",e.mapProductsFormGroup),t.xp6(2),t.Q6J("ngForOf",e.remote_products),t.xp6(7),t.Q6J("ngIf",1==e.station.map_of_products_done),t.xp6(1),t.Q6J("ngIf",0==e.station.map_of_products_done)}}function Ut(a,l){1&a&&t._uU(0,"Uso de los tanques")}function kt(a,l){if(1&a&&(t.TgZ(0,"div",73),t.TgZ(1,"div",74),t.TgZ(2,"mat-form-field",75),t.TgZ(3,"mat-label"),t._uU(4,"Id tanque:"),t.qZA(),t._UZ(5,"input",69),t.qZA(),t.TgZ(6,"mat-form-field",75),t.TgZ(7,"mat-label"),t._uU(8,"Tanque"),t.qZA(),t._UZ(9,"input",69),t.qZA(),t.TgZ(10,"mat-form-field",75),t.TgZ(11,"mat-label"),t._uU(12,"N\xfamero de tanque:"),t.qZA(),t._UZ(13,"input",69),t.qZA(),t.qZA(),t.TgZ(14,"div",74),t.TgZ(15,"mat-form-field",75),t.TgZ(16,"mat-label"),t._uU(17,"Producto:"),t.qZA(),t._UZ(18,"input",69),t.qZA(),t.TgZ(19,"mat-form-field",75),t.TgZ(20,"mat-label"),t._uU(21,"Capacidad:"),t.qZA(),t._UZ(22,"input",69),t.qZA(),t.TgZ(23,"mat-form-field",75),t.TgZ(24,"mat-label"),t._uU(25,"Uso del tanque:"),t.qZA(),t.TgZ(26,"mat-select",71),t.TgZ(27,"mat-option",26),t._uU(28,"Solo recepci\xf3n"),t.qZA(),t.TgZ(29,"mat-option",26),t._uU(30,"Recepci\xf3n y despacho"),t.qZA(),t.TgZ(31,"mat-option",26),t._uU(32,"Solo despacho"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(33,"mat-divider"),t.qZA()),2&a){const e=l.index;t.uIk("data-index",e),t.xp6(5),t.MGl("formControlName","tank_id_",e,""),t.xp6(4),t.MGl("formControlName","tank_name_",e,""),t.xp6(4),t.MGl("formControlName","tank_number_",e,""),t.xp6(5),t.MGl("formControlName","product_name_",e,""),t.xp6(4),t.MGl("formControlName","capacity_",e,""),t.xp6(4),t.MGl("formControlName","tank_use_",e,""),t.xp6(1),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1),t.xp6(2),t.Q6J("value",2)}}function qt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"mat-step",5),t.TgZ(1,"form",8),t.YNc(2,Ut,1,0,"ng-template",9),t.YNc(3,kt,34,10,"div",72),t.TgZ(4,"div",10),t.TgZ(5,"div",23),t.TgZ(6,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().close()}),t._uU(7,"CANCELAR"),t.qZA(),t.TgZ(8,"button",52),t._uU(9,"ANTERIOR"),t.qZA(),t.TgZ(10,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw().submit()}),t._uU(11,"GUARDAR ESTACI\xd3N"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("stepControl",e.tanksUsageFormGroup),t.xp6(1),t.Q6J("formGroup",e.tanksUsageFormGroup),t.xp6(2),t.Q6J("ngForOf",e.tanks),t.xp6(7),t.Q6J("disabled",e.tanksUsageFormGroup.invalid)}}let E=(()=>{class a{constructor(e,o,i,_,x,T,k){this.data=e,this.dialogRef=o,this._meansService=i,this._cvConfigurationsService=_,this.snackbar=x,this.productsService=T,this.stationsService=k,this.title="Estaciones de despacho de combustible",this.status_color=new M.Il(0,0,0),this.station=new R.e,this.mapProductsFormGroup=new s.cw({}),this.tanksUsageFormGroup=new s.cw({}),this.remote_products=[],this.tanks=[],this.tanks_t=[],this.local_products=[],this.map_of_products=[],this.isLoading=!1,this.typesOfStation=[{id:1,type:"Est\xe1tica"},{id:2,type:"M\xf3vil"}],this.controllerTypes=[{id:1,type:"nORCU Prime"},{id:2,type:"ORCU"}],this.means=[],this.pumps=[],this.cvConfigurations=[],this.active_label="Inactiva",this.hide=!0,this.isLoading=!0,o.disableClose=!0,this.stationsModalForm=new s.cw({id:new s.NI,station_name:new s.NI("",[s.kI.required]),site_code:new s.NI("",[s.kI.required,s.kI.pattern("^[0-9]{1,6}$")]),type:new s.NI(1),geolocation:new s.NI(""),map_of_products_done:new s.NI(0),accountant_name:new s.NI(""),accountant_email:new s.NI(""),cv_configuration_id:new s.NI}),this.stationsCommForm=new s.cw({userws:new s.NI("",[s.kI.required]),passwordws:new s.NI("",[s.kI.required,s.kI.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$")]),orcudomain:new s.NI("0.0.0.0",[s.kI.required]),port:new s.NI("443",[s.kI.required,s.kI.pattern("^[1-9][0-9]{2,6}$")]),userhocommunicator:new s.NI("",[s.kI.required]),passhocommunicator:new s.NI("",[s.kI.required,s.kI.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$")]),ho_role:new s.NI("3",[s.kI.required]),sync_every_x_minutes:new s.NI(5,[s.kI.required,s.kI.max(1440)]),pump_status_every_x_seconds:new s.NI(3,[s.kI.pattern("^[1-9][0-9]{0,2}$")]),max_sync_attempts:new s.NI(1,[s.kI.required,s.kI.min(1)]),sync_status:new s.NI(0),controller_type:new s.NI("",[s.kI.required]),status:new s.NI(!1)}),this.stationsMobileDataForm=new s.cw({mobile_delivery_mean_id:new s.NI,mobile_calibration_mean_id:new s.NI,mobile_initial_inventory:new s.NI,mobile_initial_inventory_timestamp:new s.NI(new Date),mobile_unique_product_id:new s.NI}),this.stationsStaticDataForm=new s.cw({weighing_machine:new s.NI,chemical_analysis_machine:new s.NI})}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){this.means=yield this.getMeans(),this.cvConfigurations=yield this.getCvConfigurations(),this.data&&(this.station=this.data,this.stationsModalForm.setValue({id:this.station.id,station_name:this.station.station_name,site_code:this.station.site_code,type:this.station.type,geolocation:this.station.geolocation,map_of_products_done:this.station.map_of_products_done,accountant_name:this.station.accountant_name,accountant_email:this.station.accountant_email,cv_configuration_id:this.station.cv_configuration_id}),this.stationsCommForm.setValue({userws:this.station.userws,passwordws:this.station.passwordws,orcudomain:this.station.orcudomain,port:this.station.port,userhocommunicator:this.station.userhocommunicator,passhocommunicator:this.station.passhocommunicator,ho_role:this.station.ho_role,sync_every_x_minutes:this.station.sync_every_x_minutes,pump_status_every_x_seconds:this.station.pump_status_every_x_seconds,max_sync_attempts:this.station.max_sync_attempts,sync_status:this.station.sync_status,controller_type:this.station.controller_type,status:2===this.station.status}),2==this.station.type&&(this.stationsMobileDataForm.patchValue({mobile_delivery_mean_id:+this.station.mobile_delivery_mean_id,mobile_calibration_mean_id:+this.station.mobile_calibration_mean_id,mobile_initial_inventory:this.station.mobile_initial_inventory,mobile_initial_inventory_timestamp:null==this.station.mobile_initial_inventory_timestamp?new Date:new Date(this.station.mobile_initial_inventory_timestamp),mobile_unique_product_id:this.station.mobile_unique_product_id}),this.stationsMobileDataForm.controls.mobile_delivery_mean_id.setValidators(s.kI.required),this.stationsMobileDataForm.controls.mobile_calibration_mean_id.setValidators(s.kI.required)),this.local_products=yield this.getLocalProducts(),this.active_label=2===this.station.status?"Activa":"Inactiva",2==this.station.status&&(yield this.getPumps().then(e=>{this.pumps=e;for(let o=0;o<this.pumps.length;o++)this.stationsStaticDataForm.addControl("pump_"+this.pumps[o].SIDE,new s.NI("",[s.kI.required])),this.stationsStaticDataForm.controls["pump_"+this.pumps[o].SIDE].setValue(!!this.station.delivery_pumps.find(i=>i.pump_side==this.pumps[o].SIDE)),1==this.station.type&&(this.stationsStaticDataForm.controls.weighing_machine.setValue(1==this.station.weighing_machine),this.stationsStaticDataForm.controls.chemical_analysis_machine.setValue(1==this.station.chemical_analysis_machine))}).catch(e=>{this.pumps=[],this.station.status=1,this.stationsCommForm.controls.status.setValue(!1),this.active_label="Inactiva",this.stationsStaticDataForm.controls.weighing_machine.setValue(1==this.station.weighing_machine),this.stationsStaticDataForm.controls.chemical_analysis_machine.setValue(1==this.station.chemical_analysis_machine),alert("No hay conexi\xf3n con la estaci\xf3n y ser\xe1 desactivada para obtener datos remotos, "+e.error.message)}),this.pumps.length>0&&(yield this.getRemoteProducts().then(e=>{this.remote_products=e;for(let o=0;o<this.remote_products.length;o++)this.mapProductsFormGroup.addControl("remote_product_id_"+o,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("remote_product_name_"+o,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("remote_product_code_"+o,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("local_product_id_"+o,new s.NI("",[s.kI.required]))}).catch(e=>{this.station.status=1,this.stationsCommForm.controls.status.setValue(!1),this.active_label="Inactiva",alert("No hay conexi\xf3n con el servidor la estaci\xf3n ser\xe1 desactivada para obtener datos remotos")}),yield this.getMapOfProducts().then(e=>{this.map_of_products=e,console.log("mapa de productos",e),console.log("productos remotos",this.remote_products);for(let o=0;o<this.remote_products.length;o++){if(this.mapProductsFormGroup.controls["remote_product_id_"+o].setValue(this.remote_products[o].id),this.mapProductsFormGroup.controls["remote_product_name_"+o].setValue(this.remote_products[o].name),this.mapProductsFormGroup.controls["remote_product_code_"+o].setValue(this.remote_products[o].code),1==this.station.map_of_products_done){for(let i=0;i<this.map_of_products.length;i++)if(this.map_of_products[i].remote_product_id===this.remote_products[o].id){this.mapProductsFormGroup.controls["local_product_id_"+o].setValue(this.map_of_products[i].product_id);break}this.mapProductsFormGroup.controls["local_product_id_"+o].disable()}else this.mapProductsFormGroup.controls["local_product_id_"+o].enable();this.mapProductsFormGroup.controls["remote_product_id_"+o].disable(),this.mapProductsFormGroup.controls["remote_product_name_"+o].disable(),this.mapProductsFormGroup.controls["remote_product_code_"+o].disable()}}).catch(e=>{this.station.status=1,this.mapProductsFormGroup.controls.status.setValue(!1),this.active_label="Inactiva",alert("No hay conexi\xf3n con el servidor la estaci\xf3n ser\xe1 desactivada para obtener datos remotos error")})),1==this.station.map_of_products_done&&this.stationsService.getRemoteTanks(this.station).subscribe(e=>{this.tanks=e[0];for(let o=0;o<this.tanks.length;o++)this.tanksUsageFormGroup.addControl("tank_id_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.addControl("tank_name_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.addControl("tank_number_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.addControl("product_name_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.addControl("capacity_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.addControl("tank_use_"+o,new s.NI("",[s.kI.required])),this.tanksUsageFormGroup.controls["tank_id_"+o].setValue(this.tanks[o].ID),this.tanksUsageFormGroup.controls["tank_name_"+o].setValue(this.tanks[o].NAME),this.tanksUsageFormGroup.controls["tank_number_"+o].setValue(this.tanks[o].NUMBER),this.tanksUsageFormGroup.controls["product_name_"+o].setValue(this.tanks[o].local_product_name),this.tanksUsageFormGroup.controls["capacity_"+o].setValue(this.tanks[o].CAPACITY),this.tanksUsageFormGroup.controls["tank_use_"+o].setValue(""!==this.tanks[o].tank_use?this.tanks[o].tank_use:1),this.tanksUsageFormGroup.controls["tank_id_"+o].disable(),this.tanksUsageFormGroup.controls["tank_name_"+o].disable(),this.tanksUsageFormGroup.controls["tank_number_"+o].disable(),this.tanksUsageFormGroup.controls["product_name_"+o].disable(),this.tanksUsageFormGroup.controls["capacity_"+o].disable()},e=>{console.log("I should not appear 4, ",e.error.message)}))),this.isLoading=!1})}getRemoteProducts(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this.stationsService.getRemoteProducts(this.station).toPromise()})}getLocalProducts(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this.productsService.getAll().toPromise()})}getMapOfProducts(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this.stationsService.getMapOfProducts(this.station).toPromise()})}getMeans(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this._meansService.getAll().toPromise()})}getCvConfigurations(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this._cvConfigurationsService.getAll().toPromise()})}promiseWithTimeout(e,o,i=new Error("Promise timed out")){const _=new Promise((x,T)=>{setTimeout(()=>{T(i)},o)});return Promise.race([e,_])}getPumps(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this.stationsService.getPumps(this.station.site_code).toPromise()})}submit(){this.station.station_name=this.stationsModalForm.controls.station_name.value,this.station.site_code=this.stationsModalForm.controls.site_code.value,this.station.type=this.stationsModalForm.controls.type.value,this.station.geolocation=this.stationsModalForm.controls.geolocation.value,this.station.map_of_products_done=this.stationsModalForm.controls.map_of_products_done.value,this.station.accountant_name=this.stationsModalForm.controls.accountant_name.value,this.station.accountant_email=this.stationsModalForm.controls.accountant_email.value,this.station.cv_configuration_id=this.stationsModalForm.controls.cv_configuration_id.value,this.station.userws=this.stationsCommForm.controls.userws.value,this.station.passwordws=this.stationsCommForm.controls.passwordws.value,this.station.userhocommunicator=this.stationsCommForm.controls.userhocommunicator.value,this.station.passhocommunicator=this.stationsCommForm.controls.passhocommunicator.value,this.station.orcudomain=this.stationsCommForm.controls.orcudomain.value,this.station.port=this.stationsCommForm.controls.port.value,this.station.ho_role=this.stationsCommForm.controls.ho_role.value,this.station.sync_every_x_minutes=this.stationsCommForm.controls.sync_every_x_minutes.value,this.station.max_sync_attempts=this.stationsCommForm.controls.max_sync_attempts.value,this.station.pump_status_every_x_seconds=this.stationsCommForm.controls.pump_status_every_x_seconds.value,this.station.status=this.stationsCommForm.controls.status.value?2:1,this.station.controller_type=this.stationsCommForm.controls.controller_type.value,this.station.mobile_delivery_mean_id=this.stationsMobileDataForm.controls.mobile_delivery_mean_id.value,this.station.mobile_calibration_mean_id=this.stationsMobileDataForm.controls.mobile_calibration_mean_id.value,this.station.mobile_initial_inventory=this.stationsMobileDataForm.controls.mobile_initial_inventory.value,this.station.mobile_initial_inventory_timestamp=this.getMysqlDatetime(this.stationsMobileDataForm.controls.mobile_initial_inventory_timestamp.value),this.station.mobile_unique_product_id=this.stationsMobileDataForm.controls.mobile_unique_product_id.value,console.log(this.station),this.map_of_products=[];for(let e=0;e<this.remote_products.length;e++)this.map_of_products[e]={product_id:this.mapProductsFormGroup.controls["local_product_id_"+e].value,site_code:this.station.site_code,remote_product_id:this.mapProductsFormGroup.controls["remote_product_id_"+e].value,remote_product_name:this.mapProductsFormGroup.controls["remote_product_name_"+e].value,remote_product_code:this.mapProductsFormGroup.controls["remote_product_code_"+e].value};if(this.tanks_t=[],1==this.station.map_of_products_done)for(let e=0;e<this.tanks.length;e++)this.tanks_t[e]={site_code:this.station.site_code,tank_id:this.tanks[e].ID,tank_number:this.tanks[e].NUMBER,name:this.tanks[e].NAME,product_id:this.tanks[e].local_product_id,remote_product_id:this.tanks[e].PRODUCT_ID,capacity:this.tanks[e].CAPACITY,status:2,tank_use:this.tanksUsageFormGroup.controls["tank_use_"+e].value};this.station.weighing_machine=this.stationsStaticDataForm.controls.weighing_machine.value?1:0,this.station.chemical_analysis_machine=this.stationsStaticDataForm.controls.chemical_analysis_machine.value?1:0,this.station.delivery_pumps=[];for(let e=0;e<this.pumps.length;e++){let o=new B;this.stationsStaticDataForm.controls["pump_"+this.pumps[e].SIDE].value&&(o.pump_id=this.pumps[e].ID,o.pump_head=this.pumps[e].PUMP_HEAD,o.pump_side=this.pumps[e].SIDE,o.site_code=this.station.site_code,o.station_id=this.station.id,o.status_code=this.pumps[e].STATUS_CODE,this.station.delivery_pumps.push(o))}null===this.station.id?this.createStation():this.updateStation()}createStation(){this.isLoading=!0,this.stationsService.create(this.station).subscribe(e=>{this.snackbar.open(e.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"create",data:this.station})},e=>{this.snackbar.open(e,null,{duration:5e3,panelClass:["red-snackbar"]}),this.stationsCommForm.controls.status.setValue(!1),this.isLoading=!1})}updateStation(){this.isLoading=!0,this.stationsService.update(this.station).subscribe(e=>{this.map_of_products.length>0&&0==this.station.map_of_products_done?this.stationsService.setMapOfProducts(this.map_of_products,this.station.site_code).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"update",response:this.station})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]}),this.stationsCommForm.controls.status.setValue(!1)}):1==this.station.map_of_products_done?this.stationsService.setTanksT(this.tanks_t).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"update",response:this.station})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]}),this.stationsCommForm.controls.status.setValue(!1)}):(this.snackbar.open(e.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"update",response:this.station})),this.isLoading=!1},e=>{this.snackbar.open(e,null,{duration:5e3,panelClass:["red-snackbar"]}),this.stationsCommForm.controls.status.setValue(!1),this.station.status=1,this.isLoading=!1})}close(){this.dialogRef.close({action:"cancel",data:this.station})}hexToColor(e){var _=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(e),x=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(e);return _?new M.Il(parseInt(_[1],16),parseInt(_[2],16),parseInt(_[3],16)):x?new M.Il(parseInt(_[1],16),parseInt(_[2],16),parseInt(_[3],16),parseInt(_[4],16)):new M.Il(0,0,0)}integersOnly(e){let o=e.target.value+e.key;return!!new RegExp(/^[1-9][0-9]{0,5}$/).test(o)}numbersDots(e){let o=e.target.value+e.key;return!!new RegExp(/^([1-9][0-9]{0,7}||[0]||[0][.][0-9]{0,2}||[1-9][0-9]{0,7}[.][0-9]{0,2})$/).test(o)}setPosition(){console.log("to be implemented...")}setActiveStation(e){return(0,y.mG)(this,void 0,void 0,function*(){this.local_products=yield this.getLocalProducts(),e.checked?(this.isLoading=!0,yield this.getPumps().then(o=>{this.station.status=2,this.active_label="Activa",this.pumps=o;for(let i=0;i<this.pumps.length;i++)this.stationsStaticDataForm.addControl("pump_"+this.pumps[i].SIDE,new s.NI("",[s.kI.required])),this.stationsStaticDataForm.controls["pump_"+this.pumps[i].SIDE].setValue(!!this.station.delivery_pumps.find(_=>_.pump_side==this.pumps[i].SIDE)),1==this.station.type&&(this.stationsStaticDataForm.controls.weighing_machine.setValue(1==this.station.weighing_machine),this.stationsStaticDataForm.controls.chemical_analysis_machine.setValue(1==this.station.chemical_analysis_machine))}).catch(o=>{this.pumps=[],this.station.status=1,this.stationsCommForm.controls.status.setValue(!1),this.active_label="Inactiva",this.stationsStaticDataForm.controls.weighing_machine.setValue(1==this.station.weighing_machine),this.stationsStaticDataForm.controls.chemical_analysis_machine.setValue(1==this.station.chemical_analysis_machine),alert("No hay conexi\xf3n con el servidor la estaci\xf3n ser\xe1 desactivada para obtener datos remotos, "+o.error.message),this.isLoading=!1}),this.pumps.length>0&&(yield this.getRemoteProducts().then(o=>{this.remote_products=o;for(let i=0;i<this.remote_products.length;i++)this.mapProductsFormGroup.addControl("remote_product_id_"+i,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("remote_product_name_"+i,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("remote_product_code_"+i,new s.NI("",[s.kI.required])),this.mapProductsFormGroup.addControl("local_product_id_"+i,new s.NI("",[s.kI.required]))}).catch(o=>{this.station.status=1,this.stationsCommForm.controls.status.setValue(!1),this.active_label="Inactiva",alert("No hay conexi\xf3n con el servidor la estaci\xf3n ser\xe1 desactivada para obtener datos remotos"),this.isLoading=!1}),yield this.getMapOfProducts().then(o=>{this.map_of_products=o;for(let i=0;i<this.remote_products.length;i++){if(this.mapProductsFormGroup.controls["remote_product_id_"+i].setValue(this.remote_products[i].id),this.mapProductsFormGroup.controls["remote_product_name_"+i].setValue(this.remote_products[i].name),this.mapProductsFormGroup.controls["remote_product_code_"+i].setValue(this.remote_products[i].code),1==this.station.map_of_products_done){for(let _=0;_<this.map_of_products.length;_++)if(this.map_of_products[_].remote_product_id===this.remote_products[i].id){this.mapProductsFormGroup.controls["local_product_id_"+i].setValue(+this.map_of_products[_].product_id);break}this.mapProductsFormGroup.controls["local_product_id_"+i].disable()}else this.mapProductsFormGroup.controls["local_product_id_"+i].enable();this.mapProductsFormGroup.controls["remote_product_id_"+i].disable(),this.mapProductsFormGroup.controls["remote_product_name_"+i].disable(),this.mapProductsFormGroup.controls["remote_product_code_"+i].disable()}}).catch(o=>{this.station.status=1,this.mapProductsFormGroup.controls.status.setValue(!1),this.active_label="Inactiva",alert("No hay conexi\xf3n con el servidor la estaci\xf3n ser\xe1 desactivada para obtener datos remotos"),this.isLoading=!1})),this.isLoading=!1):(this.station.status=1,this.active_label="Inactiva",this.remote_products=[],this.map_of_products=[],this.pumps=[])})}getMysqlDatetime(e){return null!==e?e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+":00":""}changeTypeOfStation(e){this.station.type=e.value,this.stationsStaticDataForm.controls.weighing_machine.setValue(1==this.station.weighing_machine),this.stationsStaticDataForm.controls.chemical_analysis_machine.setValue(1==this.station.chemical_analysis_machine);for(let o=0;o<this.pumps.length;o++)this.stationsStaticDataForm.controls["pump_"+this.pumps[o].SIDE].setValue(!!this.station.delivery_pumps.find(i=>i.pump_side==this.pumps[o].SIDE))}checkAllPumps(e){for(let o=0;o<this.pumps.length;o++)this.stationsStaticDataForm.controls["pump_"+this.pumps[o].SIDE].setValue(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.WI),t.Y36(C.so),t.Y36(V._),t.Y36($.N),t.Y36(J.ux),t.Y36(G.s),t.Y36(q.w))},a.\u0275cmp=t.Xpm({type:a,selectors:[["fury-form-wizard"]],viewQuery:function(e,o){if(1&e&&t.Gf(st,5),2&e){let i;t.iGM(i=t.CRH())&&(o._focusMe=i.first)}},features:[t._Bn([q.w,G.s])],decls:19,vars:13,consts:[[1,"title"],[4,"ngIf"],["fxLayout","column","fxLayoutAlign","start center"],[1,"card"],["stepper","matVerticalStepper"],[3,"stepControl"],[3,"formGroup",4,"ngIf"],[3,"stepControl",4,"ngIf"],[3,"formGroup"],["matStepLabel",""],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","24px"],["appearance","outline","fxFlex",""],["type","number","formControlName","site_code","required","","matInput","",3,"keypress"],["type","text","formControlName","station_name","required","","matInput",""],["formControlName","type",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","geolocation","matInput",""],["mat-icon-button","","matSuffix","",3,"click"],["type","text","formControlName","accountant_name","required","","matInput",""],["type","text","formControlName","accountant_email","required","","matInput",""],["formControlName","cv_configuration_id"],["fxLayout","column","fxLayoutGap","8px",1,"content",2,"margin-top","20px"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-raised-button","",3,"click"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled"],[3,"value"],["type","text","formControlName","userws","required","","matInput",""],["matInput","","formControlName","passwordws","required","","matInput","",3,"type"],["type","text","formControlName","orcudomain","required","","matInput",""],["type","number","formControlName","port","required","","matInput","",3,"keypress"],["type","text","formControlName","userhocommunicator","required","","matInput",""],["matInput","","formControlName","passhocommunicator","required","","matInput","",3,"type"],["type","number","formControlName","ho_role","required","","matInput","",3,"keypress"],["type","number","formControlName","sync_every_x_minutes","required","","matInput","",3,"keypress"],["type","number","formControlName","pump_status_every_x_seconds","required","","matInput","",3,"keypress"],["type","number","formControlName","max_sync_attempts","required","","matInput","",3,"keypress"],["formControlName","controller_type"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","24px",1,"div-toogle"],["color","primary","formControlName","status",3,"change"],["color","primary","mat-raised-button","","matStepperPrevious",""],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled",4,"ngIf"],["color","primary","mat-raised-button","",3,"disabled","click",4,"ngIf"],["color","primary","mat-raised-button","",3,"disabled","click"],["appearance","outline","required","","fxFlex",""],["formControlName","mobile_delivery_mean_id"],["formControlName","mobile_calibration_mean_id"],["type","number","formControlName","mobile_initial_inventory","matInput","",3,"keypress"],["matInput","","formControlName","mobile_initial_inventory_timestamp",3,"ngxMatDatetimePicker"],["matPrefix","",3,"for"],["matDatepickerToggleIcon",""],["fromDate",""],["color","primary","matStepperPrevious","","mat-raised-button",""],["color","primary","matStepperNext","","mat-raised-button","",3,"disabled",4,"ngIf"],["color","primary","matStepperNext","","mat-raised-button","",3,"disabled"],[1,"heading"],["fxLayout","column","fxLayoutAlign","start","fxLayoutGap","24px",1,"preview-content",2,"flex-flow","inherit","margin-top","30px","margin-bottom","30px"],["formControlName","weighing_machine",2,"width","100px"],["formControlName","chemical_analysis_machine",2,"width","100px"],[1,"subheading",2,"margin-top","10px"],["fxLayoutAlign","start start","class","result","fxLayout","row","fxLayoutGap","24px","style","flex-flow: inherit;margin-top: 30px; margin-bottom: 30px;",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","24px",1,"result",2,"flex-flow","inherit","margin-top","30px","margin-bottom","30px"],["color","primary","mat-button","","mat-raised-button","","type","button",2,"width","110px",3,"click"],["fxLayoutAlign","start start","fxLayout","row","fxLayoutGap","24px",1,"result",2,"flex-flow","inherit","margin-top","30px","margin-bottom","30px"],[2,"width","100px",3,"id","formControlName"],["class","content","fxLayout","row","fxLayoutGap","5px",4,"ngFor","ngForOf"],["color","primary","matStepperPrevious","","type","button","mat-raised-button",""],["fxLayout","row","fxLayoutGap","5px",1,"content"],["appearance","outline",2,"width","20%"],["matInput","",3,"formControlName"],["appearance","outline",2,"width","40%"],["required","",3,"formControlName"],["class","content content-tanks","fxLayout","column","fxLayoutGap","5px",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutGap","5px",1,"content","content-tanks"],["fxLayout","row","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","14px"],["appearance","outline"]],template:function(e,o){1&e&&(t.TgZ(0,"fury-page"),t.TgZ(1,"fury-title",0),t.TgZ(2,"mat-icon"),t._uU(3,"local_gas_station"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.qZA(),t.YNc(6,it,2,1,"loading",1),t.TgZ(7,"div",2),t.TgZ(8,"div",3),t.TgZ(9,"mat-vertical-stepper",null,4),t.TgZ(11,"mat-step",5),t.YNc(12,ct,47,4,"form",6),t.qZA(),t.TgZ(13,"mat-step",5),t.YNc(14,dt,76,13,"form",6),t.qZA(),t.YNc(15,Zt,38,8,"mat-step",7),t.YNc(16,At,33,4,"mat-step",7),t.YNc(17,Ft,12,5,"mat-step",7),t.YNc(18,qt,12,4,"mat-step",7),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("@scaleIn",void 0),t.xp6(2),t.Q6J("@fadeInRight",void 0),t.xp6(1),t.Oqu(o.title),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(2),t.Q6J("@fadeInUp",void 0),t.xp6(3),t.Q6J("stepControl",o.stationsModalForm),t.xp6(1),t.Q6J("ngIf",o.stationsModalForm),t.xp6(1),t.Q6J("stepControl",o.stationsCommForm),t.xp6(1),t.Q6J("ngIf",o.stationsCommForm),t.xp6(1),t.Q6J("ngIf",2===o.station.type&&2==o.station.status),t.xp6(1),t.Q6J("ngIf",2==o.station.status&&1==o.station.type),t.xp6(1),t.Q6J("ngIf",2==o.station.status&&null!=o.station.id&&o.remote_products.length>0),t.xp6(1),t.Q6J("ngIf",2==o.station.status&&null!=o.station.id&&1==o.station.map_of_products_done))},directives:[K.i,j.M,N.Hw,g.O5,F.xw,F.Wh,I.Vq,I.C0,X,s._Y,s.JL,s.sg,I.VY,F.SQ,U.KE,F.yH,U.hX,s.wV,s.Fj,z.Nt,s.JJ,s.u,s.Q7,W.gD,g.sg,w.lW,U.R9,tt.d,I.Ic,et.ey,ot.Rr,I.fd,P.g2,Q.nW,U.qo,Q.Q0,P.AB,at.oG],styles:[".title[_ngcontent-%COMP%]{color:#000}.card[_ngcontent-%COMP%]{margin:24px;border-radius:8px;overflow:scroll;width:800px;height:650px;box-shadow:0 10px 13px -6px #0003,0 20px 31px 3px #00000024,0 8px 38px 7px #0000001f}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:20px}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{max-width:200px}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px;width:50%}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .slide-toggle[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .div-toogle[_ngcontent-%COMP%]{border-style:solid;border-color:#d9d9d9;border-radius:5px;border-width:thin;width:200px;height:53px;padding:13px 10px;margin-top:4px;color:#535353}.card[_ngcontent-%COMP%]   .content-tanks[_ngcontent-%COMP%]{overflow:scroll;margin-right:30px;margin-top:20px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:24px 8px 0}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}.mat-vertical-content-container[_ngcontent-%COMP%]{padding-left:60px}"],data:{animation:[L.X,O.M,Y.K]}}),a})();var Nt=r(82593),wt=r(39762),Et=r(53580),Dt=r(38932),Ot=r(19165),Lt=r(94927),Rt=r(24784),D=r(92181);function Gt(a,l){if(1&a&&(t.TgZ(0,"th",18),t._uU(1),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.name,"")}}function Jt(a,l){if(1&a&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&a){const e=l.$implicit,o=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Oqu(i.getLabel(o.name,e[o.property]))}}function zt(a,l){if(1&a&&(t.ynx(0,15),t.YNc(1,Gt,2,1,"th",16),t.YNc(2,Jt,2,1,"td",17),t.BQk()),2&a){const e=t.oxw().$implicit;t.Q6J("matColumnDef",e.property)}}function Wt(a,l){if(1&a&&(t.TgZ(0,"th",18),t._uU(1),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.name,"")}}const Qt=function(a){return{"background-color":a}};function Ht(a,l){if(1&a&&(t.TgZ(0,"td",19),t._UZ(1,"button",21),t.qZA()),2&a){const e=l.$implicit,o=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.VKq(1,Qt,i.getLabel(o.name,e[o.property])))}}function Bt(a,l){1&a&&(t.ynx(0,20),t.YNc(1,Wt,2,1,"th",16),t.YNc(2,Ht,2,3,"td",17),t.BQk())}function Yt(a,l){if(1&a&&(t.ynx(0),t.YNc(1,zt,3,1,"ng-container",13),t.YNc(2,Bt,3,0,"ng-container",14),t.BQk()),2&a){const e=l.$implicit;t.xp6(1),t.Q6J("ngIf",e.isModelProperty&&"sync_status"!=e.property),t.xp6(1),t.Q6J("ngIf",e.isModelProperty&&"sync_status"==e.property)}}function Vt(a,l){1&a&&t._UZ(0,"th",22)}function $t(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().synchronize(i)}),t.TgZ(1,"span"),t._uU(2,"Syncronizar ahora"),t.qZA(),t.qZA()}}function Kt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().updateIndexes(i)}),t.TgZ(1,"span"),t._uU(2,"Actualizar \xedndices"),t.qZA(),t.qZA()}}function jt(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"td",23),t.TgZ(1,"button",24),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA(),t.qZA(),t.TgZ(4,"mat-menu",25,26),t.TgZ(6,"button",27),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().updateStation(_)}),t.TgZ(7,"span"),t._uU(8,"Editar"),t.qZA(),t.qZA(),t.TgZ(9,"button",27),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().deleteStation(_)}),t.TgZ(10,"span"),t._uU(11,"Eliminar"),t.qZA(),t.qZA(),t.YNc(12,$t,3,0,"button",28),t.YNc(13,Kt,3,0,"button",28),t.qZA(),t.qZA()}if(2&a){const e=l.$implicit,o=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(11),t.Q6J("ngIf",2===e.status),t.xp6(1),t.Q6J("ngIf",2===e.status)}}function Xt(a,l){1&a&&t._UZ(0,"tr",29)}function te(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"tr",30),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().updateStation(_)}),t.qZA()}}const ee=function(){return["Tables"]},oe=[{path:"",component:(()=>{class a{constructor(e,o,i,_,x,T){this.dialog=e,this.confirmationDialog=o,this.progressDialog=i,this._stationsService=_,this._fleetsService=x,this.snackbar=T,this.subject$=new f.t(1),this.data$=this.subject$.asObservable(),this.isLoading=!1,this.progress_message="wtf%",this.fleets=[],this.columns=[{name:"HOStationId",property:"id",visible:!1,isModelProperty:!0},{name:"Estatus",property:"status",visible:!0,isModelProperty:!0},{name:"N\xfamero de estaci\xf3n",property:"site_code",visible:!0,isModelProperty:!0},{name:"Tipo de controlador",property:"controller_type",visible:!0,isModelProperty:!0},{name:"Estaci\xf3n",property:"station_name",visible:!0,isModelProperty:!0},{name:"Tipo",property:"type",visible:!0,isModelProperty:!0},{name:"Host IP",property:"orcudomain",visible:!0,isModelProperty:!0},{name:"Puerto",property:"port",visible:!0,isModelProperty:!0},{name:"Role",property:"ho_role",visible:!1,isModelProperty:!0},{name:"Frecuencia de sincronizaci\xf3n",property:"sync_every_x_minutes",visible:!1,isModelProperty:!0},{name:"Primera sincronizaci\xf3n",property:"first_sync",visible:!1,isModelProperty:!0},{name:"\xdaltima sincronizaci\xf3n",property:"last_sync",visible:!0,isModelProperty:!0},{name:"Estado de sincronizaci\xf3n",property:"sync_status",visible:!0,isModelProperty:!0},{name:"\xdaltimo fallo en la sincronizaci\xf3n",property:"last_fail_update",visible:!0,isModelProperty:!0},{name:"N\xfamero de bombas para recepci\xf3n",property:"delivery_pumps",visible:!0,isModelProperty:!0},{name:"Uso de b\xe1scula",property:"weighing_machine",visible:!0,isModelProperty:!0},{name:"Uso de equipo para an\xe1lisis",property:"chemical_analysis_machine",visible:!0,isModelProperty:!0},{name:"N\xfamero actual de intentos",property:"current_failed_attempts",visible:!1,isModelProperty:!0},{name:"Frecuencia estatus de bombas",property:"pump_status_every_x_seconds",visible:!1,isModelProperty:!0},{name:"Dispositivo pdara recepci\xf3n",property:"mobile_delivery_mean_id",visible:!1,isModelProperty:!0},{name:"Dispositivo para jarreos",property:"mobile_calibration_mean_id",visible:!1,isModelProperty:!0},{name:"Inventario inicial",property:"mobile_initial_inventory",visible:!1,isModelProperty:!0},{name:"Fecha de inventario inicial",property:"mobile_initial_inventory_timestamp",visible:!1,isModelProperty:!0},{name:"Producto \xfanico",property:"mobile_unique_product_id",visible:!1,isModelProperty:!0},{name:"Acciones",property:"actions",visible:!0}],this.pageSize=10}getLabel(e,o){if(null!=e){if("Estatus"===e){var i;switch(+o){case 2:i="Activa";break;case 1:i="Inactiva";break;default:i="Eliminada"}return i}return"Estado de sincronizaci\xf3n"===e?2==+o?"#008000":1==+o?"#ebd534":0==+o?"#ac1700":"#626961":"Tipo"===e?2==+o?"M\xf3vil":"Est\xe1tica":"Uso de b\xe1scula"===e?1==+o?"Con b\xe1scula":"Sin b\xe1scula":"Uso de equipo para an\xe1lisis"===e?1==+o?"Con an\xe1lisis qu\xedmicos":"Sin an\xe1lisis qu\xedmicos":"N\xfamero de bombas para recepci\xf3n"===e?o.length:"Tipo de controlador"===e?1==+o?"nORCU Prime":"ORCU":o}}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}getData(){this._stationsService.getAll().subscribe(e=>{this.stations=e,this.dataSource=new m.by(e),this.dataSource=new m.by(this.stations),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},e=>{console.log("I should not exist ",e)})}ngOnInit(){this.dataSource=new m.by,this.getData(),this.data$.pipe((0,S.h)(e=>!!e)).subscribe(e=>{this.stations=e,this.dataSource.data=e})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}createStation(){this.dialog.open(E).afterClosed().subscribe(e=>{e&&(this.stations.unshift(new R.e(e)),this.subject$.next(this.stations),this.getData(),this.data$.pipe((0,S.h)(o=>!!o)).subscribe(o=>{this.stations=o,this.dataSource.data=o}))})}updateStation(e){this.dialog.open(E,{data:e}).afterClosed().subscribe(o=>{o&&this.ngOnInit()})}deleteStation(e){this.confirmationDialog.open(u.z,{data:{title:"Confirmaci\xf3n",message:"\xbfDesea eliminar del sistema el registro "+e.station_name+"?"}}).afterClosed().subscribe(o=>{o&&this._stationsService.delete(e).subscribe(i=>{this.dataSource=new m.by,this.getData(),this.data$.pipe((0,S.h)(_=>!!_)).subscribe(_=>{this.stations=_,this.dataSource.data=_}),this.snackbar.open(i.message,null,{duration:5e3,panelClass:["green-snackbar"]})})})}updateIndexes(e){this.confirmationDialog.open(u.z,{data:{title:"Confirmaci\xf3n",message:"\xbfDesea actualizar los \xedndices de la estaci\xf3n "+e.station_name+"?"}}).afterClosed().subscribe(o=>{o&&this._stationsService.updateIndexes(e).subscribe(i=>{this.dataSource=new m.by,this.getData(),this.data$.pipe((0,S.h)(_=>!!_)).subscribe(_=>{this.stations=_,this.dataSource.data=_}),this.snackbar.open(i.message,null,{duration:5e3,panelClass:["green-snackbar"]})})})}synchronize(e){var o=[{name:"models",percent:0,label:"Modelos"},{name:"fleets",percent:10,label:"Flotas"},{name:"departments",percent:20,label:"Departamentos"},{name:"limits_rules",percent:25,label:"Reglas de l\xedmites"},{name:"fuels_rules",percent:30,label:"Reglas de combustible"},{name:"visits_rules",percent:35,label:"Reglas de visita"},{name:"times_rules",percent:40,label:"Reglas de tiempos"},{name:"group_rules",percent:45,label:"Reglas grupales"},{name:"wireless_programmers",percent:50,label:"WPs"},{name:"means",percent:60,label:"Dispositivos/veh\xedculos"},{name:"transactions",percent:70,label:"Transacciones"}];1==e.type?(o.push({name:"inventories",percent:80,label:"Inventarios"}),o.push({name:"deliveries",percent:90,label:"Incrementos de TLS"})):o.push({name:"deliveries",percent:90,label:"Incrementos de TLS"});let i=this.progressDialog.open(d.q,{data:{title:"Transfiriendo",message:"Cargando...",percent:0}}),_=x=>{i.componentInstance.data={title:"Transfiriendo",message:x.label,percent:x.percent},this._stationsService.syncSingle(e.site_code,x.name).subscribe(T=>{this.snackbar.open(T.message,null,0==T.rc?{duration:5e3,panelClass:["green-snackbar"]}:{duration:5e3,panelClass:["red-snackbar"]}),o.length&&0==T.rc?_(o.shift()):(i.close(),o.length?(e.sync_status=1,this._stationsService.update(e).subscribe(k=>{this.snackbar.open("La estaci\xf3n no se pudo sincronizar en su totalidad",null,{duration:8e3,panelClass:["red-snackbar"]})})):(e.sync_status=2,e.current_failed_attempts=0,this._stationsService.update(e).subscribe(k=>{this.snackbar.open("Estaci\xf3n sincronizada con \xe9xito",null,{duration:8e3,panelClass:["green-snackbar"]})})),this.ngOnInit())},T=>{this.snackbar.open(T,null,{duration:5e3,panelClass:["red-snackbar"]}),i.close(),e.sync_status=1,this._stationsService.update(e).subscribe(k=>{this.snackbar.open("La estaci\xf3n no se pudo sincronizar en su totalidad",null,{duration:8e3,panelClass:["red-snackbar"]})})})};_(o.shift())}onFilterChange(e){!this.dataSource||(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}ngOnDestroy(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.uw),t.Y36(C.uw),t.Y36(C.uw),t.Y36(q.w),t.Y36(Nt.V),t.Y36(J.ux))},a.\u0275cmp=t.Xpm({type:a,selectors:[["stations-table"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Z.NW,7),t.Gf(c.YE,7)),2&e){let i;t.iGM(i=t.CRH())&&(o.paginator=i.first),t.iGM(i=t.CRH())&&(o.sort=i.first)}},inputs:{columns:"columns"},decls:17,vars:10,consts:[["mode","card"],["current","Estaciones",3,"crumbs"],["name","Estaciones",3,"columns","filterChange"],[1,"actions"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],["matColumnDef","sync_status",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matColumnDef","sync_status"],["type","buton","mat-mini-fab","",2,"cursor","auto","height","20px","width","20px",3,"ngStyle"],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"fury-page-layout",0),t.TgZ(1,"fury-page-layout-header"),t._UZ(2,"fury-breadcrumbs",1),t.qZA(),t.TgZ(3,"fury-page-layout-content"),t.TgZ(4,"fury-list",2),t.NdJ("filterChange",function(_){return o.onFilterChange(_)}),t.TgZ(5,"div",3),t.TgZ(6,"button",4),t.NdJ("click",function(){return o.createStation()}),t.TgZ(7,"mat-icon"),t._uU(8,"add"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"table",5),t.YNc(10,Yt,3,2,"ng-container",6),t.ynx(11,7),t.YNc(12,Vt,1,0,"th",8),t.YNc(13,jt,14,3,"td",9),t.BQk(),t.YNc(14,Xt,1,0,"tr",10),t.YNc(15,te,1,0,"tr",11),t.qZA(),t._UZ(16,"mat-paginator",12),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("@fadeInRight",void 0)("crumbs",t.DdM(9,ee)),t.xp6(1),t.Q6J("@fadeInUp",void 0),t.xp6(1),t.Q6J("columns",o.columns),t.xp6(5),t.Q6J("dataSource",o.dataSource),t.xp6(1),t.Q6J("ngForOf",o.columns),t.xp6(4),t.Q6J("matHeaderRowDef",o.visibleColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.visibleColumns),t.xp6(1),t.Q6J("pageSize",o.pageSize))},directives:[wt.N,Et.U,Dt.n,Ot.d,Lt.n,w.lW,N.Hw,m.BZ,c.YE,g.sg,m.w1,m.fO,m.Dz,m.as,m.nj,Z.NW,g.O5,m.ge,c.nU,m.ev,g.PC,Rt.Zl,D.p6,D.VK,D.OP,m.XQ,m.Gk],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:[O.M,L.X]}}),a})()}];let ae=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.Bz.forChild(oe)],h.Bz]}),a})();var se=r(61620),ie=r(91079),ne=r(79814),H=r(72467);const re=[{path:"",component:E}];let le=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.Bz.forChild(re)],h.Bz]}),a})(),ce=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[g.ez,se.o9,s.u5,ie.Bb,w.ot,C.Is,z.c,N.Ps,ne.Fk,W.LD,P.EC,P.Yy,P.K,le,H.Z,s.UX,b.q]]}),a})(),me=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[g.ez,ae,s.u5,b.q,H.Z,p.p,ce,n.J]]}),a})()},82593:(A,v,r)=>{r.d(v,{V:()=>b});var g=r(40520),s=r(98545),n=r(5e3),p=r(33344);let b=(()=>{class h{constructor(c,m){this.http=c,this.tokenStorage=m,this.baseendpoint=s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.FLEETS}getHeaders(){var c=new g.WM,m=this.tokenStorage.getToken();return c.set("token",m||"{}")}getAll(){var c=this.getHeaders();return this.http.get(this.baseendpoint,{headers:c})}getFiltered(c){var m=this.getHeaders();const u=(new g.LE).appendAll(c);return this.http.get(this.baseendpoint,{headers:m,params:u})}create(c){var m=this.getHeaders();return this.http.post(this.baseendpoint,c,{headers:m})}update(c){var m=this.getHeaders();return this.http.put(this.baseendpoint+"/"+c.id,c,{headers:m})}updateCvConfiguration(c){var m=this.getHeaders();return this.http.post(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.CV_CONFIGURATIONS,c,{headers:m})}}return h.\u0275fac=function(c){return new(c||h)(n.LFG(g.eN),n.LFG(p.i))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},15702:(A,v,r)=>{r.d(v,{_:()=>b});var g=r(40520),s=r(98545),n=r(5e3),p=r(33344);let b=(()=>{class h{constructor(c,m){this.http=c,this.tokenStorage=m}getHeaders(){var c=new g.WM,m=this.tokenStorage.getToken();return c.set("token",m||"{}")}getFromId(c){var m=this.getHeaders();return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS+"/"+c,{headers:m})}getFiltered(c){var m=this.getHeaders();const u=(new g.LE).appendAll(c);return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS,{params:u,headers:m})}getAll(){var c=this.getHeaders();return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS,{headers:c})}getEfficiencies(c){var m=this.getHeaders();const u=(new g.LE).appendAll(c);return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS_EFFICIENCIES,{params:u,headers:m})}getEfficienciesFromId(c,m){var u=this.getHeaders();const d=(new g.LE).appendAll(m);return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS_EFFICIENCIES+"/"+c,{params:d,headers:u})}create(c){var m=this.getHeaders();return this.http.post(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS,c,{headers:m})}update(c){var m=this.getHeaders();return this.http.put(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.MEANS+"/"+c.id,c,{headers:m})}}return h.\u0275fac=function(c){return new(c||h)(n.LFG(g.eN),n.LFG(p.i))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},9360:(A,v,r)=>{r.d(v,{s:()=>b});var g=r(40520),s=r(98545),n=r(5e3),p=r(33344);let b=(()=>{class h{constructor(c,m){this.http=c,this.tokenStorage=m}getHeaders(){var c=new g.WM,m=this.tokenStorage.getToken();return c.set("token",m||"{}")}getAll(c){var m=this.getHeaders();if(null!=c){const d=(new g.LE).appendAll(c);var u=this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.PRODUCTS,{params:d,headers:m})}else u=this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.PRODUCTS,{headers:m});return u}getProduct(c){var m=this.getHeaders();return this.http.get(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.PRODUCTS+"/"+c,{headers:m})}createProduct(c){var m=this.getHeaders();return this.http.post(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.PRODUCTS,c,{headers:m})}updateProduct(c){var m=this.getHeaders();return this.http.put(s._.settings.apiServer.API_URL_BASE+s._.settings.apiServer.PRODUCTS+"/"+c.id,c,{headers:m})}}return h.\u0275fac=function(c){return new(c||h)(n.LFG(g.eN),n.LFG(p.i))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},52190:(A,v,r)=>{r.d(v,{w:()=>Z});var g=r(40520),s=r(46227),n=r(27221),p=r(98545),b=r(5e3),h=r(33344);let Z=(()=>{class c{constructor(u,d){this.http=u,this.tokenStorage=d}getHeaders(){var u=new g.WM,d=this.tokenStorage.getToken();return u.set("token",d||"{}")}getAll(u){var d=this.getHeaders();const f=(new g.LE).appendAll(u?{type:u}:{});return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATIONS,{params:f,headers:d})}create(u){var d=this.getHeaders();return this.http.post(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATIONS,u,{headers:d}).pipe((0,s.V)(1e4),(0,n.K)(f=>{throw"Error de conexi\xf3n. Detalles: "+f}))}update(u){var d=this.getHeaders();return this.http.put(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATIONS+"/"+u.site_code,u,{headers:d}).pipe((0,s.V)(1e4),(0,n.K)(f=>{throw"Error de conexi\xf3n. Detalles: "+f}))}delete(u){var d=this.getHeaders();return this.http.delete(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATIONS+"/"+u.site_code,{headers:d})}getRemoteProducts(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.REMOTE_PRODUCTS+"/"+u.site_code,{headers:d}).pipe((0,s.V)(1e4),(0,n.K)(f=>{throw"Error de conexi\xf3n. Detalles: "+f}))}getRemoteTanks(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+"/remoteTanks/"+u.site_code,{headers:d}).pipe((0,s.V)(1e4),(0,n.K)(f=>{throw"Error de conexi\xf3n. Detalles: "+f}))}getMapOfProducts(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.PRODUCTS_MAPS+"/"+u.site_code,{headers:d})}setMapOfProducts(u,d){var f=this.getHeaders();return this.http.post(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.PRODUCTS_MAPS+"/"+d,u,{headers:f})}setTanksT(u){var d=this.getHeaders();return console.log(typeof u),this.http.post(p._.settings.apiServer.API_URL_BASE+"/remoteTanks",u,{headers:d})}getDevicesStatus(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.DEVICES_STATUS+"?site_code="+u,{headers:d})}getAllTanksStatus(){var u=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATUS_TANKS,{headers:u})}getTanksStatus(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATUS_TANKS+"/"+u,{headers:d})}getPumpsStatus(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.STATUS_PUMPS+"/"+u,{headers:d})}getPumps(u){var d=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.PUMPS+"/"+u,{headers:d})}syncSingle(u,d){var f=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.SYNC+"?site_code="+u+"&stub="+d,{headers:f}).pipe((0,s.V)(6e5),(0,n.K)(S=>{throw"Error de conexi\xf3n. Detalles: "+S}))}getMarimbas(){var u=this.getHeaders();return this.http.get(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.MARIMBAS,{headers:u})}updateIndexes(u){var d=this.getHeaders();return console.log(d),this.http.put(p._.settings.apiServer.API_URL_BASE+p._.settings.apiServer.INDEXES,u,{headers:d})}}return c.\u0275fac=function(u){return new(u||c)(b.LFG(g.eN),b.LFG(h.i))},c.\u0275prov=b.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()}}]);