"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[3575],{73575:(R,M,a)=>{a.r(M),a.d(M,{IepsModule:()=>Dt});var b=a(69808),m=a(93075),x=a(61264),T=a(4940),A=a(7057),y=a(72467),v=a(3299),c=a(70655),u=a(48966),C=a(86087),P=a(84847),f=a(32075),I=a(96831),w=a(92198),S=a(88914),z=a(14499),Y=a(96166),N=a(12983),E=a.n(N),t=a(5e3),G=a(2223),V=a(33344),L=a(2728),H=a(60198),B=a(57261),U=a(53580),_=a(30277),j=a(36551),F=a(47423),J=a(25245),$=a(19165),k=a(94927),D=a(92181);function W(o,r){if(1&o&&(t.TgZ(0,"th",22),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.name,"")}}function K(o,r){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Oqu(i.getLabel(n.name,e[n.property]))}}function X(o,r){1&o&&t._UZ(0,"td",24)}function q(o,r){if(1&o&&(t.ynx(0,18),t.YNc(1,W,2,1,"th",19),t.YNc(2,K,2,1,"td",20),t.YNc(3,X,1,0,"td",21),t.BQk()),2&o){const e=t.oxw().$implicit;t.Q6J("matColumnDef",e.property)}}function tt(o,r){if(1&o&&(t.ynx(0),t.YNc(1,q,4,1,"ng-container",17),t.BQk()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.isModelProperty&&e.visible)}}function et(o,r){1&o&&t._UZ(0,"th",25)}function ot(o,r){if(1&o&&(t.TgZ(0,"td",26),t.TgZ(1,"button",27),t.NdJ("click",function(n){return n.stopPropagation()}),t.TgZ(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA(),t.qZA(),t._UZ(4,"mat-menu",28,29),t.qZA()),2&o){const e=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e)}}function nt(o,r){1&o&&t._UZ(0,"tr",30)}function at(o,r){1&o&&t._UZ(0,"tr",31)}function rt(o,r){1&o&&t._UZ(0,"tr",32)}function it(o,r){if(1&o&&(t.TgZ(0,"th",22),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.name,"")}}function st(o,r){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=r.$implicit,n=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Oqu(i.getLabel(n.name,e[n.property]))}}function lt(o,r){1&o&&t._UZ(0,"td",24)}function dt(o,r){if(1&o&&(t.ynx(0,18),t.YNc(1,it,2,1,"th",19),t.YNc(2,st,2,1,"td",20),t.YNc(3,lt,1,0,"td",21),t.BQk()),2&o){const e=t.oxw().$implicit;t.Q6J("matColumnDef",e.property)}}function ct(o,r){if(1&o&&(t.ynx(0),t.YNc(1,dt,4,1,"ng-container",17),t.BQk()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.isModelProperty&&e.visible)}}function mt(o,r){1&o&&t._UZ(0,"th",25)}function pt(o,r){if(1&o&&(t.TgZ(0,"td",26),t.TgZ(1,"button",27),t.NdJ("click",function(n){return n.stopPropagation()}),t.TgZ(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA(),t.qZA(),t._UZ(4,"mat-menu",28,29),t.qZA()),2&o){const e=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e)}}function ft(o,r){1&o&&t._UZ(0,"tr",30)}function ut(o,r){1&o&&t._UZ(0,"tr",31)}function ht(o,r){1&o&&t._UZ(0,"tr",32)}let Q=(()=>{class o{constructor(e,n,i,p,h,l){this.data=e,this._excelerService=n,this._tokenStorageService=i,this._transactionsService=p,this._filesUploaderService=h,this.snackbar=l,this.subject$=new I.t(1),this.data$=this.subject$.asObservable(),this.subjectA$=new I.t(1),this.dataA$=this.subjectA$.asObservable(),this.bloqueable=!0,this.columns=[{name:"Id dispositivo",property:"mean_id",visible:!0,isModelProperty:!0,displayFn:!0},{name:"Area",property:"area_path",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Dispositivo",property:"mean",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Litros",property:"total",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Hor\xf3metro inicial",property:"start_horometer",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Hor\xf3metro final",property:"end_horometer",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Horas",property:"engine_hours",visible:!0,isModelProperty:!0,displayFn:!1}],this.pageSize=200,this.columnsA=[{name:"Id veh\xedculo",property:"plate",visible:!0,isModelProperty:!0,displayFn:!0},{name:"Veh\xedculo",property:"mean",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Area",property:"area_path",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Marca",property:"marca",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Modelo",property:"model",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Clase",property:"class",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Fecha movimiento",property:"timestamp",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Tipo de acci\xf3n",property:"type_of_action",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Observaciones",property:"observations",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Usuario movimiento",property:"user",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Proceso ERP",property:"erp_id",visible:!0,isModelProperty:!0,displayFn:!1}],this.pageSizeA=10}getLabel(e,n){if(null!=e)return"Litros"===e||"Hor\xf3metro inicial"===e||"Hor\xf3metro final"===e||"Horas"===e?this.round(n):"Tipo de movimiento"===e?1==n?"Alta":"Baja":n}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}get visibleColumnsA(){return this.columnsA.filter(e=>e.visible).map(e=>e.property)}getData(){this.dataSource=new f.by(this.data.transactions.consumos),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.dataSourceA=new f.by(this.data.transactions.means_list),this.dataSourceA.sort=this.sortA,this.dataSourceA.paginator=this.paginatorA}ngOnInit(){this.pageSize=this.data.filter.page_size,this.pageSizeA=this.data.filter.page_size,this.dataSource=new f.by,this.dataSourceA=new f.by,this._transactionsService.getServerTimestamp().subscribe(e=>{this.datetime=e.message}),this.getData(),this.data$.pipe((0,w.h)(e=>!!e)).subscribe(e=>{this.dataSource.data=e}),this.dataA$.pipe((0,w.h)(e=>!!e)).subscribe(e=>{this.dataSourceA.data=e})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSourceA.paginator=this.paginatorA,this.dataSourceA.sort=this.sortA}onFilterChange(e){!this.dataSource||(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}onFilterAChange(e){!this.dataSourceA||(e=(e=e.trim()).toLowerCase(),this.dataSourceA.filter=e)}getTotals(e){return(Math.round(100*this.data.transactions.consumos.map(n=>n[e]).reduce((n,i)=>n+i,0))/100).toFixed(2)}round(e){return(Math.round(100*e)/100).toFixed(2)}pdfMe(){var e=[],n=[],i=[],p=[];this.columns.forEach(g=>{g.visible&&(n.push({title:g.name,dataKey:g.property}),i.push(g.property),p.push(g.name))});var h=0;this.dataSource.filteredData.forEach(g=>{e[h]={},i.forEach(s=>{e[h][s]=""+g[s]}),h++});var l=new Y.jsPDF({orientation:"landscape",unit:"mm",format:"letter"});l.setFillColor("#152235"),l.roundedRect(10,15,260,30,2,2,"DF"),l.setFontSize(11),l.setTextColor("white"),l.text(this.data.filter.report_title,15,38),l.setFontSize(9),l.text("Periodo de "+this.data.filter.from_date+" a "+this.data.filter.to_date,15,43),l.addImage("../../../../../assets/img/maacsa.png","PNG",15,20,62,10.3),l.addImage("../../../../../assets/img/logo-grupo-mexico.png","PNG",200,20,63.4,17.6),l.setFontSize(8),l.text("Generado por "+this._tokenStorageService.getUser().user+"("+this._tokenStorageService.getUser().name+") el "+this.datetime,180,43),E()(l,{body:e,columns:n,startY:50,headStyles:{fontStyle:"bold",fillColor:"#152235",halign:"center"}}),l.save("ieps.pdf")}orderDataset(e,n){var i=[],p=[],h=[],l=[];n.forEach(s=>{i.push({title:s,dataKey:s}),p.push(s),h.push(s)});var g=0;return e.forEach(s=>{l[g]={},p.forEach(d=>{l[g][d]=s[d]}),g++}),l}getLogo(){return(0,c.mG)(this,void 0,void 0,function*(){var e="";return yield this._filesUploaderService.getFileBase64(this.data.filter.logo_filename).toPromise().then(n=>{e=n.file}).catch(n=>console.log(n)),e})}excelMe(){return(0,c.mG)(this,void 0,void 0,function*(){var e=this.orderDataset(this.data.transactions.consumos,this.data.transactions.hconsumos),n=this.orderDataset(this.data.transactions.headers,this.data.transactions.hheaders),i=this.orderDataset(this.data.transactions.means_list,this.data.transactions.hmeans_list),p=[];this.data.transactions.hconsumos.forEach(function(s,d){"area_path"==s?(this[d]="\xc1rea",p.push({width:32,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"mean"==s?(this[d]="Dispositivo",p.push({width:14,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"total"==s?(this[d]="Total litros (Acreditamiento mensual)",p.push({width:32,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):"start_horometer"==s?(this[d]="Horas iniciales",p.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):"end_horometer"==s?(this[d]="Horas finales",p.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):"engine_hours"==s?(this[d]="Horas de trabajo(mensuales)",p.push({width:32,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):-1!==s.indexOf("-")?p.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"e24e2f"}}}):p.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})},this.data.transactions.hconsumos);var h=[];this.data.transactions.hheaders.forEach(function(s,d){"activos_inicio"==s?(this[d]="# Activos",h.push({width:18,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"altas"==s?(this[d]="Altas",h.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"bajas"==s?(this[d]="Bajas",h.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"activos_fin"==s?(this[d]="Total mensual",h.push({width:18,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"fleets"==s&&(this[d]="Unidades",h.push({width:14,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}}))},this.data.transactions.hheaders);var l=[];this.data.transactions.hmeans_list.forEach(function(s,d){"plate"==s?(this[d]="# Econ\xf3mico",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"mean"==s?(this[d]="Veh\xedculo",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"area_path"==s?(this[d]="\xc1rea",l.push({width:32,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"marca"==s?(this[d]="Marca",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"model"==s?(this[d]="Modelo",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"class"==s?(this[d]="Clase",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"timestamp"==s?(this[d]="Fecha movimiento",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"type_of_action"==s?(this[d]="Movimiento",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):"observations"==s?(this[d]="Observaciones movimiento",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"user"==s?(this[d]="Usuario movimiento",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"erp_id"==s&&(this[d]="Proceso ERP",l.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}}))},this.data.transactions.hmeans_list);var g=[{worksheet:"movimientos",image:null!==this.data.filter.logo_filename?{filename:yield this.getLogo(),extension:"png"}:void 0,datas:[{header:{filter:!1,vector:this.data.transactions.hheaders,font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},body:{matrix:n,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:h}},{header:{filter:!0,vector:this.data.transactions.hmeans_list,font:{name:"Verdana",size:10,bold:!0,color:{argb:"ffffff"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"e6e5e5"}}},body:{matrix:i,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"dae0f1"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:l}}]},{worksheet:"consumos",datas:[{header:{filter:!0,vector:this.data.transactions.hconsumos,font:{name:"Verdana",size:12,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"aba8a8"}}},body:{matrix:e,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:p}}]}];this._excelerService.excelIt(g,"ieps_"+this.data.filter.month+"_"+this.data.filter.year)})}ngOnDestroy(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.WI),t.Y36(G.N),t.Y36(V.i),t.Y36(L.v),t.Y36(H.a),t.Y36(B.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ieps-modal-table"]],viewQuery:function(e,n){if(1&e&&(t.Gf(C.NW,7),t.Gf(P.YE,7),t.Gf(C.NW,7),t.Gf(P.YE,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.sort=i.first),t.iGM(i=t.CRH())&&(n.paginatorA=i.first),t.iGM(i=t.CRH())&&(n.sortA=i.first)}},inputs:{columns:"columns",columnsA:"columnsA"},decls:31,vars:20,consts:[["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","end",1,"buttons-set"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"disabled","click"],["svgIcon","excel"],[1,"page-modal"],["name","Dispositivos",3,"columns","filterChange"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","route-animations-elements","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[1,"paginator",3,"pageSize"],["name","Consumos",3,"columns","filterChange"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-header-row",""],["mat-row","",1,"route-animations-elements"],["mat-footer-row",""]],template:function(e,n){1&e&&(t.TgZ(0,"fury-page-layout-header"),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"fury-title"),t._uU(4),t.qZA(),t.TgZ(5,"fury-title"),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",2),t.TgZ(8,"button",3),t.NdJ("click",function(){return n.excelMe()}),t._UZ(9,"mat-icon",4),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"fury-page-layout-content",5),t.TgZ(11,"fury-list",6),t.NdJ("filterChange",function(p){return n.onFilterAChange(p)}),t.TgZ(12,"table",7),t.YNc(13,tt,2,1,"ng-container",8),t.ynx(14,9),t.YNc(15,et,1,0,"th",10),t.YNc(16,ot,6,1,"td",11),t.BQk(),t.YNc(17,nt,1,0,"tr",12),t.YNc(18,at,1,0,"tr",13),t.YNc(19,rt,1,0,"tr",14),t.qZA(),t._UZ(20,"mat-paginator",15),t.qZA(),t.TgZ(21,"fury-list",16),t.NdJ("filterChange",function(p){return n.onFilterChange(p)}),t.TgZ(22,"table",7),t.YNc(23,ct,2,1,"ng-container",8),t.ynx(24,9),t.YNc(25,mt,1,0,"th",10),t.YNc(26,pt,6,1,"td",11),t.BQk(),t.YNc(27,ft,1,0,"tr",12),t.YNc(28,ut,1,0,"tr",13),t.YNc(29,ht,1,0,"tr",14),t.qZA(),t._UZ(30,"mat-paginator",15),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.lnq("Periodo: ",n.data.filter.month,"/",n.data.filter.year," con horario de corte ",n.data.filter.ieps_schedule_time," hs."),t.xp6(2),t.hij("Flotas: ",n.data.filter.fleet_name,""),t.xp6(2),t.Q6J("disabled",n.data.transactions.means_list.length<=0&&n.data.transactions.consumos.length<=0),t.xp6(2),t.Q6J("@fadeInUp",void 0),t.xp6(1),t.Q6J("columns",n.columnsA),t.xp6(1),t.Q6J("dataSource",n.dataSourceA),t.xp6(1),t.Q6J("ngForOf",n.columnsA),t.xp6(4),t.Q6J("matHeaderRowDef",n.visibleColumnsA),t.xp6(1),t.Q6J("matRowDefColumns",n.visibleColumnsA),t.xp6(1),t.Q6J("matFooterRowDef",n.visibleColumnsA),t.xp6(1),t.Q6J("pageSize",n.pageSizeA),t.xp6(1),t.Q6J("columns",n.columns),t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngForOf",n.columns),t.xp6(4),t.Q6J("matHeaderRowDef",n.visibleColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.visibleColumns),t.xp6(1),t.Q6J("matFooterRowDef",n.visibleColumns),t.xp6(1),t.Q6J("pageSize",n.pageSize))},directives:[U.U,_.xw,_.SQ,j.M,_.Wh,F.lW,J.Hw,$.d,k.n,f.BZ,P.YE,b.sg,f.w1,f.fO,f.Dz,f.as,f.nj,f.Ke,C.NW,b.O5,f.mD,f.ge,P.nU,f.ev,f.yh,D.p6,D.VK,f.XQ,f.Gk,f.Q2],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}.title[_ngcontent-%COMP%]{color:#000}.page-modal[_ngcontent-%COMP%]{overflow:scroll;max-height:600px;margin:24px;padding:2px;box-shadow:0 3px 3px -2px #0003,0 3px 4px #00000024,0 1px 8px #0000001f}.page-modal[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.page-modal[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:5px}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.page-modal[_ngcontent-%COMP%]   .information-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:100%}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:410px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:245px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;width:245px}.page-modal[_ngcontent-%COMP%]   .text-icon[_ngcontent-%COMP%]{max-width:49.5%}.page-modal[_ngcontent-%COMP%]   .indented-right[_ngcontent-%COMP%]{margin-left:40px}.page-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}.numerical[_ngcontent-%COMP%]{text-align:end}.fury-title[_ngcontent-%COMP%]{color:#f5f5f5}.buttons-set[_ngcontent-%COMP%]{margin-left:60px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]{text-align:center;width:60px;height:60px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:30px;height:30px}"],data:{animation:[S.M,z.X]}}),o})();var gt=a(66738),bt=a(82593),yt=a(39762),_t=a(38932),Z=a(67322),vt=a(74107),xt=a(90508);const Ct=["dateFrom"];function Mt(o,r){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.NAME)}}function Tt(o,r){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function At(o,r){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Pt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",5),t.TgZ(1,"div",6),t.TgZ(2,"div",7),t.TgZ(3,"mat-form-field",8),t.TgZ(4,"mat-label"),t._uU(5,"Flota:"),t.qZA(),t.TgZ(6,"mat-select",9),t.YNc(7,Mt,2,2,"mat-option",10),t.qZA(),t.qZA(),t.TgZ(8,"mat-form-field",8),t.TgZ(9,"mat-label"),t._uU(10,"Mes:"),t.qZA(),t.TgZ(11,"mat-select",11),t.YNc(12,Tt,2,2,"mat-option",10),t.qZA(),t.TgZ(13,"mat-hint",12),t._uU(14,"Se considerar\xe1n los movimientos a partir primer dia del mes seleccionado y hasta antes del horario de corte del primer d\xeda del mes siguiente conforme a los horarios de corte de la flota."),t.qZA(),t.qZA(),t.TgZ(15,"mat-form-field",8),t.TgZ(16,"mat-label"),t._uU(17,"A\xf1o:"),t.qZA(),t.TgZ(18,"mat-select",13),t.YNc(19,At,2,2,"mat-option",10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",14),t.TgZ(21,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().submit()}),t._uU(22,"CONSULTAR"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.filterFormGroup),t.xp6(7),t.Q6J("ngForOf",e.fleets),t.xp6(5),t.Q6J("ngForOf",e.months),t.xp6(7),t.Q6J("ngForOf",e.years),t.xp6(2),t.Q6J("disabled",e.filterFormGroup.invalid)}}const Ft=function(){return["Tables"]},Zt=[{path:"",component:(()=>{class o{constructor(e,n,i){this.dialog=e,this._meansIepsHistoryService=n,this._fleetsService=i,this.transactions=[],this.fleets=[],this.means=[],this.filter={},this.months=[{id:1,name:"Enero",days:31},{id:2,name:"Febrero",days:28},{id:3,name:"Marzo",days:31},{id:4,name:"Abril",days:30},{id:5,name:"Mayo",days:31},{id:6,name:"Junio",days:30},{id:7,name:"Julio",days:31},{id:8,name:"Agosto",days:31},{id:9,name:"Septiembre",days:30},{id:10,name:"Octubre",days:31},{id:11,name:"Noviembre",days:30},{id:12,name:"Diciembre",days:31}],this.years=[],this.today=new Date,this.filterFormGroup=new m.cw({month:new m.NI("",[m.kI.required]),year:new m.NI("",[m.kI.required,m.kI.minLength(4),m.kI.maxLength(4)]),fleets:new m.NI("",[m.kI.required])})}ngOnInit(){return(0,c.mG)(this,void 0,void 0,function*(){this.fillYears(),this.fleets=yield this.getFleets(),this.filterFormGroup.controls.month.setValue(this.today.getMonth()+1),this.filterFormGroup.controls.year.setValue(this.today.getFullYear())})}submit(){return(0,c.mG)(this,void 0,void 0,function*(){var e=this.fleets.find(i=>i.id===this.filterFormGroup.controls.fleets.value);this.filter.fleets=this.filterFormGroup.controls.fleets.value.toString(),this.filter.month=this.filterFormGroup.controls.month.value,this.filter.year=this.filterFormGroup.controls.year.value,this.filter.days=2===this.filter.month&&this.leapYear(this.filter.year)?29:this.months.find(i=>i.id==this.filter.month).days,this.filter.ieps_schedule_time=e.ieps_schedule_time,this.transactions=yield this.getTransactions(),this.filter.fleet_name=e.NAME,this.filter.logo_filename=e.logo_filename,this.dialog.open(Q,{data:{filter:this.filter,transactions:this.transactions}}).afterClosed().subscribe(i=>{i&&console.log("Cerrada la tabla reporte"+i)})})}getTransactions(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._meansIepsHistoryService.getMonthlyReport(this.filter).toPromise()})}getFleets(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._fleetsService.getAll().toPromise()})}fillYears(){for(var e=this.today.getFullYear()-100,n=e+150;e<=n;e++)this.years.push(e)}leapYear(e){return e%4==0&&e%100!=0||e%400==0}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.uw),t.Y36(gt.J),t.Y36(bt.V))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ieps-report"]],viewQuery:function(e,n){if(1&e&&t.Gf(Ct,5),2&e){let i;t.iGM(i=t.CRH())&&(n.dateFrom=i.first)}},decls:7,vars:5,consts:[["mode","card"],["current","Reporte de IEPS",3,"crumbs"],[1,"card"],[1,"heading"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["fxLayout","column",1,"content"],["fxLayout","row","fxLayoutGap","8px",1,"content"],["appearance","outline","fxFlex","auto",1,"field"],["formControlName","fleets"],[3,"value",4,"ngFor","ngForOf"],["formControlName","month"],[2,"text-align","justify","text-justify","inter-word"],["formControlName","year"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-raised-button","",3,"disabled","click"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"fury-page-layout",0),t.TgZ(1,"fury-page-layout-header"),t._UZ(2,"fury-breadcrumbs",1),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"div",3),t._uU(5,"Reporte mensual del IEPS:"),t.qZA(),t.YNc(6,Pt,23,5,"form",4),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("@fadeInRight",void 0)("crumbs",t.DdM(4,Ft)),t.xp6(1),t.Q6J("@fadeInUp",void 0),t.xp6(3),t.Q6J("ngIf",n.filterFormGroup))},directives:[yt.N,U.U,_t.n,b.O5,m._Y,m.JL,m.sg,_.xw,_.SQ,Z.KE,_.yH,Z.hX,vt.gD,m.JJ,m.u,b.sg,Z.bx,_.Wh,F.lW,xt.ey],styles:[".title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:scroll;padding:20px;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:3px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px;width:50%}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .slide-toggle[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{max-width:33%;min-width:33%}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}  .custom-slider{text-align:center;border-width:thin;border-style:solid;border-radius:8px;border-color:#d3d3d3;color:#5b5b5b}  .custom-slider .ngx-slider{width:95%}  .custom-slider .ngx-slider .ngx-slider-bar{background:#006acb;height:2px}  .custom-slider .ngx-slider .ngx-slider-selection{background:#006acb}  .custom-slider .ngx-slider .ngx-slider-pointer{width:8px;height:16px;top:auto;bottom:0;background-color:#006acb;border-top-left-radius:3px;border-top-right-radius:3px}  .custom-slider .ngx-slider .ngx-slider-pointer:after{display:none}  .custom-slider .ngx-slider .ngx-slider-bubble{bottom:14px}  .custom-slider .ngx-slider .ngx-slider-limit{font-weight:400;color:#006acb}  .custom-slider .ngx-slider .ngx-slider-tick{width:1px;height:10px;margin-left:4px;border-radius:0;background:#006acb;top:-1px}  .custom-slider .ngx-slider .ngx-slider-tick.ngx-slider-selected{background:#006acb}"],data:{animation:[S.M,z.X]}}),o})()}];let Ot=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[v.Bz.forChild(Zt)],v.Bz]}),o})();var It=a(61620),wt=a(77531);const St=[{path:"",component:Q}];let zt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[v.Bz.forChild(St)],v.Bz]}),o})(),Ut=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[b.ez,m.u5,m.UX,A.q,It.o9,u.Is,wt.c,F.ot,J.Ps,zt,y.Z,T.p]]}),o})();var O=a(70024),Jt=a(59429);let Dt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[b.ez,m.u5,m.UX,x.J,T.p,A.q,y.Z,Ot,Ut,O.EC,O.Yy,O.K,Jt.kx]]}),o})()},82593:(R,M,a)=>{a.d(M,{V:()=>A});var b=a(40520),m=a(98545),x=a(5e3),T=a(33344);let A=(()=>{class y{constructor(c,u){this.http=c,this.tokenStorage=u,this.baseendpoint=m._.settings.apiServer.API_URL_BASE+m._.settings.apiServer.FLEETS}getHeaders(){var c=new b.WM,u=this.tokenStorage.getToken();return c.set("token",u||"{}")}getAll(){var c=this.getHeaders();return this.http.get(this.baseendpoint,{headers:c})}getFiltered(c){var u=this.getHeaders();const C=(new b.LE).appendAll(c);return this.http.get(this.baseendpoint,{headers:u,params:C})}create(c){var u=this.getHeaders();return this.http.post(this.baseendpoint,c,{headers:u})}update(c){var u=this.getHeaders();return this.http.put(this.baseendpoint+"/"+c.id,c,{headers:u})}updateCvConfiguration(c){var u=this.getHeaders();return this.http.post(m._.settings.apiServer.API_URL_BASE+m._.settings.apiServer.CV_CONFIGURATIONS,c,{headers:u})}}return y.\u0275fac=function(c){return new(c||y)(x.LFG(b.eN),x.LFG(T.i))},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()}}]);