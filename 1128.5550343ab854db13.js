"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[1128],{88914:(b,p,n)=>{n.d(p,{M:()=>l});var o=n(41777);const l=(0,o.X$)("fadeInRight",[(0,o.eR)(":enter",[(0,o.oB)({transform:"translateX(-2vw)",opacity:0}),(0,o.jt)("0.4s cubic-bezier(0.35, 0, 0.25, 1)",(0,o.oB)({transform:"translateX(0)",opacity:1}))])])},14499:(b,p,n)=>{n.d(p,{X:()=>l});var o=n(41777);const l=(0,o.X$)("fadeInUp",[(0,o.eR)(":enter",[(0,o.oB)({transform:"translateY(3vh)",opacity:0}),(0,o.jt)("400ms cubic-bezier(0.35, 0, 0.25, 1)",(0,o.oB)({transform:"translateY(0)",opacity:1}))])])},38932:(b,p,n)=>{n.d(p,{n:()=>c});var o=n(5e3),l=n(30277),u=n(3299),_=n(69808),g=n(25245);function m(d,y){if(1&d&&(o.TgZ(0,"div",7),o.TgZ(1,"mat-icon",5),o._uU(2,"chevron_right"),o.qZA(),o.TgZ(3,"div",6),o._uU(4),o.qZA(),o.qZA()),2&d){const v=y.$implicit;o.xp6(4),o.Oqu(v)}}const M=function(){return["/"]};let c=(()=>{class d{constructor(){this.crumbs=[]}ngOnInit(){}}return d.\u0275fac=function(v){return new(v||d)},d.\u0275cmp=o.Xpm({type:d,selectors:[["fury-breadcrumbs"]],inputs:{current:"current",crumbs:"crumbs"},decls:11,vars:5,consts:[[1,"title"],["fxLayout","row","fxLayoutAlign","start center",1,"crumbs"],[1,"crumb","home",3,"routerLink"],["class","crumb","fxLayout","row","fxLayoutAlign","start center",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"crumb","current"],[1,"chevron"],[1,"link"],["fxLayout","row","fxLayoutAlign","start center",1,"crumb"]],template:function(v,O){1&v&&(o.TgZ(0,"div",0),o._uU(1),o.qZA(),o.TgZ(2,"div",1),o.TgZ(3,"a",2),o._uU(4,"Home"),o.qZA(),o.YNc(5,m,5,1,"div",3),o.TgZ(6,"div",4),o.TgZ(7,"mat-icon",5),o._uU(8,"chevron_right"),o.qZA(),o.TgZ(9,"div",6),o._uU(10),o.qZA(),o.qZA(),o.qZA()),2&v&&(o.xp6(1),o.Oqu(O.current),o.xp6(2),o.Q6J("routerLink",o.DdM(4,M)),o.xp6(2),o.Q6J("ngForOf",O.crumbs),o.xp6(5),o.Oqu(O.current))},directives:[l.xw,l.Wh,u.yS,_.sg,g.Hw],styles:["[_nghost-%COMP%]{display:block}.title[_ngcontent-%COMP%]{font:var(--font-title);font-weight:400}.crumb[_ngcontent-%COMP%], .link[_ngcontent-%COMP%]{text-decoration:none;transition:color .4s cubic-bezier(.25,.8,.25,1);font:var(--font-body-1)}.link[_ngcontent-%COMP%]{cursor:pointer}.chevron[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px;margin-left:6px;margin-right:6px;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:default}"]}),d})()},94927:(b,p,n)=>{n.d(p,{n:()=>k});var o=n(5e3),l=n(23753),u=n(75778),_=n(80013),g=n(69808),m=n(92181),M=n(30277),c=n(25245),d=n(47423),y=n(77446),v=n(93075);const O=["filter"];function J(A,E){if(1&A&&(o.TgZ(0,"div",5),o.TgZ(1,"div",6),o._uU(2),o.qZA(),o.TgZ(3,"div",7),o.TgZ(4,"mat-icon",8),o._uU(5,"search"),o.qZA(),o._UZ(6,"input",9,10),o.qZA(),o.TgZ(8,"button",11),o.TgZ(9,"mat-icon"),o._uU(10,"filter_list"),o.qZA(),o.qZA(),o.Hsn(11,1),o.qZA()),2&A){const C=o.oxw(),x=o.MAs(3);o.xp6(2),o.Oqu(C.name),o.xp6(6),o.Q6J("matMenuTriggerFor",x)}}function N(A,E){if(1&A){const C=o.EpF();o.TgZ(0,"button",12),o.NdJ("click",function(Z){const I=o.CHM(C).$implicit;return o.oxw().toggleColumnVisibility(I,Z)}),o.TgZ(1,"mat-checkbox",13,14),o.NdJ("ngModelChange",function(Z){return o.CHM(C).$implicit.visible=Z})("click",function(Z){return Z.stopPropagation()}),o._uU(3),o.qZA(),o.qZA()}if(2&A){const C=E.$implicit;o.xp6(1),o.Q6J("ngModel",C.visible),o.xp6(2),o.hij(" ",C.name," ")}}const R=["*",[["",8,"actions"]]],D=["*",".actions"];let k=(()=>{class A{constructor(){this.filterChange=new o.vpe}ngAfterViewInit(){this.hideHeader||(0,l.R)(this.filter.nativeElement,"keyup").pipe((0,u.x)(),(0,_.b)(150)).subscribe(()=>{this.filterChange.emit(this.filter.nativeElement.value)})}toggleColumnVisibility(C,x){x.stopPropagation(),x.stopImmediatePropagation(),C.visible=!C.visible}}return A.\u0275fac=function(C){return new(C||A)},A.\u0275cmp=o.Xpm({type:A,selectors:[["fury-list"]],viewQuery:function(C,x){if(1&C&&o.Gf(O,5),2&C){let Z;o.iGM(Z=o.CRH())&&(x.filter=Z.first)}},inputs:{name:"name",columns:"columns",hideHeader:"hideHeader"},outputs:{filterChange:"filterChange"},ngContentSelectors:D,decls:6,vars:2,consts:[[1,"fury-list-table"],["class","fury-list-header","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",4,"ngIf"],["yPosition","below","xPosition","before"],["columnFilter","matMenu"],["class","checkbox-item mat-menu-item",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",1,"fury-list-header"],[1,"fury-list-name"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],[1,"fury-filter-input-icon"],["fxFlex","","placeholder","Search\u2026",1,"fury-filter-input"],["filter",""],["type","button","mat-icon-button","",1,"fury-column-filter",3,"matMenuTriggerFor"],[1,"checkbox-item","mat-menu-item",3,"click"],[1,"checkbox",3,"ngModel","ngModelChange","click"],["checkbox",""]],template:function(C,x){1&C&&(o.F$t(R),o.TgZ(0,"div",0),o.YNc(1,J,12,2,"div",1),o.TgZ(2,"mat-menu",2,3),o.YNc(4,N,4,2,"button",4),o.qZA(),o.Hsn(5),o.qZA()),2&C&&(o.xp6(1),o.Q6J("ngIf",!x.hideHeader),o.xp6(3),o.Q6J("ngForOf",x.columns))},directives:[g.O5,m.VK,g.sg,M.xw,M.Wh,M.SQ,M.yH,c.Hw,d.lW,m.p6,y.oG,v.JJ,v.On],styles:[".fury-list-table{display:flex;flex-direction:column}.fury-list-table .fury-list-header{padding-left:24px;padding-right:24px;height:64px;border-top-left-radius:8px;border-top-right-radius:8px}@media screen and (max-width: 599px){.fury-list-table .fury-list-header{height:auto;padding-top:24px;padding-bottom:24px}}.fury-list-table .fury-list-header .fury-list-name{font-size:20px;line-height:32px;font-weight:500;padding-right:24px}@media screen and (max-width: 599px){.fury-list-table .fury-list-header .fury-list-name{border-right:none}}.fury-list-table .fury-list-header .fury-filter-input{font-size:16px;line-height:1.125;border:none;height:32px}.fury-list-table .fury-list-header .fury-filter-input:focus{outline:none}.fury-list-table .fury-list-header .fury-filter-input-icon{width:1.2em;vertical-align:bottom;height:22px;font-size:22px;margin-right:8px}.fury-list-table table{width:100%}.fury-list-table .mat-header-row .mat-header-cell .mat-sort-header-button{text-transform:uppercase}.fury-list-table .mat-cell.image-cell,.fury-list-table .mat-header-cell.image-cell{flex:0;width:59px}.fury-list-table .mat-cell.image-cell img,.fury-list-table .mat-header-cell.image-cell img{border-radius:50%;height:35px;width:35px;margin-right:24px;vertical-align:middle}.fury-list-table .mat-cell,.fury-list-table .mat-header-cell{white-space:nowrap;padding-left:12px;padding-right:12px}.fury-list-table .mat-cell.actions-cell,.fury-list-table .mat-header-cell.actions-cell{flex:0;width:40px;overflow:visible}.fury-list-table .paginator{display:block}\n"],encapsulation:2}),A})()},4940:(b,p,n)=>{n.d(p,{p:()=>g});var o=n(69808),l=n(93075),u=n(7057),_=n(5e3);let g=(()=>{class m{}return m.\u0275fac=function(c){return new(c||m)},m.\u0275mod=_.oAB({type:m}),m.\u0275inj=_.cJS({imports:[[o.ez,u.q,l.u5]]}),m})()},19165:(b,p,n)=>{n.d(p,{d:()=>l});var o=n(5e3);let l=(()=>{class u{constructor(){}}return u.\u0275fac=function(g){return new(g||u)},u.\u0275dir=o.lG2({type:u,selectors:[["","furyPageLayoutContent",""],["fury-page-layout-content"]],hostAttrs:[1,"fury-page-layout-content"]}),u})()},53580:(b,p,n)=>{n.d(p,{U:()=>l});var o=n(5e3);let l=(()=>{class u{constructor(){}}return u.\u0275fac=function(g){return new(g||u)},u.\u0275dir=o.lG2({type:u,selectors:[["","furyPageLayoutHeader",""],["fury-page-layout-header"]],hostAttrs:[1,"fury-page-layout-header"]}),u})()},39762:(b,p,n)=>{n.d(p,{N:()=>l});var o=n(5e3);let l=(()=>{class u{constructor(){this.mode="simple"}get isCard(){return"card"===this.mode}get isSimple(){return"simple"===this.mode}}return u.\u0275fac=function(g){return new(g||u)},u.\u0275dir=o.lG2({type:u,selectors:[["","furyPageLayout",""],["fury-page-layout"]],hostAttrs:[1,"fury-page-layout"],hostVars:4,hostBindings:function(g,m){2&g&&o.ekj("fury-page-layout-card",m.isCard)("fury-page-layout-simple",m.isSimple)},inputs:{mode:"mode"}}),u})()},59968:(b,p,n)=>{n.d(p,{i:()=>l});var o=n(5e3);let l=(()=>{class u{constructor(){}}return u.\u0275fac=function(g){return new(g||u)},u.\u0275dir=o.lG2({type:u,selectors:[["","furyPage",""],["fury-page"]],hostAttrs:[1,"fury-page"]}),u})()},71128:(b,p,n)=>{n.r(p),n.d(p,{ProfilesTableModule:()=>Ve});var o=n(69808),l=n(93075),u=n(61264),_=n(4940),g=n(7057),m=n(72467),M=n(3299),c=n(70655),d=n(86087),y=n(84847),v=n(32075),O=n(96831),J=n(92198),N=n(88914),R=n(14499),D=n(48966),k=n(37425),A=n(54822),E=n(10463),C=n(74204);class x{constructor(r){this.id=r&&r.id||null,this.name=r&&r.name||null,this.observations=r&&r.observations||null,this.status=r&&r.status||null,this.sidenav_items=r&&r.sidenav_items||[],this.fleets=r&&r.fleets||[],this.ccs=r&&r.ccs||[],this.cv_configurations=r&&r.cv_configurations||[],this.stations=r&&r.stations||[]}}class Z{constructor(r){this.id=r&&r.id||null,this.name=r&&r.name||null,this.position=r&&r.position||null,this.type=r&&r.type||null,this.custom_class=r&&r.custom_class||null,this.icon=r&&r.icon||null,this.parent=r&&r.parent||null,this.route_or_function=r&&r.route_or_function||null,this.badge=r&&r.badge||null,this.badge_color=r&&r.badge_color||null,this.level=r&&r.level||null,this.assignable=r&&r.assignable||null,this.status=r&&r.status||null}}var w=n(20449),I=n(28258),S=n(90149),oe=n(591),e=n(5e3),ne=n(57261),ie=n(58527),se=n(31405),re=n(82593),$=n(92660),ae=n(59968),le=n(36551),H=n(25245),B=n(30277),Q=n(67322),j=n(77531),ce=n(4834),X=n(74107),W=n(47423),de=n(90508),ue=n(77446);const fe=["allSelected"],me=["allCCs"],he=["allCVs"],pe=["profilesModalForm"];function ge(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24,25),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleAllSelection()}),e._uU(2,"Todas"),e.qZA()}2&s&&e.Q6J("value",0)}function _e(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.tosslePerOne(a.allSelected.viewValue)}),e._uU(1),e.qZA()}if(2&s){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.NAME)}}function ve(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24,26),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleAllSelectionCC()}),e._uU(2,"Todos"),e.qZA()}2&s&&e.Q6J("value",0)}function Ce(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.tosslePerOneCC(a.allCCs.viewValue)}),e._uU(1),e.qZA()}if(2&s){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE("",t.fleet_name,"-",t.name,"")}}function Pe(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24,27),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleAllSelectionCV()}),e._uU(2,"Todos"),e.qZA()}2&s&&e.Q6J("value",0)}function ye(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-option",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.tosslePerOneCV(a.allCVs.viewValue)}),e._uU(1),e.qZA()}if(2&s){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.AsE("",t.num_permiso,"",t.num_contrato_o_asignacion,"")}}function Me(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-tree-node",28),e._UZ(1,"button",29),e.TgZ(2,"mat-checkbox",30),e.NdJ("change",function(){const f=e.CHM(t).$implicit;return e.oxw().todoLeafItemSelectionToggle(f)}),e._uU(3),e.qZA(),e.qZA()}if(2&s){const t=r.$implicit,i=e.oxw();e.xp6(2),e.Q6J("checked",i.checklistSelection.isSelected(t)),e.xp6(1),e.Oqu(t.name)}}function Te(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"mat-tree-node",31),e.TgZ(1,"button",32),e.TgZ(2,"mat-icon",33),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"mat-checkbox",34),e.NdJ("change",function(){const f=e.CHM(t).$implicit;return e.oxw().todoItemSelectionToggle(f)}),e._uU(5),e.qZA(),e.qZA()}if(2&s){const t=r.$implicit,i=e.oxw();e.xp6(1),e.uIk("aria-label","Toggle "+t.item),e.xp6(2),e.Oqu(i.treeControl.isExpanded(t)?"expand_more":"chevron_right"),e.xp6(1),e.Q6J("checked",i.descendantsAllSelected(t))("indeterminate",i.descendantsPartiallySelected(t)),e.xp6(1),e.Oqu(t.name)}}class xe{}let q=(()=>{class s{constructor(){this.dataChange=new oe.X([]),this.initialize()}get data(){return this.dataChange.value}initialize(){this.dataChange.next([])}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})(),G=(()=>{class s{constructor(t,i,a,f,h,T,F,K){this.data=t,this._database=i,this.dialogRef=a,this.snackbar=f,this._areasService=h,this._cvConfigurationsService=T,this._fleetsService=F,this._profilesService=K,this.title="Perfiles",this.mode="create",this.profile=new x,this.fleets=[],this.ccs=[],this.assignedFleets="",this.assignedCVCs="",this.cv_configurations=[],this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.checklistSelection=new w.Ov(!0),this.getLevel=P=>P.level,this.getId=P=>P.id,this.isExpandable=P=>P.expandable,this.getChildren=P=>P.children,this.hasChild=(P,U)=>U.expandable,this.hasNoContent=(P,U)=>""===U.name,this.transformer=(P,U)=>{var V;const z=this.nestedNodeMap.get(P),L=z&&z.name===P.name?z:new xe;return L.name=P.name,L.id=P.id,L.level=U,L.expandable=!!(null===(V=P.children)||void 0===V?void 0:V.length),this.flatNodeMap.set(L,P),this.nestedNodeMap.set(P,L),L},this.treeFlattener=new S.JZ(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new I.C2(this.getLevel,this.isExpandable),this.dataSource=new S.kc(this.treeControl,this.treeFlattener),i.dataChange.subscribe(P=>{this.dataSource.data=P}),a.disableClose=!0,this.profilesModalForm=new l.cw({id:new l.NI,name:new l.NI("",[l.kI.required]),observations:new l.NI(""),status:new l.NI(!0,[l.kI.required]),fleets:new l.NI([],[l.kI.required]),ccs:new l.NI([],[l.kI.required]),cv_configurations:new l.NI([],[l.kI.required])})}ngOnInit(){return(0,c.mG)(this,void 0,void 0,function*(){if(this.dataSource.data=this.data.sidenav_items,this.fleets=yield this.getFleets(),this.data.profile){this.profile=this.data.profile;var t=[];this.profile.fleets.forEach(f=>{t.push(+f.id)}),this.profile.fleets.length===this.fleets.length&&t.push(0),this.assignedFleets=t.toString(),this.ccs=yield this.getCCs();var i=[];this.profile.ccs.forEach(f=>{i.push(+f.id)}),this.profile.ccs.length===this.ccs.length&&i.push(0);var a=[];this.profile.cv_configurations.forEach(f=>{a.push(+f.id)}),this.assignedCVCs=a.toString(),this.cv_configurations=yield this.getCVConfigurations(),this.mode="update",this.profile=this.data.profile,this.profilesModalForm.setValue({id:this.profile.id,name:this.profile.name,observations:this.profile.observations,status:2==this.profile.status,fleets:t,ccs:i,cv_configurations:a}),this.treeControl.dataNodes.forEach(f=>{console.log(this.profile.sidenav_items),void 0!==this.profile.sidenav_items.find(h=>+h.id==+f.id)&&this.checklistSelection.select(f)})}})}getFleets(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._fleetsService.getAll().toPromise()})}getCCs(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._areasService.getCostCenters({fleets:this.assignedFleets}).toPromise()})}getCVConfigurations(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._cvConfigurationsService.getAll().toPromise()})}descendantsAllSelected(t){const i=this.treeControl.getDescendants(t);return i.length>0&&i.every(f=>this.checklistSelection.isSelected(f))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(f=>this.checklistSelection.isSelected(f))&&!this.descendantsAllSelected(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const i=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...i):this.checklistSelection.deselect(...i),i.forEach(a=>this.checklistSelection.isSelected(a)),this.checkAllParentsSelection(t)}todoLeafItemSelectionToggle(t){this.checklistSelection.toggle(t),this.checkAllParentsSelection(t)}checkAllParentsSelection(t){let i=this.getParentNode(t);for(;i;)this.checkRootNodeSelection(i),i=this.getParentNode(i)}checkRootNodeSelection(t){const i=this.checklistSelection.isSelected(t),a=this.treeControl.getDescendants(t),f=a.length>0&&a.every(h=>this.checklistSelection.isSelected(h));i&&!f?this.checklistSelection.deselect(t):!i&&f&&this.checklistSelection.select(t)}getParentNode(t){const i=this.getLevel(t);if(i<1)return null;for(let f=this.treeControl.dataNodes.indexOf(t)-1;f>=0;f--){const h=this.treeControl.dataNodes[f];if(this.getLevel(h)<i)return h}return null}getAllParents(t){let i=t,a=[];for(;this.getParentNode(i);)i=this.getParentNode(i),void 0!==i&&a.push(i);return a}submit(){this.profile.id=this.profilesModalForm.controls.id.value,this.profile.name=this.profilesModalForm.controls.name.value,this.profile.observations=this.profilesModalForm.controls.observations.value,this.profile.status=this.profilesModalForm.controls.status.value?2:1,this.profile.sidenav_items=[];var i=[];this.profilesModalForm.controls.fleets.value.forEach(h=>{0!=h&&i.push(new C.i({id:h}))}),this.profile.fleets=i;var a=[];this.profilesModalForm.controls.ccs.value.forEach(h=>{0!=h&&a.push(new A.t({id:h,fleet_id:this.ccs.find(T=>T.id==h).fleet_id}))}),this.profile.ccs=a;var f=[];console.log(this.profilesModalForm.controls.cv_configurations.value),this.profilesModalForm.controls.cv_configurations.value.forEach(h=>{0!=h&&f.push(new E.q({id:h}))}),this.profile.cv_configurations=f,this.checklistSelection.selected.forEach(h=>{this.profile.sidenav_items.push(new Z({id:h.id,name:h.name})),this.getAllParents(h).forEach(F=>{void 0===this.profile.sidenav_items.find(K=>K.id===F.id)&&this.profile.sidenav_items.push(new Z({id:F.id,name:F.name}))})}),"create"===this.mode?this.createProfile():this.updateProfile()}createProfile(){this._profilesService.createProfile(this.profile).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"create",data:this.profile})},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}updateProfile(){this._profilesService.updateProfile(this.profile).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close({action:"update",data:this.profile})},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}close(){this.dialogRef.close({action:"cancel",data:this.profile})}onFocusCCs(){return(0,c.mG)(this,void 0,void 0,function*(){this.assignedFleets=this.profilesModalForm.controls.fleets.value.length>0?this.profilesModalForm.controls.fleets.value.toString():"-1",this.ccs=yield this.getCCs()})}onChangeFleet(){return(0,c.mG)(this,void 0,void 0,function*(){this.profilesModalForm.controls.ccs.setValue([])})}tosslePerOne(t){if(this.allSelected.selected)return this.allSelected.deselect(),!1;this.profilesModalForm.controls.fleets.value.length==this.fleets.length&&this.allSelected.select()}toggleAllSelection(){this.profilesModalForm.controls.fleets.patchValue(this.allSelected.selected?[...this.fleets.map(t=>t.id),0]:[])}tosslePerOneCC(t){if(this.allCCs.selected)return this.allCCs.deselect(),!1;this.profilesModalForm.controls.ccs.value.length==this.ccs.length&&this.allCCs.select()}toggleAllSelectionCC(){this.profilesModalForm.controls.ccs.patchValue(this.allCCs.selected?[...this.ccs.map(t=>t.id),0]:[])}tosslePerOneCV(t){if(this.allCVs.selected)return this.allCVs.deselect(),!1;this.profilesModalForm.controls.cv_configurations.value.length==this.cv_configurations.length&&this.allCVs.select()}toggleAllSelectionCV(){this.profilesModalForm.controls.cv_configurations.patchValue(this.allCVs.selected?[...this.cv_configurations.map(t=>t.id),0]:[])}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(D.WI),e.Y36(q),e.Y36(D.so),e.Y36(ne.ux),e.Y36(ie.E),e.Y36(se.N),e.Y36(re.V),e.Y36($.L))},s.\u0275cmp=e.Xpm({type:s,selectors:[["fury-form-wizard"]],viewQuery:function(t,i){if(1&t&&(e.Gf(fe,5),e.Gf(me,5),e.Gf(he,5),e.Gf(pe,5)),2&t){let a;e.iGM(a=e.CRH())&&(i.allSelected=a.first),e.iGM(a=e.CRH())&&(i.allCCs=a.first),e.iGM(a=e.CRH())&&(i.allCVs=a.first),e.iGM(a=e.CRH())&&(i._focusMe=a.first)}},features:[e._Bn([q])],decls:63,vars:13,consts:[[1,"small_modal"],[1,"title"],["svgIcon","profile"],["fxLayout","column","fxLayoutAlign","start center"],[1,"card"],[3,"formGroup"],[1,"subheading"],["fxLayout","column","fxLayoutGap","8px",1,"content",2,"margin-top","20px"],["fxFlex","auto","appearance","outline"],["formControlName","name","matInput","","required",""],["appearance","outline","fxFlex","auto"],["formControlName","observations","matInput",""],[1,"subheading",2,"margin-top","20px"],["appearance","outline",1,"field"],["formControlName","fleets","multiple","",3,"selectionChange"],[3,"value","click",4,"ngIf"],[3,"value","click",4,"ngFor","ngForOf"],["formControlName","ccs","multiple","",3,"focus"],["formControlName","cv_configurations","multiple",""],[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","24px",2,"margin-top","20px"],["color","primary","mat-raised-button","",3,"click"],[3,"value","click"],["allSelected",""],["allCCs",""],["allCVs",""],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"checklist-leaf-node",3,"checked","change"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],[3,"checked","indeterminate","change"]],template:function(t,i){1&t&&(e.TgZ(0,"fury-page",0),e.TgZ(1,"fury-title",1),e._UZ(2,"mat-icon",2),e.TgZ(3,"span"),e._uU(4,"Perfiles"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"div",4),e.TgZ(7,"form",5),e.TgZ(8,"div",6),e._uU(9,"Indicar propiedades del perfil."),e.qZA(),e.TgZ(10,"div",7),e.TgZ(11,"mat-form-field",8),e.TgZ(12,"mat-label"),e._uU(13,"Nombre:"),e.qZA(),e._UZ(14,"input",9),e.TgZ(15,"mat-hint"),e._uU(16,"Se\xf1alar nombre de perfil"),e.qZA(),e.qZA(),e.TgZ(17,"mat-form-field",10),e.TgZ(18,"mat-label"),e._uU(19,"Observaciones:"),e.qZA(),e._UZ(20,"input",11),e.TgZ(21,"mat-hint"),e._uU(22,"Indicar observaciones descriptivas del perfil"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",7),e._UZ(24,"mat-divider"),e.qZA(),e.TgZ(25,"div",12),e._uU(26,"Flotas."),e.qZA(),e.TgZ(27,"div",7),e.TgZ(28,"mat-form-field",13),e.TgZ(29,"mat-label"),e._uU(30,"Flotas:"),e.qZA(),e.TgZ(31,"mat-select",14),e.NdJ("selectionChange",function(){return i.onChangeFleet()}),e.YNc(32,ge,3,1,"mat-option",15),e.YNc(33,_e,2,2,"mat-option",16),e.qZA(),e.qZA(),e.TgZ(34,"mat-form-field",13),e.TgZ(35,"mat-label"),e._uU(36,"Centros de cobro:"),e.qZA(),e.TgZ(37,"mat-select",17),e.NdJ("focus",function(){return i.onFocusCCs()}),e.YNc(38,ve,3,1,"mat-option",15),e.YNc(39,Ce,2,3,"mat-option",16),e.qZA(),e.qZA(),e.qZA(),e.TgZ(40,"div",7),e._UZ(41,"mat-divider"),e.qZA(),e.TgZ(42,"div",12),e._uU(43,"Permisos de controles volum\xe9tricos."),e.qZA(),e.TgZ(44,"div",7),e.TgZ(45,"mat-form-field",13),e.TgZ(46,"mat-label"),e._uU(47,"Permisos CV:"),e.qZA(),e.TgZ(48,"mat-select",18),e.YNc(49,Pe,3,1,"mat-option",15),e.YNc(50,ye,2,3,"mat-option",16),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"div",7),e._UZ(52,"mat-divider"),e.qZA(),e.TgZ(53,"div",12),e._uU(54,"Permisos del perfil."),e.qZA(),e.TgZ(55,"mat-tree",19),e.YNc(56,Me,4,2,"mat-tree-node",20),e.YNc(57,Te,6,5,"mat-tree-node",21),e.qZA(),e.TgZ(58,"div",22),e.TgZ(59,"button",23),e.NdJ("click",function(){return i.close()}),e._uU(60,"CANCELAR"),e.qZA(),e.TgZ(61,"button",23),e.NdJ("click",function(){return i.submit()}),e._uU(62,"GUARDAR"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@scaleIn",void 0),e.xp6(1),e.Q6J("@fadeInRight",void 0),e.xp6(3),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("formGroup",i.profilesModalForm),e.xp6(25),e.Q6J("ngIf",i.fleets.length>0),e.xp6(1),e.Q6J("ngForOf",i.fleets),e.xp6(5),e.Q6J("ngIf",i.ccs.length>0),e.xp6(1),e.Q6J("ngForOf",i.ccs),e.xp6(10),e.Q6J("ngIf",i.cv_configurations.length>0),e.xp6(1),e.Q6J("ngForOf",i.cv_configurations),e.xp6(5),e.Q6J("dataSource",i.dataSource)("treeControl",i.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",i.hasChild))},directives:[ae.i,le.M,H.Hw,B.xw,B.Wh,l._Y,l.JL,l.sg,B.SQ,Q.KE,B.yH,Q.hX,l.Fj,j.Nt,l.JJ,l.u,l.Q7,Q.bx,ce.d,X.gD,o.O5,o.sg,S.gi,S.fQ,W.lW,de.ey,S.uo,S.eu,S.ah,ue.oG],styles:[".fury-card-header-heading[_ngcontent-%COMP%]{font-weight:700!important}.small_modal[_ngcontent-%COMP%]{width:500px;padding:5px}.small_modal[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#000}.card[_ngcontent-%COMP%]{overflow:scroll;margin:5px;width:490px;max-height:450px;border-radius:8px;padding:24px}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:5px}.card[_ngcontent-%COMP%]   .text-icon[_ngcontent-%COMP%]{max-width:49.5%}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:14px;padding:24px 8px 0}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.example-tree[_ngcontent-%COMP%]   .mat-nested-tree-node[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%]{padding-left:40px}.example-tree[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%] > .mat-tree-node[_ngcontent-%COMP%]{padding-left:40px}"],data:{animation:[R.X,N.M,k.K]}}),s})();var ee=n(40520),te=n(98545),Ae=n(33344);let be=(()=>{class s{constructor(t,i){this.http=t,this.tokenStorage=i}getHeaders(){var t=new ee.WM,i=this.tokenStorage.getToken();return t.set("token",i||"{}")}getAll(){var t=this.getHeaders();return this.http.get(te._.settings.apiServer.API_URL_BASE+te._.settings.apiServer.SIDENAV_ITEMS,{headers:t})}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(ee.eN),e.LFG(Ae.i))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var Ze=n(39762),Se=n(53580),Ee=n(38932),Oe=n(19165),Le=n(94927),Y=n(92181);function De(s,r){if(1&s&&(e.TgZ(0,"th",17),e._uU(1),e.qZA()),2&s){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name,"")}}function Ie(s,r){if(1&s&&(e.TgZ(0,"td",18),e._uU(1),e.qZA()),2&s){const t=r.$implicit,i=e.oxw(2).$implicit,a=e.oxw();e.xp6(1),e.hij(" ",a.getLabel(i.name,t[i.property]).length>40?a.getLabel(i.name,t[i.property]).slice(0,40)+"...":a.getLabel(i.name,t[i.property])," ")}}function Fe(s,r){if(1&s&&(e.ynx(0,14),e.YNc(1,De,2,1,"th",15),e.YNc(2,Ie,2,1,"td",16),e.BQk()),2&s){const t=e.oxw().$implicit;e.Q6J("matColumnDef",t.property)}}function Ue(s,r){if(1&s&&(e.ynx(0),e.YNc(1,Fe,3,1,"ng-container",13),e.BQk()),2&s){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isModelProperty)}}function Ne(s,r){1&s&&e._UZ(0,"th",19)}function Re(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"td",20),e.TgZ(1,"button",21),e.NdJ("click",function(a){return a.stopPropagation()}),e.TgZ(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(4,"mat-menu",22,23),e.TgZ(6,"button",24),e.NdJ("click",function(){const f=e.CHM(t).$implicit;return e.oxw().updateProfile(f)}),e.TgZ(7,"span"),e._uU(8,"Editar"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&s){const t=e.MAs(5);e.xp6(1),e.Q6J("matMenuTriggerFor",t)}}function Be(s,r){1&s&&e._UZ(0,"tr",25)}function Je(s,r){1&s&&e._UZ(0,"tr",26)}const ke=function(){return["Tables"]},we=[{path:"",component:(()=>{class s{constructor(t,i,a){this.dialog=t,this._sidenavItemsService=i,this._profilesService=a,this.subject$=new O.t(1),this.data$=this.subject$.asObservable(),this.columns=[{name:"Id",property:"id",visible:!1,isModelProperty:!0},{name:"Nombre",property:"name",visible:!0,isModelProperty:!0},{name:"Estatus",property:"status",visible:!0,isModelProperty:!0},{name:"Observaciones",property:"observations",visible:!0,isModelProperty:!0},{name:"Permisos CV",property:"cv_configurations",visible:!0,isModelProperty:!0},{name:"Items",property:"sidenav_items",visible:!1,isModelProperty:!0},{name:"Flotas",property:"fleets",visible:!0,isModelProperty:!0},{name:"Centros de cobro",property:"ccs",visible:!0,isModelProperty:!0},{name:"Acciones",property:"actions",visible:!0}],this.pageSize=10}getLabel(t,i){var a="",f="",h="";if(null!=t)return"Estatus"===t?2==i?"Activo":"Inactivo":"Flotas"===t?(i.forEach(T=>{f=f.length>0?f+", "+T.NAME:T.NAME}),f):"Centros de cobro"===t?(i.forEach(T=>{null!==T.name&&(a=""!==a?a+","+T.name:T.name)}),a):"Permisos CV"===t?(i.forEach(T=>{null!==T.num_permiso&&(h=""!==h?h+","+T.num_permiso:T.num_permiso)}),h):i}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}getData(){this._profilesService.getAll().subscribe(t=>{this.profiles=t,this.dataSource=new v.by(this.profiles),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},t=>{console.log(t)})}ngOnInit(){return(0,c.mG)(this,void 0,void 0,function*(){this.dataSource=new v.by,this.getData(),this.data$.pipe((0,J.h)(t=>!!t)).subscribe(t=>{this.profiles=t,this.dataSource.data=t})})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}getSidenavItemsTree(){return(0,c.mG)(this,void 0,void 0,function*(){return yield this._sidenavItemsService.getAll().toPromise()})}createProfile(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.getSidenavItemsTree();this.dialog.open(G,{data:{sidenav_items:t}}).afterClosed().subscribe(()=>{this.ngOnInit()})})}updateProfile(t){return(0,c.mG)(this,void 0,void 0,function*(){const i=yield this.getSidenavItemsTree();this.dialog.open(G,{data:{sidenav_items:i,profile:t}}).afterClosed().subscribe(()=>{this.ngOnInit()})})}onFilterChange(t){!this.dataSource||(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}ngOnDestroy(){}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(D.uw),e.Y36(be),e.Y36($.L))},s.\u0275cmp=e.Xpm({type:s,selectors:[["profiles-table"]],viewQuery:function(t,i){if(1&t&&(e.Gf(d.NW,7),e.Gf(y.YE,7)),2&t){let a;e.iGM(a=e.CRH())&&(i.paginator=a.first),e.iGM(a=e.CRH())&&(i.sort=a.first)}},inputs:{columns:"columns"},decls:17,vars:10,consts:[["mode","card"],["current","Perfiles",3,"crumbs"],["name","Perfiles",3,"columns","filterChange"],[1,"actions"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.TgZ(0,"fury-page-layout",0),e.TgZ(1,"fury-page-layout-header"),e._UZ(2,"fury-breadcrumbs",1),e.qZA(),e.TgZ(3,"fury-page-layout-content"),e.TgZ(4,"fury-list",2),e.NdJ("filterChange",function(f){return i.onFilterChange(f)}),e.TgZ(5,"div",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.createProfile()}),e.TgZ(7,"mat-icon"),e._uU(8,"add"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"table",5),e.YNc(10,Ue,2,1,"ng-container",6),e.ynx(11,7),e.YNc(12,Ne,1,0,"th",8),e.YNc(13,Re,9,1,"td",9),e.BQk(),e.YNc(14,Be,1,0,"tr",10),e.YNc(15,Je,1,0,"tr",11),e.qZA(),e._UZ(16,"mat-paginator",12),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@fadeInRight",void 0)("crumbs",e.DdM(9,ke)),e.xp6(1),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("columns",i.columns),e.xp6(5),e.Q6J("dataSource",i.dataSource),e.xp6(1),e.Q6J("ngForOf",i.columns),e.xp6(4),e.Q6J("matHeaderRowDef",i.visibleColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.visibleColumns),e.xp6(1),e.Q6J("pageSize",i.pageSize))},directives:[Ze.N,Se.U,Ee.n,Oe.d,Le.n,W.lW,H.Hw,v.BZ,y.YE,o.sg,v.w1,v.fO,v.Dz,v.as,v.nj,d.NW,o.O5,v.ge,y.nU,v.ev,Y.p6,Y.VK,Y.OP,v.XQ,v.Gk],encapsulation:2,data:{animation:[N.M,R.X]}}),s})()}];let He=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[M.Bz.forChild(we)],M.Bz]}),s})();var Qe=n(61620),We=n(74519);const Ge=[{path:"",component:G}];let Ye=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[M.Bz.forChild(Ge)],M.Bz]}),s})(),Ke=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[o.ez,Qe.o9,l.u5,l.UX,We.O,m.Z,_.p,W.ot,D.Is,g.q,H.Ps,j.c,X.LD,S.dp,Ye]]}),s})(),Ve=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[o.ez,He,l.u5,g.q,m.Z,Ke,_.p,u.J]]}),s})()},58527:(b,p,n)=>{n.d(p,{E:()=>g});var o=n(40520),l=n(98545),u=n(5e3),_=n(33344);let g=(()=>{class m{constructor(c,d){this.http=c,this.tokenStorage=d}getHeaders(){var c=new o.WM,d=this.tokenStorage.getToken();return c.set("token",d||"{}")}getAll(c){var d=this.getHeaders();const y=(new o.LE).appendAll(c);return this.http.get(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.AREAS,{params:y,headers:d})}getArea(c){var d=this.getHeaders();return this.http.get(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.AREAS+"/"+c,{headers:d})}createArea(c){var d=this.getHeaders();return this.http.post(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.AREAS,c,{headers:d})}updateArea(c){var d=this.getHeaders();return this.http.put(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.AREAS+"/"+c.id,c,{headers:d})}deleteArea(c){var d=this.getHeaders();return this.http.delete(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.AREAS+"/"+c.id,{headers:d})}getCostCenters(c){var d=this.getHeaders();const y=(new o.LE).appendAll(c);return this.http.get(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.COST_CENTERS,{params:y,headers:d})}}return m.\u0275fac=function(c){return new(c||m)(u.LFG(o.eN),u.LFG(_.i))},m.\u0275prov=u.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},82593:(b,p,n)=>{n.d(p,{V:()=>g});var o=n(40520),l=n(98545),u=n(5e3),_=n(33344);let g=(()=>{class m{constructor(c,d){this.http=c,this.tokenStorage=d,this.baseendpoint=l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.FLEETS}getHeaders(){var c=new o.WM,d=this.tokenStorage.getToken();return c.set("token",d||"{}")}getAll(){var c=this.getHeaders();return this.http.get(this.baseendpoint,{headers:c})}getFiltered(c){var d=this.getHeaders();const y=(new o.LE).appendAll(c);return this.http.get(this.baseendpoint,{headers:d,params:y})}create(c){var d=this.getHeaders();return this.http.post(this.baseendpoint,c,{headers:d})}update(c){var d=this.getHeaders();return this.http.put(this.baseendpoint+"/"+c.id,c,{headers:d})}updateCvConfiguration(c){var d=this.getHeaders();return this.http.post(l._.settings.apiServer.API_URL_BASE+l._.settings.apiServer.CV_CONFIGURATIONS,c,{headers:d})}}return m.\u0275fac=function(c){return new(c||m)(u.LFG(o.eN),u.LFG(_.i))},m.\u0275prov=u.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);