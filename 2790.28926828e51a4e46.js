"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[2790],{92790:(Ue,N,s)=>{s.d(N,{h:()=>Ne});var f=s(3299),l=s(70655),p=s(93075),R=s(88914),M=s(37425),P=s(14499),u=s(71936),e=s(5e3),v=s(48966),I=s(86087),x=s(84847),a=s(32075),k=s(20449),Q=s(96831),_=s(92198),d=s(8062),y=s(76166),T=s(11635),U=s(86590),Y=s(27702),G=s(53212),z=s(24629),A=s(95288),W=s(57261),F=s(92824),m=s(97199),C=s(69808),q=s(75972),O=s(47423),E=s(25245),D=s(77446),Z=s(92181);function $(n,r){1&n&&(e.TgZ(0,"fury-card-header-subheading"),e._uU(1," Facturas disponibles "),e.qZA())}function H(n,r){1&n&&(e.TgZ(0,"fury-card-header-subheading"),e._uU(1," Facturas asociadas "),e.qZA())}function L(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().detailInvoices()}),e._UZ(1,"mat-icon",16),e.qZA()}2&n&&(e.xp6(1),e.Q6J("@scaleIn",void 0))}function B(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().createInvoice()}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e.qZA()}}function V(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA(),e.qZA()}}function j(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().reload()}),e.TgZ(1,"mat-icon"),e._uU(2,"refresh"),e.qZA(),e.qZA()}}function X(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"th",17),e.TgZ(1,"mat-checkbox",18),e.NdJ("change",function(o){e.CHM(t);const c=e.oxw();return o?c.masterToggle():null}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())}}function K(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",19),e.TgZ(1,"mat-checkbox",20),e.NdJ("click",function(o){return o.stopPropagation()})("change",function(o){const h=e.CHM(t).$implicit,g=e.oxw();return o?g.selection.toggle(h):null}),e.qZA(),e.qZA()}if(2&n){const t=r.$implicit,i=e.oxw();e.xp6(1),e.Q6J("checked",i.selection.isSelected(t))}}function ee(n,r){if(1&n&&(e.TgZ(0,"th",24),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name,"")}}function te(n,r){if(1&n&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(2).$implicit,o=e.oxw();e.xp6(1),e.Oqu(o.getLabel(i.name,t[i.property]))}}function ie(n,r){if(1&n&&(e.ynx(0,22),e.YNc(1,ee,2,1,"th",23),e.YNc(2,te,2,1,"td",6),e.BQk()),2&n){const t=e.oxw().$implicit;e.Q6J("matColumnDef",t.property)}}function ne(n,r){if(1&n&&(e.ynx(0),e.YNc(1,ie,3,1,"ng-container",21),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isModelProperty)}}function oe(n,r){1&n&&e._UZ(0,"th",25)}function re(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().viewInvoice(o)}),e.TgZ(1,"span"),e._uU(2,"Ver"),e.qZA(),e.qZA()}}function se(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().updateInvoice(o)}),e.TgZ(1,"span"),e._uU(2,"Editar"),e.qZA(),e.qZA()}}function ce(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().assignRemissions(o)}),e.TgZ(1,"span"),e._uU(2,"Asociar remisiones"),e.qZA(),e.qZA()}}function ae(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().assignTankDeliveryReadings(o)}),e.TgZ(1,"span"),e._uU(2,"Asociar incremento de combustible"),e.qZA(),e.qZA()}}function pe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().assignWeighingMachineReadings(o)}),e.TgZ(1,"span"),e._uU(2,"Asociar pesaje"),e.qZA(),e.qZA()}}function le(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().assignChemicalProductAnalysis(o)}),e.TgZ(1,"span"),e._uU(2,"Asociar an\xe1lisis qu\xedmico"),e.qZA(),e.qZA()}}function de(n,r){if(1&n&&(e.TgZ(0,"td",26),e.TgZ(1,"button",27),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(4,"mat-menu",28,29),e.YNc(6,re,3,0,"button",30),e.YNc(7,se,3,0,"button",30),e.YNc(8,ce,3,0,"button",30),e.YNc(9,ae,3,0,"button",30),e.YNc(10,pe,3,0,"button",30),e.YNc(11,le,3,0,"button",30),e.qZA(),e.qZA()),2&n){const t=r.$implicit,i=e.MAs(5),o=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",i),e.xp6(5),e.Q6J("ngIf",o.view),e.xp6(1),e.Q6J("ngIf",!o.view),e.xp6(1),e.Q6J("ngIf",1==o.reception.documentation_tracking_type&&t.status>=1&&!o.view),e.xp6(1),e.Q6J("ngIf",2==o.reception.documentation_tracking_type&&t.status>=1&&!o.view),e.xp6(1),e.Q6J("ngIf",2==o.reception.documentation_tracking_type&&t.status>=1&&!o.view),e.xp6(1),e.Q6J("ngIf",2==o.reception.documentation_tracking_type&&t.status>=1&&!o.view)}}function me(n,r){1&n&&e._UZ(0,"tr",32)}function ue(n,r){1&n&&e._UZ(0,"tr",33)}let J=(()=>{class n{constructor(t,i,o,c,h,g,ke,Qe){this.data=t,this.dialogRef=i,this.dialog=o,this._invoicesService=c,this._crePermissionsService=h,this.snackbar=g,this._receptionsService=ke,this.router=Qe,this.subject$=new Q.t(1),this.data$=this.subject$.asObservable(),this.selection=new k.Ov(!0,[]),this.invoices=[],this.vmus=[],this.tmus=[],this.currencies=[],this.providers=[],this.reception=new u.T,this.recep=new e.vpe,this.columns=[{name:"Checkbox",property:"select",visible:!0},{name:"Id factura",property:"invoice_id",visible:!1,isModelProperty:!0},{name:"Proveedor",property:"cre_permission_id",visible:!0,isModelProperty:!0},{name:"Folio de factura",property:"invoice_number1",visible:!0,isModelProperty:!0},{name:"Folio de factura 2",property:"invoice_number2",visible:!1,isModelProperty:!0},{name:"Fecha de factura",property:"invoice_date",visible:!0,isModelProperty:!0},{name:"Unidad de medida de volumen",property:"volume_unit_of_measure_id",visible:!1,isModelProperty:!0},{name:"Unidad de medidad de temperatura",property:"temperature_unit_of_measure_id",visible:!1,isModelProperty:!0},{name:"Moneda",property:"currency_id",visible:!1,isModelProperty:!0},{name:"Tipo de cambio",property:"currency_exchange_rate",visible:!1,isModelProperty:!0},{name:"Volumen en documento",property:"invoice_volume",visible:!1,isModelProperty:!0},{name:"Volumen en litros",property:"invoice_volume_liters",visible:!0,isModelProperty:!0},{name:"Temperatura en documento",property:"invoice_temperature",visible:!1,isModelProperty:!0},{name:"Temperatura en celsius",property:"invoice_temperature_celsius",visible:!0,isModelProperty:!0},{name:"Precio por volumen en documento",property:"invoice_ppv",visible:!1,isModelProperty:!0},{name:"Precio por volumen en pesos",property:"invoice_ppv_pesos",visible:!0,isModelProperty:!0},{name:"Precio total en documento",property:"invoice_total_price",visible:!1,isModelProperty:!0},{name:"Precio total en pesos",property:"invoice_total_price_pesos",visible:!0,isModelProperty:!0},{name:"\xdaltima actualizaci\xf3n",property:"timestamp",visible:!1,isModelProperty:!0},{name:"Estatus",property:"status",visible:!0,isModelProperty:!0},{name:"Tarifa almacenamiento",property:"tarifa_de_almac",visible:!0,isModelProperty:!0},{name:"Cargo capacidad almacenamiento",property:"cargo_por_capacidad_almac",visible:!1,isModelProperty:!0},{name:"Cargo uso almacenamiento",property:"cargo_por_uso_almac",visible:!1,isModelProperty:!0},{name:"Cargo volumetrico almacenamiento",property:"cargo_volumetrico_almac",visible:!1,isModelProperty:!0},{name:"Tarifa transporte",property:"tarifa_de_transporte",visible:!0,isModelProperty:!0},{name:"Cargo capacidad transporte",property:"cargo_por_capacidad_trans",visible:!1,isModelProperty:!0},{name:"Cargo uso transporte",property:"cargo_por_uso_trans",visible:!1,isModelProperty:!0},{name:"Cargo volumetrico transporte",property:"cargo_volumetrico_trans",visible:!1,isModelProperty:!0},{name:"Tarifa suministro",property:"tarifa_de_suministro",visible:!1,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10}getLabel(t,i){if(null!=t){if("Unidad de medida de volumen"==t){let o=this.vmus.find(c=>c.id===i);return o?o.unit_of_measure:i}if("Unidad de medidad de temperatura"==t){let o=this.tmus.find(c=>c.id===i);return o?o.unit_of_measure:i}if("Moneda"==t){let o=this.currencies.find(c=>c.id===i);return o?o.currency:i}if("Estatus"!=t){if("Proveedor"==t){let o=this.providers.find(c=>+c.permission_id==+i);return o?o.provider_name:i}return i}switch(+i){case 2:return"Activa";case 1:return"Asignada";case 0:return"Archivada";default:return"No disponible"}}}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}getData(){this.invoices=this.reception.Invoices,this.dataSource=new a.by(this.reception.Invoices),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){this.dataSource=new a.by,this.view?(this.reception=this.rec,this.invoice=new d.m(null)):(this.view=!!this.data.view,this.reception=new u.T(this.data.reception),this.invoice=new d.m(this.data.invoice)),this.getData(),this.currencies=yield this.getCurrencies(),this.tmus=yield this.getTemperatureUnitsOfMeasure(),this.vmus=yield this.getVolumeUnitsOfMeasure(),this.providers=yield this.getProviders(),this.data$.pipe((0,_.h)(t=>!!t)).subscribe(t=>{this.invoices=t,this.dataSource.data=t})})}ngOnChanges(t){for(const i in t)this[i]=t[i].currentValue,this.reload()}getVolumeUnitsOfMeasure(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getUnitsOfMeasure("volume").toPromise()})}getTemperatureUnitsOfMeasure(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getUnitsOfMeasure("temperature").toPromise()})}getCurrencies(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getCurrencies().toPromise()})}getProviders(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getAllByType(3).toPromise()})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}assignRemissions(t){this.dialog.open(T.F,{data:{reception:this.reception,invoice:new d.m(t)}}).afterClosed().subscribe(i=>{i&&(this.reception=i,this.invoices=this.reception.Invoices,this.dataSource=new a.by(this.reception.Invoices),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator),this.recep.emit(this.reception)})}assignTankDeliveryReadings(t){this.dialog.open(U.q,{data:{reception:this.reception,invoice:new d.m(t),remission:t}}).afterClosed().subscribe(i=>{i&&(this.reception=i,this.invoices=this.reception.Invoices,this.dataSource=new a.by(this.reception.Invoices),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator),this.recep.emit(this.reception)})}assignWeighingMachineReadings(t){this.dialog.open(Y.k,{data:{reception:this.reception,invoice:new d.m(t),remission:t}}).afterClosed().subscribe(i=>{i&&(this.reception=i,this.invoices=this.reception.Invoices,this.dataSource=new a.by(this.reception.Invoices),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator),this.recep.emit(this.reception)})}assignChemicalProductAnalysis(t){this.dialog.open(G.K,{data:{reception:this.reception,invoice:new d.m(t),remission:t}}).afterClosed().subscribe(i=>{i&&(this.reception=i,this.invoices=this.reception.Invoices,this.dataSource=new a.by(this.reception.Invoices),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator),this.recep.emit(this.reception)})}onFilterChange(t){!this.dataSource||(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}reload(){this.isLoading=!0,this.ngOnInit(),this.isLoading=!1}close(){this.dialogRef.close(this.reception)}ngOnDestroy(){}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}createInvoice(){this.dialog.open(y.E,{data:{reception:this.reception,invoice:this.invoice,view:!1}}).afterClosed().subscribe(t=>{if(t){var i=new d.m(t.invoice);this.reception.reception_id=t.reception.reception_id,this.reception.Invoices.push(i),this.subject$.next(this.invoices),this.getData(),this.data$.pipe((0,_.h)(o=>!!o)).subscribe(o=>{this.invoices=o,this.dataSource.data=o},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}this.recep.emit(this.reception)})}updateInvoice(t){var i=new d.m(t);this.dialog.open(y.E,{data:{reception:this.data,invoice:i,view:!1}}).afterClosed().subscribe(o=>{o&&(this.reception.reception_id=o.reception.reception_id,this.reception.Invoices[this.reception.Invoices.findIndex(c=>c.invoice_id==o.invoice.invoice_id)]=o.invoice,this.subject$.next(this.invoices),this.view=!1,this.getData(),this.data$.pipe((0,_.h)(c=>!!c)).subscribe(c=>{this.invoices=c,this.dataSource.data=c})),this.recep.emit(this.reception)})}viewInvoice(t){this.dialog.open(y.E,{data:{reception:this.reception,invoice:new d.m(t),view:!0}}).afterClosed().subscribe(i=>{i&&(this.reception.reception_id=i.reception.reception_id,this.reception.Invoices[this.reception.Invoices.findIndex(o=>o.invoice_id==i.invoice.invoice_id)]=i.invoice,this.subject$.next(this.invoices),this.view=!0,this.getData(),this.data$.pipe((0,_.h)(o=>!!o)).subscribe(o=>{this.invoices=o,this.dataSource.data=o})),this.recep.emit(this.reception)})}detailInvoices(){this.dialog.open(n,{data:{reception:this.reception,invoice:null,view:!1}}).afterClosed().subscribe(t=>{t&&(this.reception=t,this.getData(),this.data$.pipe((0,_.h)(i=>!!i)).subscribe(i=>{this.invoices=i,this.dataSource.data=i}),this.recep.emit(this.reception)),this.recep.emit(this.reception)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.WI),e.Y36(v.so),e.Y36(v.uw),e.Y36(z.x),e.Y36(A.w),e.Y36(W.ux),e.Y36(F.J),e.Y36(f.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["invoices-widget"]],viewQuery:function(t,i){if(1&t&&(e.Gf(I.NW,7),e.Gf(x.YE,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.paginator=o.first),e.iGM(o=e.CRH())&&(i.sort=o.first)}},inputs:{view:"view",rec:"rec",columns:"columns"},outputs:{recep:"recep"},features:[e.TTD],decls:24,vars:12,consts:[[4,"ngIf"],["mat-icon-button","","type","button",3,"click",4,"ngIf"],[1,"card-content"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","style","width: 30px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"isLoading"],["mat-icon-button","","type","button",3,"click"],["svgIcon","folder_details"],["mat-header-cell","",2,"width","30px"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.TgZ(0,"fury-card"),e.TgZ(1,"fury-card-header"),e.TgZ(2,"fury-card-header-heading"),e._uU(3," Facturas "),e.qZA(),e.YNc(4,$,2,0,"fury-card-header-subheading",0),e.YNc(5,H,2,0,"fury-card-header-subheading",0),e.TgZ(6,"fury-card-header-actions"),e.YNc(7,L,2,1,"button",1),e.YNc(8,B,3,0,"button",1),e.YNc(9,V,3,0,"button",1),e.YNc(10,j,3,0,"button",1),e.qZA(),e.qZA(),e.TgZ(11,"fury-card-content",2),e.TgZ(12,"table",3),e.ynx(13,4),e.YNc(14,X,2,2,"th",5),e.YNc(15,K,2,1,"td",6),e.BQk(),e.YNc(16,ne,2,1,"ng-container",7),e.ynx(17,8),e.YNc(18,oe,1,0,"th",9),e.YNc(19,de,12,7,"td",10),e.BQk(),e.YNc(20,me,1,0,"tr",11),e.YNc(21,ue,1,0,"tr",12),e.qZA(),e._UZ(22,"mat-paginator",13),e.qZA(),e._UZ(23,"fury-loading-overlay",14),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",!i.view),e.xp6(1),e.Q6J("ngIf",i.view),e.xp6(2),e.Q6J("ngIf",i.view&&2==i.reception.status&&i.rec.Invoices.length>0),e.xp6(1),e.Q6J("ngIf",!i.view&&2==i.reception.status),e.xp6(1),e.Q6J("ngIf",!i.view),e.xp6(1),e.Q6J("ngIf",!i.view&&2==i.reception.status),e.xp6(2),e.Q6J("dataSource",i.dataSource),e.xp6(4),e.Q6J("ngForOf",i.columns),e.xp6(4),e.Q6J("matHeaderRowDef",i.visibleColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.visibleColumns),e.xp6(1),e.Q6J("pageSize",i.pageSize),e.xp6(1),e.Q6J("isLoading",i.isLoading))},directives:[m.i0,m.$X,m.eP,C.O5,m.OA,m.z8,a.BZ,x.YE,a.w1,a.fO,a.Dz,C.sg,a.as,a.nj,I.NW,q.d,m.lO,O.lW,E.Hw,a.ge,D.oG,a.ev,x.nU,Z.p6,Z.VK,Z.OP,a.XQ,a.Gk],styles:[".fury-card[_ngcontent-%COMP%]{background:#195fc7;color:#f5f5f5}.fury-card[_ngcontent-%COMP%]   .fury-card-header-subheading[_ngcontent-%COMP%]{color:#f5f5f5}.gain[_ngcontent-%COMP%]{margin-left:8px;font:var(--font-caption)}.gain[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px;line-height:18px}.card-content[_ngcontent-%COMP%]{padding:0;overflow:scroll}.card-content[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]{padding:0 24px 24px}.card-content[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font:var(--font-body-1);text-transform:uppercase}.card-content[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font:var(--font-display-1)}.card-content[_ngcontent-%COMP%]   .sections[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   .indicator[_ngcontent-%COMP%]{margin-left:3px;font-size:32px;height:32px;width:32px}.card-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:170px;max-width:100%;display:flex;flex:1;position:relative}"],data:{animation:[R.M,P.X,M.K]}}),n})();var _e=s(52190),he=s(39762),ge=s(53580),fe=s(38932),w=s(92081),b=s(30277),S=s(67322),ve=s(74107),Ce=s(90508);function be(n,r){1&n&&e._uU(0,"Datos de los proveedores")}function xe(n,r){if(1&n&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.permission_id),e.xp6(1),e.Oqu(t.provider_name+" - "+t.permission)}}function ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",16),e.TgZ(1,"mat-label"),e._uU(2,"Proveedor:"),e.qZA(),e.TgZ(3,"mat-select",17),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onChangeProvider(o.value)}),e.YNc(4,xe,2,2,"mat-option",18),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.cpsc)}}function Te(n,r){if(1&n&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.permission_id),e.xp6(1),e.Oqu(t.provider_name+" - "+t.permission)}}function Ze(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",16),e.TgZ(1,"mat-label"),e._uU(2,"Almac\xe9n:"),e.qZA(),e.TgZ(3,"mat-select",20),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onChangeStorage(o.value)}),e.YNc(4,Te,2,2,"mat-option",18),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.cpss)}}function we(n,r){if(1&n&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.permission_id),e.xp6(1),e.Oqu(t.provider_name+" - "+t.permission)}}function Re(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",16),e.TgZ(1,"mat-label"),e._uU(2,"Transporte:"),e.qZA(),e.TgZ(3,"mat-select",21),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onChangeTransport(o.value)}),e.YNc(4,we,2,2,"mat-option",18),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.cpst)}}function Me(n,r){if(1&n&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.site_code),e.xp6(1),e.Oqu(t.station_name)}}function Pe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",16),e.TgZ(1,"mat-label"),e._uU(2,"Estaci\xf3n:"),e.qZA(),e.TgZ(3,"mat-select",22),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onChangeStation(o.value)}),e.YNc(4,Me,2,2,"mat-option",18),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.stations)}}function Ie(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().loadModalWidget("remissions")}),e._uU(1,"COMPROBANTES DESCARGA"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.providersFormGroup.invalid)}}function Ae(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().loadModalWidget("invoices")}),e._uU(1,"DOCUMENTOS"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.providersFormGroup.invalid)}}function We(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().toFile()}),e._uU(1,"ARCHIVAR"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.providersFormGroup.invalid)}}function Fe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"div",25),e.TgZ(2,"invoices-widget",26),e.NdJ("recep",function(o){return e.CHM(t),e.oxw().onUpdateReception(o)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("rec",t.theReception)("view",!0)}}function Oe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"div",25),e.TgZ(2,"remissions-widget",26),e.NdJ("recep",function(o){return e.CHM(t),e.oxw().onUpdateReception(o)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("rec",t.theReception)("view",!0)}}const Je=function(){return["Tables/receptions"]},Se=[{path:"",component:(()=>{class n{constructor(t,i,o,c,h,g){this.router=t,this.dialog=i,this.snackbar=o,this._receptionsService=c,this._stationsService=h,this._crePermissionsService=g,this.cpsc=[],this.cpss=[],this.cpst=[],this.stations=[],this.theReception=new u.T,this.providersFormGroup=new p.cw({reception_id:new p.NI(0),site_code:new p.NI("",[p.kI.required]),cre_permission_provider_id:new p.NI("",[p.kI.required]),cre_permission_storage_id:new p.NI,cre_permission_transport_id:new p.NI,timestamp:new p.NI,status:new p.NI(!0)}),this.theReception=new u.T(history.state.data)}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){this.cpsc=yield this.getCrePermissionsComertialization(),this.cpss=yield this.getCrePermissionsStorage(),this.cpst=yield this.getCrePermissionsTransporter(),this.stations=yield this.getStations(),0!=this.theReception.reception_id?(this.providersFormGroup.controls.reception_id.setValue(this.theReception.reception_id),this.providersFormGroup.controls.site_code.setValue(this.theReception.site_code),this.providersFormGroup.controls.cre_permission_provider_id.setValue(this.theReception.cre_permission_provider_id),this.providersFormGroup.controls.cre_permission_storage_id.setValue(this.theReception.cre_permission_storage_id),this.providersFormGroup.controls.cre_permission_transport_id.setValue(this.theReception.cre_permission_transport_id),this.providersFormGroup.controls.timestamp.setValue(this.theReception.status),this.providersFormGroup.controls.status.setValue(this.theReception.status),this.providersFormGroup.controls.site_code.disable(),this.providersFormGroup.controls.cre_permission_provider_id.disable(),this.providersFormGroup.controls.cre_permission_storage_id.disable(),this.providersFormGroup.controls.cre_permission_transport_id.disable()):(this.theReception.reception_id=0,this.theReception.status=2)})}getCrePermissionsStorage(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getAllByType(1).toPromise()})}getCrePermissionsDistribution(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getAllByType(2).toPromise()})}getCrePermissionsComertialization(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getAllByType(3).toPromise()})}getCrePermissionsTransporter(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._crePermissionsService.getAllByType(4).toPromise()})}getStations(){return(0,l.mG)(this,void 0,void 0,function*(){return yield this._stationsService.getAll(1).toPromise()})}createReception(){this._receptionsService.create(this.theReception).subscribe(t=>{this.theReception.reception_id=t.id,this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]})},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}integerOnly(t){return/^[1-9][0-9]*?$/.test(t.key)}numericOnly(t){let i=t.target.value+t.key;return!!new RegExp(/^([1-9][0-9]{0,7}||[0]||[0][.][0-9]{0,2}||[1-9][0-9]{0,7}[.][0-9]{0,2})$/).test(i)}onChangeProvider(t){var i=this.cpsc.find(o=>o.permission_id===t);this.theReception.cre_permission_provider_id=t,this.theReception.default_volume_unit_of_measure=i.default_volume_unit_of_measure,this.theReception.default_currency=i.default_currency,this.theReception.permission=i.rfc,this.theReception.provider_name=i.provider_name,this.theReception.documentation_tracking_type=i.documentation_tracking_type}onChangeStorage(t){var i=this.cpss.find(o=>o.permission_id===t);this.theReception.cre_permission_storage_id=t,this.theReception.storage_provider_name=i.provider_name}onChangeTransport(t){var i=this.cpst.find(o=>o.permission_id===t);this.theReception.cre_permission_transport_id=t,this.theReception.transport_provider_name=i.provider_name}onChangeStation(t){var i=this.stations.find(o=>o.site_code===t);this.theReception.chemical_analysis_machine=1==i.chemical_analysis_machine,this.theReception.weighing_machine=1==i.weighing_machine,this.theReception.site_code=t,this.theReception.station_name=i.station_name}loadModalWidget(t){switch(this.theReception.reception_id=this.providersFormGroup.controls.reception_id.value,this.theReception.cre_permission_provider_id=this.providersFormGroup.controls.cre_permission_provider_id.value,this.theReception.site_code=this.providersFormGroup.controls.site_code.value,this.theReception.cre_permission_storage_id=this.providersFormGroup.controls.cre_permission_storage_id.value,this.theReception.cre_permission_transport_id=this.providersFormGroup.controls.cre_permission_transport_id.value,this.theReception.status=this.providersFormGroup.controls.status.value?2:1,t){case"remissions":this.dialog.open(T.F,{data:{reception:this.theReception,invoice:null,view:!1,parentName:"receptions_wizard"}}).afterClosed().subscribe(i=>{i&&(this.theReception=i,this.providersFormGroup.controls.reception_id.setValue(this.theReception.reception_id),this.ngOnInit())});break;case"invoices":this.dialog.open(J,{data:{reception:this.theReception,invoice:null,view:!1,parentName:"receptions_wizard"}}).afterClosed().subscribe(i=>{i&&(this.theReception=i)});break;default:console.log(t)}}submit(){this.theReception.reception_id>0?this.updateReception():this.createReception()}toFile(){this.theReception.status=0,this._receptionsService.file(this.theReception).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.router.navigateByUrl("/tables/receptions")},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}updateReception(){this._receptionsService.update(this.theReception).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]})},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}tableRecepciones(){this.router.navigateByUrl("/tables/receptions")}onUpdateReception(t){var i=new u.T(t);this.theReception=i,this.ngOnInit()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(v.uw),e.Y36(W.ux),e.Y36(F.J),e.Y36(_e.w),e.Y36(A.w))},n.\u0275cmp=e.Xpm({type:n,selectors:[["fury-form-wizard"]],decls:27,vars:16,consts:[["mode","card"],["current","Recepciones",3,"crumbs"],[1,"card",2,"overflow","scroll","padding","30px"],[1,"heading"],[3,"linear"],["stepper","matVerticalStepper"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"subheading"],["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxFlex","auto","appearance","outline",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-raised-button","","mat-button","","type","button",3,"disabled","click",4,"ngIf"],["color","primary","mat-raised-button","","color","primary","mat-button","","type","button",3,"click"],["class","content","fxLayout","column","fxLayoutGap","8px",4,"ngIf"],["fxFlex","auto","appearance","outline"],["formControlName","cre_permission_provider_id",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","cre_permission_storage_id",3,"selectionChange"],["formControlName","cre_permission_transport_id",3,"selectionChange"],["formControlName","site_code",3,"selectionChange"],["color","primary","mat-raised-button","","mat-button","","type","button",3,"disabled","click"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxFlex","grow",1,"route-animations-elements"],[1,"fullheight",3,"rec","view","recep"]],template:function(t,i){1&t&&(e.TgZ(0,"fury-page-layout",0),e.TgZ(1,"fury-page-layout-header"),e._UZ(2,"fury-breadcrumbs",1),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e._uU(5,"Documentaci\xf3n de entradas de combustible:"),e.qZA(),e.TgZ(6,"mat-vertical-stepper",4,5),e.TgZ(8,"mat-step",6),e.TgZ(9,"form",7),e.YNc(10,be,1,0,"ng-template",8),e.TgZ(11,"div",9),e._uU(12,"Seleccionar permisos CRE por tipo de proveedor."),e.qZA(),e.TgZ(13,"div",10),e.YNc(14,ye,5,1,"mat-form-field",11),e.YNc(15,Ze,5,1,"mat-form-field",11),e.qZA(),e.TgZ(16,"div",10),e.YNc(17,Re,5,1,"mat-form-field",11),e.YNc(18,Pe,5,1,"mat-form-field",11),e.qZA(),e.TgZ(19,"div",12),e.YNc(20,Ie,2,1,"button",13),e.YNc(21,Ae,2,1,"button",13),e.YNc(22,We,2,1,"button",13),e.TgZ(23,"button",14),e.NdJ("click",function(){return i.tableRecepciones()}),e._uU(24,"RECEPCIONES"),e.qZA(),e.qZA(),e.YNc(25,Fe,3,2,"div",15),e.YNc(26,Oe,3,2,"div",15),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@fadeInRight",void 0)("crumbs",e.DdM(15,Je)),e.xp6(1),e.Q6J("@fadeInUp",void 0),e.xp6(3),e.Q6J("linear",!0),e.xp6(2),e.Q6J("stepControl",i.providersFormGroup),e.xp6(1),e.Q6J("formGroup",i.providersFormGroup),e.xp6(5),e.Q6J("ngIf",i.providersFormGroup),e.xp6(1),e.Q6J("ngIf",i.providersFormGroup),e.xp6(2),e.Q6J("ngIf",i.providersFormGroup),e.xp6(1),e.Q6J("ngIf",i.providersFormGroup),e.xp6(2),e.Q6J("ngIf",2==i.theReception.status&&(1==i.theReception.documentation_tracking_type||3==i.theReception.documentation_tracking_type)),e.xp6(1),e.Q6J("ngIf",2==i.theReception.status&&(1==i.theReception.documentation_tracking_type||2==i.theReception.documentation_tracking_type)),e.xp6(1),e.Q6J("ngIf",2==i.theReception.status&&(i.theReception.Invoices.length>0||i.theReception.Remissions.length>0)),e.xp6(3),e.Q6J("ngIf",i.theReception.reception_id>-1&&1==i.theReception.documentation_tracking_type||2==i.theReception.documentation_tracking_type),e.xp6(1),e.Q6J("ngIf",i.theReception.reception_id>-1&&1==i.theReception.documentation_tracking_type||3==i.theReception.documentation_tracking_type))},directives:[he.N,ge.U,fe.n,w.Vq,w.C0,p._Y,p.JL,p.sg,w.VY,b.xw,b.SQ,C.O5,b.Wh,O.lW,S.KE,b.yH,S.hX,ve.gD,p.JJ,p.u,C.sg,Ce.ey,J,T.F],styles:[".title[_ngcontent-%COMP%]{color:#000}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}"],data:{animation:[P.X,R.M,M.K]}}),n})()}];let Ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Se)],f.Bz]}),n})()}}]);