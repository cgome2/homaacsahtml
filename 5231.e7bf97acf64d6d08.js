"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[5231],{75231:(Zt,K,c)=>{c.r(K),c.d(K,{FleetsTableModule:()=>bt});var _=c(69808),i=c(93075),O=c(61264),P=c(4940),q=c(7057),N=c(72467),h=c(3299),I=c(86087),x=c(84847),d=c(32075),ee=c(96831),T=c(92198),w=c(88914),D=c(14499),U=c(37425),F=c(70655),u=c(48966),S=c(40520),he=c(74204);class fe{constructor(n){this.id=n&&n.id||0,this.NAME=n&&n.NAME||"",this.fleet_id=n&&n.fleet_id||0,this.status=n&&n.status||0,this.code=n&&n.code||0,this.default_rule=n&&n.default_rule||0,this.address=n&&n.address||"",this.phone=n&&n.phone||"",this.fax=n&&n.fax||"",this.email=n&&n.email||"",this.contact=n&&n.contact||"",this.use_pin_code=n&&n.use_pin_code||0,this.auth_pin_from=n&&n.auth_pin_from||0,this.nr_pin_retries=n&&n.nr_pin_retries||0,this.block_if_pin_retries_fail=n&&n.block_if_pin_retries_fail||0,this.opos_prompt_for_plate=n&&n.opos_prompt_for_plate||0,this.opos_prompt_for_odometer=n&&n.opos_prompt_for_odometer||0,this.do_odo_reasonability_check=n&&n.do_odo_reasonability_check||0,this.max_odo_delta_allowed=n&&n.max_odo_delta_allowed||0,this.nr_odo_retries=n&&n.nr_odo_retries||0,this.price_list_id=n&&n.price_list_id||0,this.black_white_type=n&&n.black_white_type||0,this.sent_to_fho=n&&n.sent_to_fho||0,this.sent_to_dho=n&&n.sent_to_dho||0,this.opos_prompt_for_engine_hours=n&&n.opos_prompt_for_engine_hours||0,this.address2=n&&n.address2||"",this.city=n&&n.city||"",this.state=n&&n.state||"",this.zip=n&&n.zip||"",this.user_data1=n&&n.user_data1||"",this.user_data2=n&&n.user_data2||"",this.user_data3=n&&n.user_data3||"",this.user_data4=n&&n.user_data4||"",this.user_data5=n&&n.user_data5||"",this.disable_viu_two_stage=n&&n.disable_viu_two_stage||0,this.prompt_always_for_viu=n&&n.prompt_always_for_viu||0,this.discovered=n&&n.discovered||0,this.do_eh_reasonability_check=n&&n.do_eh_reasonability_check||0,this.max_eh_delta_allowed=n&&n.max_eh_delta_allowed||0,this.nr_eh_retries=n&&n.nr_eh_retries||0,this.reject_if_eh_check_fails=n&&n.reject_if_eh_check_fails||0,this.reject_if_odm_check_fails=n&&n.reject_if_odm_check_fails||0}}var e=c(5e3),G=c(28196),M=c(57261),te=c(86428),Q=c(59968),R=c(36551),v=c(25245),p=c(30277),f=c(92081),g=c(67322),z=c(77531),oe=c(74107),E=c(32368),J=c(79814),k=c(47423),ae=c(77446),ne=c(90508);function ge(a,n){1&a&&e._uU(0,"Crear departamento")}function be(a,n){if(1&a&&(e.TgZ(0,"mat-option",53),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.NAME)}}function Ze(a,n){if(1&a&&(e.TgZ(0,"mat-radio-button",36),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.type)}}function Te(a,n){1&a&&e._uU(0,"Informaci\xf3n")}function Ce(a,n){1&a&&e._uU(0,"Validaci\xf3n")}let L=(()=>{class a{constructor(t,o,r,s,l,m){this.data=t,this.dialogRef=o,this.dialog=r,this.groupRulesService=s,this.snackbar=l,this.departmentsService=m,this.active_label="Activada",this.theDepartment=new fe,this.groupRules=[],this.pin_block=!1,this.odo_block=!1,this.eh_block=!1,this.plate_block=!1,this.isdefaultdepartment=!1,this.typesOfList=[{id:1,type:"Lista de veh\xedculos autorizados (Lista positiva)",checked:!0},{id:2,type:"Lista de veh\xedculos no autorizados (Lista negativa)",checked:!1}],this.generalFormGroup=new i.cw({id:new i.NI,fleet_id:new i.NI,NAME:new i.NI("",[i.kI.required,i.kI.minLength(2)]),code:new i.NI("",[i.kI.required,i.kI.pattern("^[1-9][0-9]{0,8}?$")]),default_rule:new i.NI(2e8,[i.kI.required]),status:new i.NI(!0,[i.kI.required]),black_white_type:new i.NI(1,i.kI.pattern("^[12]$"))}),this.informationFormGroup=new i.cw({address:new i.NI,address2:new i.NI,city:new i.NI,state:new i.NI,zip:new i.NI,contact:new i.NI,phone:new i.NI(""),fax:new i.NI(""),email:new i.NI("",[i.kI.email]),price_list_id:new i.NI(0)}),this.validationFormGroup=new i.cw({use_pin_code:new i.NI(!1),auth_pin_from:new i.NI(2),nr_pin_retries:new i.NI,block_if_pin_retries_fail:new i.NI(!1),opos_prompt_for_odometer:new i.NI(!1),do_odo_reasonability_check:new i.NI(!1),max_odo_delta_allowed:new i.NI,nr_odo_retries:new i.NI,reject_if_odm_check_fails:new i.NI(!1),opos_prompt_for_engine_hours:new i.NI(!1),do_eh_reasonability_check:new i.NI(!1),max_eh_delta_allowed:new i.NI,nr_eh_retries:new i.NI,reject_if_eh_check_fails:new i.NI(!1),opos_prompt_for_plate:new i.NI(!1)})}ngOnInit(){return(0,F.mG)(this,void 0,void 0,function*(){this.fleet=this.data.fleet,this.groupRules=yield this.getGroupRules(),null!=this.data.department?(this.theDepartment=this.data.department,this.generalFormGroup.setValue({id:this.theDepartment.id,fleet_id:this.fleet.id,NAME:this.theDepartment.NAME,code:this.theDepartment.code,default_rule:this.theDepartment.default_rule,status:2==this.theDepartment.status,black_white_type:this.theDepartment.black_white_type}),this.informationFormGroup.setValue({address:this.theDepartment.address,address2:this.theDepartment.address2,city:this.theDepartment.city,state:this.theDepartment.state,zip:this.theDepartment.zip,contact:this.theDepartment.contact,phone:this.theDepartment.phone,fax:this.theDepartment.fax,email:this.theDepartment.email,price_list_id:this.theDepartment.price_list_id}),this.validationFormGroup.setValue({use_pin_code:0!=this.theDepartment.use_pin_code,auth_pin_from:this.theDepartment.auth_pin_from,nr_pin_retries:0==this.theDepartment.nr_pin_retries?"":this.theDepartment.nr_pin_retries,block_if_pin_retries_fail:0!=this.theDepartment.block_if_pin_retries_fail,opos_prompt_for_odometer:0!=this.theDepartment.opos_prompt_for_odometer,do_odo_reasonability_check:0!=this.theDepartment.do_odo_reasonability_check,max_odo_delta_allowed:0==this.theDepartment.max_odo_delta_allowed?"":this.theDepartment.max_odo_delta_allowed,nr_odo_retries:0==this.theDepartment.nr_odo_retries?"":this.theDepartment.nr_odo_retries,reject_if_odm_check_fails:0!=this.theDepartment.reject_if_odm_check_fails,opos_prompt_for_engine_hours:0!=this.theDepartment.opos_prompt_for_engine_hours,do_eh_reasonability_check:0!=this.theDepartment.do_eh_reasonability_check,max_eh_delta_allowed:0==this.theDepartment.max_eh_delta_allowed?"":this.theDepartment.max_eh_delta_allowed,nr_eh_retries:0==this.theDepartment.nr_eh_retries?"":this.theDepartment.nr_eh_retries,reject_if_eh_check_fails:0!=this.theDepartment.reject_if_eh_check_fails,opos_prompt_for_plate:0!=this.theDepartment.opos_prompt_for_plate}),this.pin_block=1==this.theDepartment.use_pin_code,this.odo_block=1==this.theDepartment.opos_prompt_for_odometer,this.eh_block=1==this.theDepartment.opos_prompt_for_engine_hours,this.plate_block=1==this.theDepartment.opos_prompt_for_plate,this.isdefaultdepartment=99999==this.theDepartment.code):(this.generalFormGroup.controls.fleet_id.setValue(this.fleet.id),this.generalFormGroup.controls.default_rule.setValue(this.fleet.default_rule))})}getGroupRules(){return(0,F.mG)(this,void 0,void 0,function*(){return yield this.groupRulesService.getAll().toPromise()})}numericOnly(t){let o=t.target.value+t.key;return!!new RegExp(/^([1-9][0-9]{0,7}||[0])$/).test(o)}onCheckPin(t){this.pin_block=t.checked,t.checked||(this.validationFormGroup.controls.auth_pin_from.setValue(2),this.validationFormGroup.controls.nr_pin_retries.setValue(""),this.validationFormGroup.controls.block_if_pin_retries_fail.setValue(!1))}onCheckOdometer(t){this.odo_block=t.checked,t.checked||(this.validationFormGroup.controls.do_odo_reasonability_check.setValue(!1),this.validationFormGroup.controls.max_odo_delta_allowed.setValue(""),this.validationFormGroup.controls.nr_odo_retries.setValue(""),this.validationFormGroup.controls.reject_if_odm_check_fails.setValue(!1))}onCheckEngineHours(t){this.eh_block=t.checked,t.checked||(this.validationFormGroup.controls.do_eh_reasonability_check.setValue(!1),this.validationFormGroup.controls.max_eh_delta_allowed.setValue(""),this.validationFormGroup.controls.nr_eh_retries.setValue(""),this.validationFormGroup.controls.reject_if_eh_check_fails.setValue(!1))}onCheckPlateNumber(t){this.plate_block=t.checked}changePinOrig(t){this.theDepartment.auth_pin_from=t.value}setActiveDepartment(t){this.active_label=t.checked?"Activada":"Bloqueada",this.theDepartment.status=t.checked?2:1}changeTypeOfList(t){this.theDepartment.black_white_type=t.value}submit(){var t;this.theDepartment.NAME=this.generalFormGroup.controls.NAME.value,this.theDepartment.fleet_id=this.fleet.id,this.theDepartment.code=this.generalFormGroup.controls.code.value,this.theDepartment.default_rule=this.generalFormGroup.controls.default_rule.value,this.theDepartment.status=this.generalFormGroup.controls.status.value?2:1,this.theDepartment.black_white_type=this.generalFormGroup.controls.black_white_type.value,this.theDepartment.address=this.informationFormGroup.controls.address.value,this.theDepartment.address2=this.informationFormGroup.controls.address2.value,this.theDepartment.city=this.informationFormGroup.controls.city.value,this.theDepartment.state=this.informationFormGroup.controls.state.value,this.theDepartment.zip=this.informationFormGroup.controls.zip.value,this.theDepartment.contact=this.informationFormGroup.controls.contact.value,this.theDepartment.phone=this.informationFormGroup.controls.phone.value,this.theDepartment.fax=this.informationFormGroup.controls.fax.value,this.theDepartment.email=this.informationFormGroup.controls.email.value,this.theDepartment.price_list_id=this.informationFormGroup.controls.price_list_id.value,this.theDepartment.use_pin_code=this.validationFormGroup.controls.use_pin_code.value?1:0,this.theDepartment.auth_pin_from=this.validationFormGroup.controls.auth_pin_from.value,this.theDepartment.nr_pin_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_pin_retries.value)?0:t,this.theDepartment.block_if_pin_retries_fail=this.validationFormGroup.controls.block_if_pin_retries_fail.value?1:0,this.theDepartment.opos_prompt_for_odometer=this.validationFormGroup.controls.opos_prompt_for_odometer.value?1:0,this.theDepartment.do_odo_reasonability_check=this.validationFormGroup.controls.do_odo_reasonability_check.value?1:0,this.theDepartment.max_odo_delta_allowed=[null,""].includes(t=this.validationFormGroup.controls.max_odo_delta_allowed.value)?0:t,this.theDepartment.nr_odo_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_odo_retries.value)?0:t,this.theDepartment.reject_if_odm_check_fails=this.validationFormGroup.controls.reject_if_odm_check_fails.value?1:0,this.theDepartment.opos_prompt_for_engine_hours=this.validationFormGroup.controls.opos_prompt_for_engine_hours.value?1:0,this.theDepartment.do_eh_reasonability_check=this.validationFormGroup.controls.do_eh_reasonability_check.value?1:0,this.theDepartment.max_eh_delta_allowed=[null,""].includes(t=this.validationFormGroup.controls.max_eh_delta_allowed.value)?0:t,this.theDepartment.nr_eh_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_eh_retries.value)?0:t,this.theDepartment.reject_if_eh_check_fails=this.validationFormGroup.controls.reject_if_eh_check_fails.value?1:0,this.theDepartment.opos_prompt_for_plate=this.validationFormGroup.controls.opos_prompt_for_plate.value?1:0,this.theDepartment.id>0?this.updateDepartment():this.createDepartment()}createDepartment(){this.departmentsService.create(this.theDepartment).subscribe(t=>{this.theDepartment.id=t.id,this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close(this.theDepartment)},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}updateDepartment(){this.departmentsService.update(this.theDepartment).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close(this.theDepartment)},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.WI),e.Y36(u.so),e.Y36(u.uw),e.Y36(G.o),e.Y36(M.ux),e.Y36(te._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["fury-form-wizard"]],decls:151,vars:31,consts:[[1,"title"],["fxLayout","column","fxLayoutAlign","start center"],[1,"card",2,"overflow","scroll","height","700px","width","600px"],[3,"linear"],["stepper","matVerticalStepper"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"subheading"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxFlex","auto"],["formControlName","NAME","matInput","","required",""],["formControlName","code","matInput","","required","",3,"keypress"],["formControlName","default_rule"],[3,"value",4,"ngFor","ngForOf"],["formControlName","status",3,"disabled","change"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","24px",1,"preview-content",2,"flex-flow","inherit","margin-top","30px","margin-bottom","30px"],["color","accent","fxLayout","column","fxLayoutGap","20px","required","","formControlName","black_white_type",3,"change"],["class","radio",3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-button","","type","button",3,"disabled","click"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled"],["formControlName","address","matInput",""],["formControlName","address2","matInput",""],["formControlName","city","matInput",""],["formControlName","state","matInput",""],["formControlName","zip","matInput",""],["formControlName","contact","matInput",""],["formControlName","phone","matInput",""],["formControlName","fax","matInput",""],["formControlName","email","matInput",""],["color","primary","mat-button","","matStepperPrevious","","type","button"],["fxLayout","row","fxLayoutGap","5px",1,"content"],["fxLayout","column","fxLayoutGap","5px",1,"validation-block","content"],["formControlName","use_pin_code",1,"checkbox",3,"change"],["color","accent","fxLayout","column","fxLayoutGap","10px","required","","formControlName","auth_pin_from",1,"radio",3,"disabled","change"],[1,"radio",3,"value"],["fxFlex","auto",1,"input-text"],["formControlName","nr_pin_retries","matInput","",3,"readonly","keypress"],["formControlName","block_if_pin_retries_fail",1,"checkbox",3,"disabled"],["formControlName","opos_prompt_for_plate",1,"checkbox"],["formControlName","opos_prompt_for_engine_hours",1,"checkbox",3,"change"],["formControlName","do_eh_reasonability_check",1,"checkbox",3,"disabled"],["formControlName","max_eh_delta_allowed","matInput","",3,"readonly","keypress"],["formControlName","nr_eh_retries","matInput","",3,"readonly","keypress"],["formControlName","reject_if_eh_check_fails",1,"checkbox",3,"disabled"],["formControlName","opos_prompt_for_odometer",1,"checkbox",3,"change"],["formControlName","do_odo_reasonability_check",1,"checkbox",3,"disabled"],["formControlName","max_odo_delta_allowed","matInput","",3,"readonly","keypress"],["formControlName","nr_odo_retries","matInput","",3,"readonly","keypress"],["formControlName","reject_if_odm_check_fails",1,"checkbox",3,"disabled"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","5px",1,"actions"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled","click"],[3,"value"]],template:function(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"fury-page"),e.TgZ(1,"fury-title",0),e.TgZ(2,"mat-icon"),e._uU(3,"group_work"),e.qZA(),e.TgZ(4,"span"),e._uU(5,"Form Wizard"),e.qZA(),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",2),e.TgZ(8,"mat-horizontal-stepper",3,4),e.TgZ(10,"mat-step",5),e.TgZ(11,"form",6),e.YNc(12,ge,1,0,"ng-template",7),e.TgZ(13,"div",8),e._uU(14,"Crear un departamento o centro de costos"),e.qZA(),e.TgZ(15,"div",9),e.TgZ(16,"mat-form-field",10),e.TgZ(17,"mat-label"),e._uU(18,"Nombre del departamento"),e.qZA(),e._UZ(19,"input",11),e.TgZ(20,"mat-hint"),e._uU(21,"Nombre identificador del departamento"),e.qZA(),e.qZA(),e.TgZ(22,"mat-form-field",10),e.TgZ(23,"mat-label"),e._uU(24,"C\xf3digo"),e.qZA(),e.TgZ(25,"input",12),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.TgZ(26,"mat-hint"),e._uU(27,"C\xf3digo num\xe9rico \xfanico del departamento"),e.qZA(),e.qZA(),e.TgZ(28,"mat-form-field",10),e.TgZ(29,"mat-label"),e._uU(30,"Regla de carga predeterminada"),e.qZA(),e.TgZ(31,"mat-select",13),e.YNc(32,be,2,2,"mat-option",14),e.qZA(),e.TgZ(33,"mat-hint"),e._uU(34,"Regla predeterminada para veh\xedculos del departamento."),e.qZA(),e.qZA(),e.TgZ(35,"mat-slide-toggle",15),e.NdJ("change",function(l){return o.setActiveDepartment(l)}),e._uU(36),e.qZA(),e.qZA(),e.TgZ(37,"div",16),e.TgZ(38,"mat-radio-group",17),e.NdJ("change",function(l){return o.changeTypeOfList(l)}),e.YNc(39,Ze,2,2,"mat-radio-button",18),e.qZA(),e.qZA(),e.TgZ(40,"div",19),e.TgZ(41,"button",20),e.NdJ("click",function(){return e.CHM(r),e.MAs(9).reset()}),e._uU(42,"LIMPIAR"),e.qZA(),e.TgZ(43,"button",21),e._uU(44,"SIGUIENTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(45,"mat-step",5),e.TgZ(46,"form",6),e.YNc(47,Te,1,0,"ng-template",7),e.TgZ(48,"div",8),e._uU(49,"Complete los datos de contacto"),e.qZA(),e.TgZ(50,"div",9),e.TgZ(51,"mat-form-field",10),e.TgZ(52,"mat-label"),e._uU(53,"Direcci\xf3n"),e.qZA(),e._UZ(54,"input",22),e.qZA(),e.TgZ(55,"mat-form-field",10),e.TgZ(56,"mat-label"),e._uU(57,"Direcci\xf3n 2"),e.qZA(),e._UZ(58,"input",23),e.qZA(),e.TgZ(59,"mat-form-field",10),e.TgZ(60,"mat-label"),e._uU(61,"Ciudad"),e.qZA(),e._UZ(62,"input",24),e.qZA(),e.TgZ(63,"mat-form-field",10),e.TgZ(64,"mat-label"),e._uU(65,"Estado"),e.qZA(),e._UZ(66,"input",25),e.qZA(),e.TgZ(67,"mat-form-field",10),e.TgZ(68,"mat-label"),e._uU(69,"C\xf3digo postal"),e.qZA(),e._UZ(70,"input",26),e.qZA(),e.TgZ(71,"mat-form-field",10),e.TgZ(72,"mat-label"),e._uU(73,"Nombre del contacto"),e.qZA(),e._UZ(74,"input",27),e.qZA(),e.TgZ(75,"mat-form-field",10),e.TgZ(76,"mat-label"),e._uU(77,"Tel\xe9fono"),e.qZA(),e._UZ(78,"input",28),e.qZA(),e.TgZ(79,"mat-form-field",10),e.TgZ(80,"mat-label"),e._uU(81,"Fax"),e.qZA(),e._UZ(82,"input",29),e.qZA(),e.TgZ(83,"mat-form-field",10),e.TgZ(84,"mat-label"),e._uU(85,"Email"),e.qZA(),e._UZ(86,"input",30),e.qZA(),e.TgZ(87,"div",19),e.TgZ(88,"button",31),e._uU(89,"ANTERIOR"),e.qZA(),e.TgZ(90,"button",21),e._uU(91,"SIGUIENTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(92,"mat-step",5),e.TgZ(93,"form",6),e.YNc(94,Ce,1,0,"ng-template",7),e.TgZ(95,"div",8),e._uU(96,"Activar campos de validaci\xf3n para solicitar al usuario desde POS"),e.qZA(),e.TgZ(97,"div",32),e.TgZ(98,"div",33),e.TgZ(99,"mat-checkbox",34),e.NdJ("change",function(l){return o.onCheckPin(l)}),e._uU(100,"Solicitar c\xf3digo PIN"),e.qZA(),e.TgZ(101,"mat-radio-group",35),e.NdJ("change",function(l){return o.changePinOrig(l)}),e.TgZ(102,"mat-radio-button",36),e._uU(103,"Usar PIN del dispositivo autorizador"),e.qZA(),e.TgZ(104,"mat-radio-button",36),e._uU(105,"Usar PIN de base de datos"),e.qZA(),e.qZA(),e.TgZ(106,"mat-form-field",37),e.TgZ(107,"mat-label"),e._uU(108,"N\xfamero de reintentos"),e.qZA(),e.TgZ(109,"input",38),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(110,"mat-checkbox",39),e._uU(111,"Bloquear si los intentos fallan"),e.qZA(),e.qZA(),e.TgZ(112,"div",33),e.TgZ(113,"mat-checkbox",40),e._uU(114,"Solicitar n\xfamero de placa"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(115,"div",32),e.TgZ(116,"div",33),e.TgZ(117,"mat-checkbox",41),e.NdJ("change",function(l){return o.onCheckEngineHours(l)}),e._uU(118,"Solicitar horas motor"),e.qZA(),e.TgZ(119,"mat-checkbox",42),e._uU(120,"Verificar diferencia razonable"),e.qZA(),e.TgZ(121,"mat-form-field",37),e.TgZ(122,"mat-label"),e._uU(123,"Diferencia m\xe1xima tolerada"),e.qZA(),e.TgZ(124,"input",43),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(125,"mat-form-field",37),e.TgZ(126,"mat-label"),e._uU(127,"N\xfamero de reintentos"),e.qZA(),e.TgZ(128,"input",44),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(129,"mat-checkbox",45),e._uU(130,"Rechazar carga si los intentos fallan"),e.qZA(),e.qZA(),e.TgZ(131,"div",33),e.TgZ(132,"mat-checkbox",46),e.NdJ("change",function(l){return o.onCheckOdometer(l)}),e._uU(133,"Solicitar od\xf3metro"),e.qZA(),e.TgZ(134,"mat-checkbox",47),e._uU(135,"Verificar diferencia razonable"),e.qZA(),e.TgZ(136,"mat-form-field",37),e.TgZ(137,"mat-label"),e._uU(138,"Diferencia m\xe1xima tolerada"),e.qZA(),e.TgZ(139,"input",48),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(140,"mat-form-field",37),e.TgZ(141,"mat-label"),e._uU(142,"N\xfamero de reintentos"),e.qZA(),e.TgZ(143,"input",49),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(144,"mat-checkbox",50),e._uU(145,"Rechazar carga si los intentos fallan"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(146,"div",51),e.TgZ(147,"button",31),e._uU(148,"ANTERIOR"),e.qZA(),e.TgZ(149,"button",52),e.NdJ("click",function(){return o.submit()}),e._uU(150,"GUARDAR DEPARTAMENTO"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(2),e.Q6J("@scaleIn",void 0),e.xp6(2),e.Q6J("@fadeInRight",void 0),e.xp6(3),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("linear",!0),e.xp6(2),e.Q6J("stepControl",o.generalFormGroup),e.xp6(1),e.Q6J("formGroup",o.generalFormGroup),e.xp6(21),e.Q6J("ngForOf",o.groupRules),e.xp6(3),e.Q6J("disabled",o.isdefaultdepartment),e.xp6(1),e.Oqu(o.active_label),e.xp6(3),e.Q6J("ngForOf",o.typesOfList),e.xp6(2),e.Q6J("disabled",o.generalFormGroup.pristine),e.xp6(2),e.Q6J("disabled",o.generalFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",o.informationFormGroup),e.xp6(1),e.Q6J("formGroup",o.informationFormGroup),e.xp6(44),e.Q6J("disabled",o.informationFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",o.validationFormGroup),e.xp6(1),e.Q6J("formGroup",o.validationFormGroup),e.xp6(8),e.Q6J("disabled",!o.pin_block),e.xp6(1),e.Q6J("value",2),e.xp6(2),e.Q6J("value",1),e.xp6(5),e.Q6J("readonly",!o.pin_block),e.xp6(1),e.Q6J("disabled",!o.pin_block),e.xp6(9),e.Q6J("disabled",!o.eh_block),e.xp6(5),e.Q6J("readonly",!o.eh_block),e.xp6(4),e.Q6J("readonly",!o.eh_block),e.xp6(1),e.Q6J("disabled",!o.eh_block),e.xp6(5),e.Q6J("disabled",!o.odo_block),e.xp6(5),e.Q6J("readonly",!o.odo_block),e.xp6(4),e.Q6J("readonly",!o.odo_block),e.xp6(1),e.Q6J("disabled",!o.odo_block),e.xp6(5),e.Q6J("disabled",o.validationFormGroup.invalid))},directives:[Q.i,R.M,v.Hw,p.xw,p.Wh,f.Vq,f.C0,i._Y,i.JL,i.sg,f.VY,p.SQ,g.KE,p.yH,g.hX,i.Fj,z.Nt,i.JJ,i.u,i.Q7,g.bx,oe.gD,_.sg,E.Rr,J.VQ,k.lW,f.Ic,f.fd,ae.oG,J.U0,ne.ey],styles:[".title[_ngcontent-%COMP%]{color:#000}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:265px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:245px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;width:245px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}"],data:{animation:[D.X,w.M,U.K]}}),a})();var re=c(24801),xe=c(33344),W=c(39762),j=c(53580),Y=c(38932),$=c(19165),ie=c(94927),A=c(92181);function Fe(a,n){if(1&a&&(e.TgZ(0,"th",18),e._uU(1),e.qZA()),2&a){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name,"")}}function ve(a,n){if(1&a&&(e.TgZ(0,"td",19),e._uU(1),e.qZA()),2&a){const t=n.$implicit,o=e.oxw(2).$implicit,r=e.oxw();e.xp6(1),e.hij(" ",r.getLabel(o.name,t[o.property])," ")}}function ke(a,n){if(1&a&&(e.ynx(0,15),e.YNc(1,Fe,2,1,"th",16),e.YNc(2,ve,2,1,"td",17),e.BQk()),2&a){const t=e.oxw().$implicit;e.Q6J("matColumnDef",t.property)}}function Ae(a,n){if(1&a&&(e.ynx(0),e.YNc(1,ke,3,1,"ng-container",14),e.BQk()),2&a){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.isModelProperty)}}function ye(a,n){1&a&&e._UZ(0,"th",20)}function qe(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().changeStatusOfDepartment(r)}),e.TgZ(1,"span"),e._uU(2,"Activar"),e.qZA(),e.qZA()}}function Ne(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().changeStatusOfDepartment(r)}),e.TgZ(1,"span"),e._uU(2,"Bloquear"),e.qZA(),e.qZA()}}function we(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().deleteDepartment(r)}),e.TgZ(1,"span"),e._uU(2,"Eliminar"),e.qZA(),e.qZA()}}function De(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"td",21),e.TgZ(1,"button",22),e.NdJ("click",function(r){return r.stopPropagation()}),e.TgZ(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(4,"mat-menu",23,24),e.TgZ(6,"button",25),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().updateDepartment(s)}),e.TgZ(7,"span"),e._uU(8,"Editar"),e.qZA(),e.qZA(),e.YNc(9,qe,3,0,"button",26),e.YNc(10,Ne,3,0,"button",26),e.YNc(11,we,3,0,"button",26),e.qZA(),e.qZA()}if(2&a){const t=e.MAs(5),o=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",t),e.xp6(8),e.Q6J("ngIf",!o.bloqueable&&!o.isdefaultdepartment),e.xp6(1),e.Q6J("ngIf",o.bloqueable&&!o.isdefaultdepartment),e.xp6(1),e.Q6J("ngIf",!o.isdefaultdepartment)}}function Me(a,n){1&a&&e._UZ(0,"tr",27)}function Ie(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",28),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().updateDepartment(s)}),e.qZA()}}const Ue=function(){return["Tables"]};let se=(()=>{class a{constructor(t,o,r,s,l,m,C,Z){this.data=t,this.dialogRef=o,this.dialog=r,this.departmentsService=s,this.groupRulesService=l,this._jobsService=m,this.snackbar=C,this.tokenStorageService=Z,this.subject$=new ee.t(1),this.data$=this.subject$.asObservable(),this.bloqueable=!0,this.isdefaultdepartment=!1,this.groupRules=[],this.columns=[{name:"Id Departamento",property:"id",visible:!1,isModelProperty:!0},{name:"Nombre",property:"NAME",visible:!0,isModelProperty:!0},{name:"C\xf3digo",property:"code",visible:!0,isModelProperty:!0},{name:"Tipo de lista",property:"black_white_type",visible:!0,isModelProperty:!0},{name:"Regla",property:"default_rule",visible:!0,isModelProperty:!0},{name:"Estatus",property:"status",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10}getLabel(t,o){if(null!=t){if("Regla"==t){for(var r=0;r<this.groupRules.length;r++)if(o==this.groupRules[r].id)return this.groupRules[r].NAME;return"Regla no definida"}return"C\xf3digo"==t?(this.isdefaultdepartment=1==o,o):"Estatus"==t?(this.bloqueable=2==o&&!this.isdefaultdepartment,2==o?"Activo":"Desactivado"):"Tipo de lista"==t?1==o?"Positiva":"Negativa":o}}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}getData(){this.departmentsService.getAll(this.data.id).subscribe(t=>{this.departments=t,this.dataSource=new d.by(t),this.dataSource=new d.by(this.departments),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},t=>{console.log(t)})}getGroupRules(){this.groupRulesService.getAll().subscribe(t=>{this.groupRules=t},t=>{console.log(t)})}ngOnInit(){this.dataSource=new d.by,this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(t=>!!t)).subscribe(t=>{this.departments=this.departments,this.dataSource.data=this.departments})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}createDepartment(){this.dialog.open(L,{data:{fleet:this.data}}).afterClosed().subscribe(t=>{t&&(this.subject$.next(this.departments),this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(o=>!!o)).subscribe(o=>{this.departments=o,this.dataSource.data=o}),this._jobsService.push({type:"depts",object:t}).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})}))})}updateDepartment(t){this.dialog.open(L,{data:{department:t,fleet:this.data}}).afterClosed().subscribe(o=>{o&&(this.subject$.next(this.departments),this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(r=>!!r)).subscribe(r=>{this.departments=r,this.dataSource.data=r}),this._jobsService.push({type:"depts",object:o}).subscribe(r=>{this.snackbar.open(r.message,null,{duration:5e3,panelClass:["green-snackbar"]})},r=>{this.snackbar.open(r.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})}))})}changeStatusOfDepartment(t){t.status=2==t.status?1:2,this.updateTheDepartment(t)}deleteDepartment(t){t.status=0,this.updateTheDepartment(t)}updateTheDepartment(t){console.log("updateTheDepartment",t),this.departmentsService.update(t).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.subject$.next(this.departments),this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(r=>!!r)).subscribe(r=>{this.departments=r,this.dataSource.data=r}),this._jobsService.push({type:"depts",object:t}).subscribe(r=>{this.snackbar.open(r.message,null,{duration:5e3,panelClass:["green-snackbar"]})},r=>{this.snackbar.open(r.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}onFilterChange(t){!this.dataSource||(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}ngOnDestroy(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.WI),e.Y36(u.so),e.Y36(u.uw),e.Y36(te._),e.Y36(G.o),e.Y36(re.e),e.Y36(M.ux),e.Y36(xe.i))},a.\u0275cmp=e.Xpm({type:a,selectors:[["departments-table"]],viewQuery:function(t,o){if(1&t&&(e.Gf(I.NW,7),e.Gf(x.YE,7)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},inputs:{columns:"columns"},decls:17,vars:10,consts:[["mode","card",1,"modal-table"],["current","Departamentos",3,"crumbs"],[2,"overflow","scroll"],["name","Departamentos",3,"columns","filterChange"],[1,"actions"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"fury-page-layout",0),e.TgZ(1,"fury-page-layout-header"),e._UZ(2,"fury-breadcrumbs",1),e.qZA(),e.TgZ(3,"fury-page-layout-content",2),e.TgZ(4,"fury-list",3),e.NdJ("filterChange",function(s){return o.onFilterChange(s)}),e.TgZ(5,"div",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return o.createDepartment()}),e.TgZ(7,"mat-icon"),e._uU(8,"add"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"table",6),e.YNc(10,Ae,2,1,"ng-container",7),e.ynx(11,8),e.YNc(12,ye,1,0,"th",9),e.YNc(13,De,12,4,"td",10),e.BQk(),e.YNc(14,Me,1,0,"tr",11),e.YNc(15,Ie,1,0,"tr",12),e.qZA(),e._UZ(16,"mat-paginator",13),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@fadeInRight",void 0)("crumbs",e.DdM(9,Ue)),e.xp6(1),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("columns",o.columns),e.xp6(5),e.Q6J("dataSource",o.dataSource),e.xp6(1),e.Q6J("ngForOf",o.columns),e.xp6(4),e.Q6J("matHeaderRowDef",o.visibleColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.visibleColumns),e.xp6(1),e.Q6J("pageSize",o.pageSize))},directives:[W.N,j.U,Y.n,$.d,ie.n,k.lW,v.Hw,d.BZ,x.YE,_.sg,d.w1,d.fO,d.Dz,d.as,d.nj,I.NW,_.O5,d.ge,x.nU,d.ev,A.p6,A.VK,A.OP,d.XQ,d.Gk],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}.modal-table[_ngcontent-%COMP%]{width:900px;height:100%}"],data:{animation:[w.M,D.X]}}),a})();var Ge=c(28258),b=c(90149),y=c(54822),Je=c(58527),V=c(97199),Oe=c(4834);function Pe(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mat-tree-node",8),e.TgZ(1,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().createChild(s)}),e.TgZ(2,"mat-icon"),e._uU(3,"add"),e.qZA(),e.qZA(),e.TgZ(4,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().editNode(s)}),e.TgZ(5,"mat-icon"),e._uU(6,"edit"),e.qZA(),e.qZA(),e.TgZ(7,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().deleteNode(s)}),e.TgZ(8,"mat-icon"),e._uU(9,"delete "),e.qZA(),e.qZA(),e._uU(10),e.qZA()}if(2&a){const t=n.$implicit;e.Tol(t.is_cc?"is_cc":"is_not_cc"),e.xp6(10),e.hij(" ",t.name," ")}}function Se(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mat-nested-tree-node"),e.TgZ(1,"div",10),e.TgZ(2,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().createChild(s)}),e.TgZ(3,"mat-icon"),e._uU(4,"add"),e.qZA(),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().editNode(s)}),e.TgZ(6,"mat-icon"),e._uU(7,"edit"),e.qZA(),e.qZA(),e.TgZ(8,"button",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().deleteNode(s)}),e.TgZ(9,"mat-icon"),e._uU(10,"delete "),e.qZA(),e.qZA(),e.TgZ(11,"button",11),e.TgZ(12,"mat-icon",12),e._uU(13),e.qZA(),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"div",13),e.GkF(16,14),e.qZA(),e.qZA()}if(2&a){const t=n.$implicit,o=e.oxw();e.xp6(1),e.Tol(t.is_cc?"is_cc":"is_not_cc"),e.xp6(10),e.uIk("aria-label","Toggle "+t.name),e.xp6(2),e.hij(" ",o.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.ekj("example-tree-invisible",!o.treeControl.isExpanded(t))}}const Qe=function(){return["Arboles"]};let le=(()=>{class a{constructor(t,o,r,s){this.data=t,this.dialogAddItem=o,this.snackbar=r,this._areasService=s,this.treeControl=new Ge.VY(l=>l.children),this.dataSource=new b.WX,this.node_class="is_not_cc",this.filterFormGroup=new i.cw({fleet:new i.NI("",[i.kI.required])}),this.hasChild=(l,m)=>!!m.children&&m.children.length>0}ngOnInit(){return(0,F.mG)(this,void 0,void 0,function*(){this.dataSource.data=yield this.getAreasTree()})}getAreasTree(){return(0,F.mG)(this,void 0,void 0,function*(){return yield this._areasService.getAll({fleets:this.data.id.toString()}).toPromise()})}createChild(t){this.dialogAddItem.open(H,{data:{node:t,action:"create"}}).afterClosed().subscribe(o=>{if(o){var r=new y.t;r.parent_id=o.parent.id,r.level=+o.parent.level+1,r.status=2,r.name=o.newArea,r.fleet_id=o.parent.fleet_id,r.is_cc=o.is_cc,this._areasService.createArea(r).subscribe(s=>{this.ngOnInit(),this.snackbar.open(s.message,null,{duration:5e3,panelClass:["green-snackbar"]})},s=>{this.snackbar.open(s.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}})}editNode(t){this.dialogAddItem.open(H,{data:{node:t,action:"update"}}).afterClosed().subscribe(o=>{if(o){var r=new y.t(t);r.name=o.newArea,r.is_cc=o.is_cc,this._areasService.updateArea(r).subscribe(s=>{this.ngOnInit(),this.snackbar.open(s.message,null,{duration:5e3,panelClass:["green-snackbar"]})},s=>{this.snackbar.open(s.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}})}deleteNode(t){confirm("\xbfEst\xe1 seguro de borrar el \xe1rea "+t.name+" y todos sus hijos?")?this._areasService.deleteArea(t).subscribe(o=>{this.ngOnInit(),this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})}):alert("\xa1Pfff menos mal!")}createRootNode(t){this.dialogAddItem.open(H,{data:{node:t,action:"create"}}).afterClosed().subscribe(o=>{if(o){var r=new y.t;r.parent_id=o.parent.id,r.level=+o.parent.level+1,r.status=2,r.name=o.newArea,r.fleet_id=this.data.id,r.is_cc=o.is_cc,this._areasService.createArea(r).subscribe(s=>{this.ngOnInit(),this.snackbar.open(s.message,null,{duration:5e3,panelClass:["green-snackbar"]})},s=>{this.snackbar.open(s.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.WI),e.Y36(u.uw),e.Y36(M.ux),e.Y36(Je.E))},a.\u0275cmp=e.Xpm({type:a,selectors:[["areas-tree"]],decls:17,vars:5,consts:[["mode","card"],["current","Areas",3,"crumbs"],[1,"card"],["mat-icon-button","","type","button","mat-mini-fab","","color","primary",2,"margin-top","10px",3,"click"],[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",3,"class",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[2,"margin-top","10px","color","brown","font-weight","bold"],["matTreeNodeToggle",""],["mat-icon-button","","type","button",3,"click"],[1,"mat-tree-node"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["role","group"],["matTreeNodeOutlet",""]],template:function(t,o){1&t&&(e.TgZ(0,"fury-page-layout",0),e.TgZ(1,"fury-page-layout-header"),e._UZ(2,"fury-breadcrumbs",1),e.qZA(),e.TgZ(3,"fury-page-layout-content"),e.TgZ(4,"div",2),e.TgZ(5,"fury-card-header"),e.TgZ(6,"fury-card-header-heading"),e._uU(7," \xc1rbol de \xe1reas "),e.qZA(),e.TgZ(8,"fury-card-header-actions"),e.TgZ(9,"button",3),e.NdJ("click",function(){return o.createRootNode(null)}),e.TgZ(10,"mat-icon"),e._uU(11,"add"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"mat-tree",4),e.YNc(13,Pe,11,4,"mat-tree-node",5),e.YNc(14,Se,17,8,"mat-nested-tree-node",6),e.qZA(),e.TgZ(15,"div",7),e._uU(16,"** Es centro de cobro"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("crumbs",e.DdM(4,Qe)),e.xp6(10),e.Q6J("dataSource",o.dataSource)("treeControl",o.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",o.hasChild))},directives:[W.N,j.U,Y.n,$.d,V.$X,V.eP,V.OA,k.lW,v.Hw,b.gi,b.fQ,b.uo,b.eu,b.GZ,b.Ar],styles:[".is_cc[_ngcontent-%COMP%]{color:brown}.is_not_cc[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{color:#000}.fury-card-header-heading[_ngcontent-%COMP%]{font-weight:700!important}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.example-tree[_ngcontent-%COMP%]   .mat-nested-tree-node[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%]{padding-left:40px}.mat-tree[_ngcontent-%COMP%]{margin-top:10px}.example-tree[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%] > .mat-tree-node[_ngcontent-%COMP%]{padding-left:40px}.card[_ngcontent-%COMP%]{margin:24px;border-radius:8px;padding:24px;width:700px!important;max-height:400px;overflow:scroll;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .information-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:100%}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:410px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:245px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;width:245px}.card[_ngcontent-%COMP%]   .indented-right[_ngcontent-%COMP%]{margin-left:40px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.modal-table[_ngcontent-%COMP%]{width:900px}"]}),a})(),H=(()=>{class a{constructor(t,o){this.data=t,this.dialogRef=o,this.header="Agregar \xe1rea",this.label="Nombre del \xe1rea",this.areaFormGroup=new i.cw({newItem:new i.NI("",[i.kI.required,i.kI.pattern("^[a-zA-Z0-9].{1,}$")]),isCc:new i.NI(!0,[i.kI.required])}),o.disableClose=!0}ngOnInit(){null!=this.data.node?"create"==this.data.action?(this.parent=new y.t(this.data.node),this.header="Agregar \xe1rea"):(this.parent=new y.t,this.areaFormGroup.controls.newItem.setValue(this.data.node.name),this.areaFormGroup.controls.isCc.setValue(0!=this.data.node.is_cc),this.header="Editar \xe1rea"):(this.parent=new y.t,this.parent.level=0,this.parent.id=0)}onAddClick(){this.dialogRef.close({parent:this.parent,newArea:this.areaFormGroup.controls.newItem.value,is_cc:this.areaFormGroup.controls.isCc.value?1:0})}onCancelClick(){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.WI),e.Y36(u.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["dialog-add-area"]],decls:24,vars:7,consts:[[1,"title"],["fxLayout","column","fxLayoutAlign","start center"],[1,"card"],[3,"formGroup"],["fxLayout","column","fxLayoutGap","8px",1,"content",2,"margin-top","20px"],["fxFlex","auto","appearance","outline"],["formControlName","newItem","matInput","","required",""],[1,"radio"],["formControlName","isCc"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","24px",2,"margin-top","20px"],["color","primary","mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"fury-page"),e.TgZ(1,"fury-title",0),e.TgZ(2,"mat-icon"),e._uU(3,"branding_watermark"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",2),e.TgZ(8,"form",3),e.TgZ(9,"div",4),e.TgZ(10,"mat-form-field",5),e.TgZ(11,"mat-label"),e._uU(12),e.qZA(),e._UZ(13,"input",6),e.qZA(),e.TgZ(14,"div",7),e.TgZ(15,"mat-slide-toggle",8),e._uU(16,"Es centro de cobro"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",4),e._UZ(18,"mat-divider"),e.qZA(),e.TgZ(19,"div",9),e.TgZ(20,"button",10),e.NdJ("click",function(){return o.onCancelClick()}),e._uU(21,"CANCELAR"),e.qZA(),e.TgZ(22,"button",11),e.NdJ("click",function(){return o.onAddClick()}),e._uU(23,"GUARDAR"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@scaleIn",void 0),e.xp6(2),e.Q6J("@fadeInRight",void 0),e.xp6(1),e.Oqu(o.header),e.xp6(2),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("formGroup",o.areaFormGroup),e.xp6(4),e.Oqu(o.label),e.xp6(10),e.Q6J("disabled",o.areaFormGroup.invalid))},directives:[Q.i,R.M,v.Hw,p.xw,p.Wh,i._Y,i.JL,i.sg,p.SQ,g.KE,p.yH,g.hX,i.Fj,z.Nt,i.JJ,i.u,i.Q7,E.Rr,Oe.d,k.lW],styles:[".radio[_ngcontent-%COMP%]{padding-top:14px;padding-bottom:14px;padding-left:12px;display:inline-grid;width:100%;height:52px;border-style:solid;border-width:1px;border-radius:5px;border-color:#e0e0e0;min-width:50%}"],data:{animation:[D.X,w.M,U.K]}}),a})();var ce=c(60198),de=c(82593),B=c(50974);function Re(a,n){1&a&&e._uU(0,"Crear flota")}function ze(a,n){if(1&a&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.NAME)}}function Ee(a,n){1&a&&e._uU(0,"Informaci\xf3n")}function Le(a,n){1&a&&e._uU(0,"Par\xe1metros")}function We(a,n){1&a&&e._uU(0,"Validaci\xf3n")}let X=(()=>{class a{constructor(t,o,r,s,l,m,C){this.data=t,this.dialogRef=o,this.dialog=r,this.groupRulesService=s,this._filesUploaderService=l,this.snackbar=m,this.fleetsService=C,this.active_label="Activada",this.theFleet=new he.i,this.groupRules=[],this.pin_block=!1,this.odo_block=!1,this.eh_block=!1,this.plate_block=!1,this.isdefaultfleet=!1,this.selectedFile=null,this.selectedFilename="Seleccione el logotipo de la unidad o flota",this.fleetLogoFile="",this.requiredFileType="image/png",this.homaacsaTheme={container:{bodyBackgroundColor:"#ffffff",buttonColor:"#0f192a",primaryFontFamily:"#ffffff"},dial:{dialBackgroundColor:"#0f192a",dialInactiveColor:"#8c8c8c",dialActiveColor:"#ffffff",dialEditableActiveColor:"#ffffff",dialEditableBackgroundColor:"#ffffff"},clockFace:{clockFaceBackgroundColor:"#0f192a",clockHandColor:"#165ffe",clockFaceTimeActiveColor:"#ffffff",clockFaceTimeInactiveColor:"#8c8c8c",clockFaceInnerTimeInactiveColor:"#8c8c8c",clockFaceTimeDisabledColor:"#d9d9d9"}},this.generalFormGroup=new i.cw({id:new i.NI,NAME:new i.NI("",[i.kI.required,i.kI.minLength(2)]),code:new i.NI("",[i.kI.required,i.kI.pattern("^[1-9][0-9]{0,8}?$")]),default_rule:new i.NI(2e8,[i.kI.required]),status:new i.NI(!0,[i.kI.required])}),this.informationFormGroup=new i.cw({address:new i.NI,address2:new i.NI,city:new i.NI,state:new i.NI,zip:new i.NI,contact:new i.NI,phone:new i.NI(""),fax:new i.NI(""),email:new i.NI("",[i.kI.email]),price_list_id:new i.NI(0)}),this.accountFormGroup=new i.cw({acctyp:new i.NI(!1)}),this.parametersFormGroup=new i.cw({ieps_schedule_time:new i.NI("00:00",[i.kI.required]),logo_filename:new i.NI}),this.validationFormGroup=new i.cw({use_pin_code:new i.NI(!1),auth_pin_from:new i.NI(2),nr_pin_retries:new i.NI,block_if_pin_retries_fail:new i.NI(!1),opos_prompt_for_odometer:new i.NI(!1),do_odo_reasonability_check:new i.NI(!1),max_odo_delta_allowed:new i.NI,nr_odo_retries:new i.NI,reject_if_odm_check_fails:new i.NI(!1),opos_prompt_for_engine_hours:new i.NI(!1),do_eh_reasonability_check:new i.NI(!1),max_eh_delta_allowed:new i.NI,nr_eh_retries:new i.NI,reject_if_eh_check_fails:new i.NI(!1),opos_prompt_for_plate:new i.NI(!1)})}ngOnInit(){return(0,F.mG)(this,void 0,void 0,function*(){this.groupRules=yield this.getGroupRules(),null!=this.data?(this.theFleet=this.data,this.generalFormGroup.setValue({id:this.theFleet.id,NAME:this.theFleet.NAME,code:this.theFleet.code,default_rule:this.theFleet.default_rule,status:2==this.theFleet.status}),this.informationFormGroup.setValue({address:this.theFleet.address,address2:this.theFleet.address2,city:this.theFleet.city,state:this.theFleet.state,zip:this.theFleet.zip,contact:this.theFleet.contact,phone:this.theFleet.phone,fax:this.theFleet.fax,email:this.theFleet.email,price_list_id:this.theFleet.price_list_id}),this.parametersFormGroup.setValue({ieps_schedule_time:this.theFleet.ieps_schedule_time,logo_filename:this.theFleet.logo_filename}),this.fleetLogoFile=null==this.theFleet.logo_filename?"":this.theFleet.logo_filename,this.selectedFilename=null==this.theFleet.logo_filename?"Seleccione el logotipo de la unidad o flota":this.theFleet.logo_filename,this.accountFormGroup.setValue({acctyp:0!=this.theFleet.acctyp}),this.validationFormGroup.setValue({use_pin_code:0!=this.theFleet.use_pin_code,auth_pin_from:this.theFleet.auth_pin_from,nr_pin_retries:0==this.theFleet.nr_pin_retries?"":this.theFleet.nr_pin_retries,block_if_pin_retries_fail:0!=this.theFleet.block_if_pin_retries_fail,opos_prompt_for_odometer:0!=this.theFleet.opos_prompt_for_odometer,do_odo_reasonability_check:0!=this.theFleet.do_odo_reasonability_check,max_odo_delta_allowed:0==this.theFleet.max_odo_delta_allowed?"":this.theFleet.max_odo_delta_allowed,nr_odo_retries:0==this.theFleet.nr_odo_retries?"":this.theFleet.nr_odo_retries,reject_if_odm_check_fails:0!=this.theFleet.reject_if_odm_check_fails,opos_prompt_for_engine_hours:0!=this.theFleet.opos_prompt_for_engine_hours,do_eh_reasonability_check:0!=this.theFleet.do_eh_reasonability_check,max_eh_delta_allowed:0==this.theFleet.max_eh_delta_allowed?"":this.theFleet.max_eh_delta_allowed,nr_eh_retries:0==this.theFleet.nr_eh_retries?"":this.theFleet.nr_eh_retries,reject_if_eh_check_fails:0!=this.theFleet.reject_if_eh_check_fails,opos_prompt_for_plate:0!=this.theFleet.opos_prompt_for_plate}),this.pin_block=1==this.theFleet.use_pin_code,this.odo_block=1==this.theFleet.opos_prompt_for_odometer,this.eh_block=1==this.theFleet.opos_prompt_for_engine_hours,this.plate_block=1==this.theFleet.opos_prompt_for_plate,this.isdefaultfleet=99999==this.theFleet.code):(this.generalFormGroup.controls.default_rule.setValue(this.groupRules[0].id),this.fleetLogoFile="")})}getGroupRules(){return(0,F.mG)(this,void 0,void 0,function*(){return yield this.groupRulesService.getAll().toPromise()})}numericOnly(t){let o=t.target.value+t.key;return!!new RegExp(/^([1-9][0-9]{0,7}||[0])$/).test(o)}onCheckPin(t){this.pin_block=t.checked,t.checked||(this.validationFormGroup.controls.auth_pin_from.setValue(2),this.validationFormGroup.controls.nr_pin_retries.setValue(""),this.validationFormGroup.controls.block_if_pin_retries_fail.setValue(!1))}onCheckOdometer(t){this.odo_block=t.checked,t.checked||(this.validationFormGroup.controls.do_odo_reasonability_check.setValue(!1),this.validationFormGroup.controls.max_odo_delta_allowed.setValue(""),this.validationFormGroup.controls.nr_odo_retries.setValue(""),this.validationFormGroup.controls.reject_if_odm_check_fails.setValue(!1))}onCheckEngineHours(t){this.eh_block=t.checked,t.checked||(this.validationFormGroup.controls.do_eh_reasonability_check.setValue(!1),this.validationFormGroup.controls.max_eh_delta_allowed.setValue(""),this.validationFormGroup.controls.nr_eh_retries.setValue(""),this.validationFormGroup.controls.reject_if_eh_check_fails.setValue(!1))}onCheckPlateNumber(t){this.plate_block=t.checked}changePinOrig(t){this.theFleet.auth_pin_from=t.value}setActiveFleet(t){this.active_label=t.checked?"Activada":"Bloqueada",this.theFleet.status=t.checked?2:1}setDepartments(){this.dialog.open(se,{data:this.theFleet}).afterClosed().subscribe(t=>{})}setAreasTree(){this.dialog.open(le,{data:this.theFleet}).afterClosed().subscribe(t=>{})}submit(){var t;this.theFleet.NAME=this.generalFormGroup.controls.NAME.value,this.theFleet.code=this.generalFormGroup.controls.code.value,this.theFleet.default_rule=this.generalFormGroup.controls.default_rule.value,this.theFleet.status=this.generalFormGroup.controls.status.value?2:1,this.theFleet.address=this.informationFormGroup.controls.address.value,this.theFleet.address2=this.informationFormGroup.controls.address2.value,this.theFleet.city=this.informationFormGroup.controls.city.value,this.theFleet.state=this.informationFormGroup.controls.state.value,this.theFleet.zip=this.informationFormGroup.controls.zip.value,this.theFleet.contact=this.informationFormGroup.controls.contact.value,this.theFleet.phone=this.informationFormGroup.controls.phone.value,this.theFleet.fax=this.informationFormGroup.controls.fax.value,this.theFleet.email=this.informationFormGroup.controls.email.value,this.theFleet.price_list_id=this.informationFormGroup.controls.price_list_id.value,this.theFleet.ieps_schedule_time=this.parametersFormGroup.controls.ieps_schedule_time.value,this.theFleet.logo_filename=this.parametersFormGroup.controls.logo_filename.value,this.fleetLogoFile=this.theFleet.logo_filename,this.selectedFilename=this.theFleet.logo_filename,this.theFleet.acctyp=this.accountFormGroup.controls.acctyp.value?1:0,this.theFleet.use_pin_code=this.validationFormGroup.controls.use_pin_code.value?1:0,this.theFleet.auth_pin_from=this.validationFormGroup.controls.auth_pin_from.value,this.theFleet.nr_pin_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_pin_retries.value)?0:t,this.theFleet.block_if_pin_retries_fail=this.validationFormGroup.controls.block_if_pin_retries_fail.value?1:0,this.theFleet.opos_prompt_for_odometer=this.validationFormGroup.controls.opos_prompt_for_odometer.value?1:0,this.theFleet.do_odo_reasonability_check=this.validationFormGroup.controls.do_odo_reasonability_check.value?1:0,this.theFleet.max_odo_delta_allowed=[null,""].includes(t=this.validationFormGroup.controls.max_odo_delta_allowed.value)?0:t,this.theFleet.nr_odo_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_odo_retries.value)?0:t,this.theFleet.reject_if_odm_check_fails=this.validationFormGroup.controls.reject_if_odm_check_fails.value?1:0,this.theFleet.opos_prompt_for_engine_hours=this.validationFormGroup.controls.opos_prompt_for_engine_hours.value?1:0,this.theFleet.do_eh_reasonability_check=this.validationFormGroup.controls.do_eh_reasonability_check.value?1:0,this.theFleet.max_eh_delta_allowed=[null,""].includes(t=this.validationFormGroup.controls.max_eh_delta_allowed.value)?0:t,this.theFleet.nr_eh_retries=[null,""].includes(t=this.validationFormGroup.controls.nr_eh_retries.value)?0:t,this.theFleet.reject_if_eh_check_fails=this.validationFormGroup.controls.reject_if_eh_check_fails.value?1:0,this.theFleet.opos_prompt_for_plate=this.validationFormGroup.controls.opos_prompt_for_plate.value?1:0,this.theFleet.id>0?this.updateFleet():this.createFleet()}createFleet(){this.fleetsService.create(this.theFleet).subscribe(t=>{this.theFleet.id=t.fleet_id,this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close(this.theFleet)},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}updateFleet(){this.fleetsService.update(this.theFleet).subscribe(t=>{this.snackbar.open(t.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.dialogRef.close(this.theFleet)},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}onFileSelected(t){this.selectedFile=t.target.files[0],this.selectedFilename=this.selectedFile.name}uploadFile(){this._filesUploaderService.uploadFile(this.selectedFile).subscribe(t=>{t.type===S.dt.UploadProgress?console.log("Upload progres: "+100*Math.round(t.loaded/t.total)+"%"):t.type===S.dt.Response&&(this.parametersFormGroup.controls.logo_filename.setValue(t.body.filename),this.fleetLogoFile=t.body.filename,this.selectedFilename=t.body.filename,this.snackbar.open(t.body.message,null,{duration:5e3,panelClass:["green-snackbar"]}))},t=>{this.snackbar.open(t.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}removeFile(){this._filesUploaderService.removeFile({file:this.fleetLogoFile,type:"fleet"}).subscribe(o=>{this.fleetLogoFile="",this.selectedFilename="",this.selectedFile=null,this.parametersFormGroup.controls.logo_filename.setValue(""),this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.WI),e.Y36(u.so),e.Y36(u.uw),e.Y36(G.o),e.Y36(ce.a),e.Y36(M.ux),e.Y36(de.V))},a.\u0275cmp=e.Xpm({type:a,selectors:[["fleets-wizard"]],decls:197,vars:43,consts:[[1,"title"],["fxLayout","column","fxLayoutAlign","start center"],[1,"card"],[3,"linear"],["stepper","matVerticalStepper"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxFlex","auto","appearance","outline"],["formControlName","NAME","matInput","","required",""],["formControlName","code","matInput","","required","",3,"keypress"],["formControlName","default_rule"],[3,"value",4,"ngFor","ngForOf"],["formControlName","status",3,"disabled","change"],["fxLayout","column","fxLayoutAlign","center","fxLayoutGap","12px",1,"result"],["color","primary","mat-button","","mat-raised-button","","type","button",2,"width","150px",3,"disabled","click"],["svgIcon","tree"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-button","","type","button",3,"disabled","click"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled"],[1,"subheading"],["formControlName","address","matInput",""],["formControlName","address2","matInput",""],["formControlName","city","matInput",""],["fxLayout","row","fxLayoutGap","8px",1,"content"],["formControlName","state","matInput",""],["formControlName","zip","matInput",""],["formControlName","contact","matInput",""],["formControlName","phone","matInput",""],["formControlName","fax","matInput",""],["formControlName","email","matInput",""],["color","primary","mat-button","","matStepperPrevious","","type","button"],["appearance","outline"],["formControlName","ieps_schedule_time","matInput","","readonly","",3,"ngxTimepicker","format"],[3,"theme"],["pickerIeps",""],[1,"div-file-input"],["type","file",1,"hidden",3,"accept","change"],["fileInput",""],["requiredFileType","image/png","type","button","mat-mini-fab","","color","primary",1,"create",2,"margin-top","-4px",3,"disabled","click"],[1,"selected-label"],["type","button","color","primary","mat-button","","mat-raised-button","",2,"margin-left","8px",3,"disabled","click"],["fxLayout","row","fxLayoutGap","5px",1,"content"],["fxLayout","column","fxLayoutGap","5px",1,"validation-block","content"],["formControlName","use_pin_code",1,"checkbox",3,"change"],["color","accent","fxLayout","column","fxLayoutGap","10px","required","","formControlName","auth_pin_from",1,"radio",3,"disabled","change"],[1,"radio",3,"value"],["fxFlex","auto","appearance","outline",1,"input-text"],["formControlName","nr_pin_retries","matInput","",3,"readonly","keypress"],["formControlName","block_if_pin_retries_fail",1,"checkbox",3,"disabled"],["formControlName","opos_prompt_for_plate",1,"checkbox"],["formControlName","opos_prompt_for_engine_hours",1,"checkbox",3,"change"],["formControlName","do_eh_reasonability_check",1,"checkbox",3,"disabled"],["formControlName","max_eh_delta_allowed","matInput","",3,"readonly","keypress"],["formControlName","nr_eh_retries","matInput","",3,"readonly","keypress"],["formControlName","reject_if_eh_check_fails",1,"checkbox",3,"disabled"],["formControlName","opos_prompt_for_odometer",1,"checkbox",3,"change"],["formControlName","do_odo_reasonability_check",1,"checkbox",3,"disabled"],["formControlName","max_odo_delta_allowed","matInput","",3,"readonly","keypress"],["formControlName","nr_odo_retries","matInput","",3,"readonly","keypress"],["formControlName","reject_if_odm_check_fails",1,"checkbox",3,"disabled"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","5px",1,"actions"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled","click"],[3,"value"]],template:function(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"fury-page"),e.TgZ(1,"fury-title",0),e.TgZ(2,"mat-icon"),e._uU(3,"group_work"),e.qZA(),e.TgZ(4,"span"),e._uU(5,"Asistente para flotas"),e.qZA(),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",2),e.TgZ(8,"mat-horizontal-stepper",3,4),e.TgZ(10,"mat-step",5),e.TgZ(11,"form",6),e.YNc(12,Re,1,0,"ng-template",7),e.TgZ(13,"div",8),e.TgZ(14,"mat-form-field",9),e.TgZ(15,"mat-label"),e._uU(16,"Nombre de la flota"),e.qZA(),e._UZ(17,"input",10),e.TgZ(18,"mat-hint"),e._uU(19,"Nombre identificador de la flota"),e.qZA(),e.qZA(),e.TgZ(20,"mat-form-field",9),e.TgZ(21,"mat-label"),e._uU(22,"C\xf3digo"),e.qZA(),e.TgZ(23,"input",11),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.TgZ(24,"mat-hint"),e._uU(25,"C\xf3digo num\xe9rico \xfanico de la flota"),e.qZA(),e.qZA(),e.TgZ(26,"mat-form-field",9),e.TgZ(27,"mat-label"),e._uU(28,"Regla de carga predeterminada"),e.qZA(),e.TgZ(29,"mat-select",12),e.YNc(30,ze,2,2,"mat-option",13),e.qZA(),e.TgZ(31,"mat-hint"),e._uU(32,"Regla predeterminada que ser\xe1 utilizada para crear nuevos departamentos en esta flota."),e.qZA(),e.qZA(),e.TgZ(33,"mat-slide-toggle",14),e.NdJ("change",function(l){return o.setActiveFleet(l)}),e._uU(34),e.qZA(),e.TgZ(35,"div",15),e.TgZ(36,"mat-label"),e._uU(37,"Una lista positiva de departamentos ser\xe1 creada para cada flota."),e.qZA(),e.TgZ(38,"button",16),e.NdJ("click",function(){return o.setDepartments()}),e.TgZ(39,"mat-icon"),e._uU(40,"account_balance"),e.qZA(),e._uU(41,"\xa0Departamentos"),e.qZA(),e.TgZ(42,"mat-hint"),e._uU(43,"Primero guarde la flota y despu\xe9s utilice el bot\xf3n Departamentos para incluir listas positivas/negativas."),e.qZA(),e.qZA(),e.TgZ(44,"div",15),e.TgZ(45,"mat-label"),e._uU(46,"Un \xe1rbol de \xe1reas puede ser creado para cada flota."),e.qZA(),e.TgZ(47,"button",16),e.NdJ("click",function(){return o.setAreasTree()}),e._UZ(48,"mat-icon",17),e._uU(49,"\xa0\xc1reas"),e.qZA(),e.TgZ(50,"mat-hint"),e._uU(51,"Primero guarde la flota y despu\xe9s utilice el bot\xf3n \xc1reas para crear el \xe1rbol."),e.qZA(),e.qZA(),e.qZA(),e.TgZ(52,"div",18),e.TgZ(53,"button",19),e.NdJ("click",function(){return e.CHM(r),e.MAs(9).reset()}),e._uU(54,"LIMPIAR"),e.qZA(),e.TgZ(55,"button",20),e._uU(56,"SIGUIENTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"mat-step",5),e.TgZ(58,"form",6),e.YNc(59,Ee,1,0,"ng-template",7),e.TgZ(60,"div",21),e._uU(61,"Complete los datos de contacto"),e.qZA(),e.TgZ(62,"div",8),e.TgZ(63,"mat-form-field",9),e.TgZ(64,"mat-label"),e._uU(65,"Direcci\xf3n"),e.qZA(),e._UZ(66,"input",22),e.qZA(),e.TgZ(67,"mat-form-field",9),e.TgZ(68,"mat-label"),e._uU(69,"Direcci\xf3n 2"),e.qZA(),e._UZ(70,"input",23),e.qZA(),e.TgZ(71,"mat-form-field",9),e.TgZ(72,"mat-label"),e._uU(73,"Ciudad"),e.qZA(),e._UZ(74,"input",24),e.qZA(),e.qZA(),e.TgZ(75,"div",25),e.TgZ(76,"mat-form-field",9),e.TgZ(77,"mat-label"),e._uU(78,"Estado"),e.qZA(),e._UZ(79,"input",26),e.qZA(),e.TgZ(80,"mat-form-field",9),e.TgZ(81,"mat-label"),e._uU(82,"C\xf3digo postal"),e.qZA(),e._UZ(83,"input",27),e.qZA(),e.qZA(),e.TgZ(84,"div",25),e.TgZ(85,"mat-form-field",9),e.TgZ(86,"mat-label"),e._uU(87,"Nombre del contacto"),e.qZA(),e._UZ(88,"input",28),e.qZA(),e.TgZ(89,"mat-form-field",9),e.TgZ(90,"mat-label"),e._uU(91,"Tel\xe9fono"),e.qZA(),e._UZ(92,"input",29),e.qZA(),e.qZA(),e.TgZ(93,"div",25),e.TgZ(94,"mat-form-field",9),e.TgZ(95,"mat-label"),e._uU(96,"Fax"),e.qZA(),e._UZ(97,"input",30),e.qZA(),e.TgZ(98,"mat-form-field",9),e.TgZ(99,"mat-label"),e._uU(100,"Email"),e.qZA(),e._UZ(101,"input",31),e.qZA(),e.qZA(),e.TgZ(102,"div",8),e.TgZ(103,"div",18),e.TgZ(104,"button",32),e._uU(105,"ANTERIOR"),e.qZA(),e.TgZ(106,"button",20),e._uU(107,"SIGUIENTE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(108,"mat-step",5),e.TgZ(109,"form",6),e.YNc(110,Le,1,0,"ng-template",7),e.TgZ(111,"div",21),e._uU(112,"Configuraci\xf3n para reportes y comportamiento"),e.qZA(),e.TgZ(113,"div",8),e.TgZ(114,"mat-form-field",33),e._UZ(115,"input",34),e._UZ(116,"ngx-material-timepicker",35,36),e.TgZ(118,"mat-label"),e._uU(119,"Horario de corte para reporte IEPS"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(120,"div",37),e.TgZ(121,"input",38,39),e.NdJ("change",function(l){return o.onFileSelected(l)}),e.qZA(),e.TgZ(123,"button",40),e.NdJ("click",function(){return e.CHM(r),e.MAs(122).click()}),e.TgZ(124,"mat-icon"),e._uU(125,"attach_file"),e.qZA(),e.qZA(),e.TgZ(126,"mat-label",41),e._uU(127),e.qZA(),e.TgZ(128,"button",42),e.NdJ("click",function(){return o.uploadFile()}),e._uU(129,"Subir archivo"),e.qZA(),e.TgZ(130,"button",42),e.NdJ("click",function(){return o.removeFile()}),e._uU(131,"Eliminar archivo"),e.qZA(),e.qZA(),e.TgZ(132,"div",8),e.TgZ(133,"div",18),e.TgZ(134,"button",32),e._uU(135,"ANTERIOR"),e.qZA(),e.TgZ(136,"button",20),e._uU(137,"SIGUIENTE "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(138,"mat-step",5),e.TgZ(139,"form",6),e.YNc(140,We,1,0,"ng-template",7),e.TgZ(141,"div",21),e._uU(142,"Activar campos de validaci\xf3n para solicitar al usuario desde POS"),e.qZA(),e.TgZ(143,"div",43),e.TgZ(144,"div",44),e.TgZ(145,"mat-checkbox",45),e.NdJ("change",function(l){return o.onCheckPin(l)}),e._uU(146,"Solicitar c\xf3digo PIN"),e.qZA(),e.TgZ(147,"mat-radio-group",46),e.NdJ("change",function(l){return o.changePinOrig(l)}),e.TgZ(148,"mat-radio-button",47),e._uU(149,"Usar PIN del dispositivo autorizador"),e.qZA(),e.TgZ(150,"mat-radio-button",47),e._uU(151,"Usar PIN de base de datos"),e.qZA(),e.qZA(),e.TgZ(152,"mat-form-field",48),e.TgZ(153,"mat-label"),e._uU(154,"N\xfamero de reintentos"),e.qZA(),e.TgZ(155,"input",49),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(156,"mat-checkbox",50),e._uU(157,"Bloquear si los intentos fallan"),e.qZA(),e.qZA(),e.TgZ(158,"div",44),e.TgZ(159,"mat-checkbox",51),e._uU(160,"Solicitar n\xfamero de placa"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(161,"div",43),e.TgZ(162,"div",44),e.TgZ(163,"mat-checkbox",52),e.NdJ("change",function(l){return o.onCheckEngineHours(l)}),e._uU(164,"Solicitar horas motor"),e.qZA(),e.TgZ(165,"mat-checkbox",53),e._uU(166,"Verificar diferencia razonable"),e.qZA(),e.TgZ(167,"mat-form-field",48),e.TgZ(168,"mat-label"),e._uU(169,"Diferencia m\xe1xima tolerada"),e.qZA(),e.TgZ(170,"input",54),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(171,"mat-form-field",48),e.TgZ(172,"mat-label"),e._uU(173,"N\xfamero de reintentos"),e.qZA(),e.TgZ(174,"input",55),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(175,"mat-checkbox",56),e._uU(176,"Rechazar carga si los intentos fallan"),e.qZA(),e.qZA(),e.TgZ(177,"div",44),e.TgZ(178,"mat-checkbox",57),e.NdJ("change",function(l){return o.onCheckOdometer(l)}),e._uU(179,"Solicitar od\xf3metro"),e.qZA(),e.TgZ(180,"mat-checkbox",58),e._uU(181,"Verificar diferencia razonable"),e.qZA(),e.TgZ(182,"mat-form-field",48),e.TgZ(183,"mat-label"),e._uU(184,"Diferencia m\xe1xima tolerada"),e.qZA(),e.TgZ(185,"input",59),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(186,"mat-form-field",48),e.TgZ(187,"mat-label"),e._uU(188,"N\xfamero de reintentos"),e.qZA(),e.TgZ(189,"input",60),e.NdJ("keypress",function(l){return o.numericOnly(l)}),e.qZA(),e.qZA(),e.TgZ(190,"mat-checkbox",61),e._uU(191,"Rechazar carga si los intentos fallan"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(192,"div",62),e.TgZ(193,"button",32),e._uU(194,"ANTERIOR"),e.qZA(),e.TgZ(195,"button",63),e.NdJ("click",function(){return o.submit()}),e._uU(196,"GUARDAR FLOTA"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const r=e.MAs(117);e.xp6(2),e.Q6J("@scaleIn",void 0),e.xp6(2),e.Q6J("@fadeInRight",void 0),e.xp6(3),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("linear",!0),e.xp6(2),e.Q6J("stepControl",o.generalFormGroup),e.xp6(1),e.Q6J("formGroup",o.generalFormGroup),e.xp6(19),e.Q6J("ngForOf",o.groupRules),e.xp6(3),e.Q6J("disabled",o.isdefaultfleet),e.xp6(1),e.Oqu(o.active_label),e.xp6(4),e.Q6J("disabled",!o.theFleet.id),e.xp6(9),e.Q6J("disabled",!o.theFleet.id),e.xp6(6),e.Q6J("disabled",o.generalFormGroup.pristine),e.xp6(2),e.Q6J("disabled",o.generalFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",o.informationFormGroup),e.xp6(1),e.Q6J("formGroup",o.informationFormGroup),e.xp6(48),e.Q6J("disabled",o.informationFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",o.parametersFormGroup),e.xp6(1),e.Q6J("formGroup",o.parametersFormGroup),e.xp6(6),e.Q6J("ngxTimepicker",r)("format",24),e.xp6(1),e.Q6J("theme",o.homaacsaTheme),e.xp6(5),e.Q6J("accept",o.requiredFileType),e.xp6(2),e.Q6J("disabled",""!=o.fleetLogoFile),e.xp6(4),e.Oqu(o.selectedFilename),e.xp6(1),e.Q6J("disabled",""!=o.fleetLogoFile),e.xp6(2),e.Q6J("disabled",""==o.fleetLogoFile),e.xp6(6),e.Q6J("disabled",o.parametersFormGroup.invalid),e.xp6(2),e.Q6J("stepControl",o.validationFormGroup),e.xp6(1),e.Q6J("formGroup",o.validationFormGroup),e.xp6(8),e.Q6J("disabled",!o.pin_block),e.xp6(1),e.Q6J("value",2),e.xp6(2),e.Q6J("value",1),e.xp6(5),e.Q6J("readonly",!o.pin_block),e.xp6(1),e.Q6J("disabled",!o.pin_block),e.xp6(9),e.Q6J("disabled",!o.eh_block),e.xp6(5),e.Q6J("readonly",!o.eh_block),e.xp6(4),e.Q6J("readonly",!o.eh_block),e.xp6(1),e.Q6J("disabled",!o.eh_block),e.xp6(5),e.Q6J("disabled",!o.odo_block),e.xp6(5),e.Q6J("readonly",!o.odo_block),e.xp6(4),e.Q6J("readonly",!o.odo_block),e.xp6(1),e.Q6J("disabled",!o.odo_block),e.xp6(5),e.Q6J("disabled",o.accountFormGroup.invalid)}},directives:[Q.i,R.M,v.Hw,p.xw,p.Wh,f.Vq,f.C0,i._Y,i.JL,i.sg,f.VY,p.SQ,g.KE,p.yH,g.hX,i.Fj,z.Nt,i.JJ,i.u,i.Q7,g.bx,oe.gD,_.sg,E.Rr,k.lW,f.Ic,f.fd,B.I2,B.ro,ae.oG,J.VQ,J.U0,ne.ey],styles:[".fury-page[_ngcontent-%COMP%]{padding:0;max-width:70vmax;max-height:80vmin}.title[_ngcontent-%COMP%]{color:#000}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:50%}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:90%}.card[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;min-width:100%}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:8px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}.label-timepicker[_ngcontent-%COMP%]{position:relative;font-size:11px;font-family:Roboto;font-weight:400;top:10px;color:#0009;background:white;z-index:1;width:35px;margin:-92px 10px 0!important;height:15px;padding-left:5px}.hidden[_ngcontent-%COMP%]{display:none}.selected-label[_ngcontent-%COMP%]{max-width:450%;min-width:45%;margin-right:40px;padding:8px}.div-file-input[_ngcontent-%COMP%]{display:flex;height:51px;padding:8px;text-align:left;border-width:thin;border-style:solid;border-radius:5px;border-color:#e0e0e0;color:#5b5b5b;max-width:100%;min-width:100%}"],data:{animation:[D.X,w.M,U.K]}}),a})();var je=c(94327),Ye=c(92573),$e=c(97187);function Ve(a,n){if(1&a&&(e.TgZ(0,"th",21),e._uU(1),e.qZA()),2&a){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name,"")}}function He(a,n){if(1&a&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&a){const t=n.$implicit,o=e.oxw(2).$implicit,r=e.oxw();e.xp6(1),e.hij(" ",r.getLabel(o.name,t[o.property])," ")}}function Be(a,n){if(1&a&&(e.ynx(0,18),e.YNc(1,Ve,2,1,"th",19),e.YNc(2,He,2,1,"td",20),e.BQk()),2&a){const t=e.oxw().$implicit;e.Q6J("matColumnDef",t.property)}}function Xe(a,n){if(1&a&&(e.ynx(0),e.YNc(1,Be,3,1,"ng-container",17),e.BQk()),2&a){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.isModelProperty)}}function Ke(a,n){1&a&&e._UZ(0,"th",23)}function et(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().changeStatusOfFleet(r)}),e.TgZ(1,"span"),e._uU(2,"Activar"),e.qZA(),e.qZA()}}function tt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().changeStatusOfFleet(r)}),e.TgZ(1,"span"),e._uU(2,"Bloquear"),e.qZA(),e.qZA()}}function ot(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().deleteFleet(r)}),e.TgZ(1,"span"),e._uU(2,"Eliminar"),e.qZA(),e.qZA()}}function at(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"td",24),e.TgZ(1,"button",25),e.NdJ("click",function(r){return r.stopPropagation()}),e.TgZ(2,"mat-icon"),e._uU(3,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(4,"mat-menu",26,27),e.TgZ(6,"button",28),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().updateFleet(s)}),e.TgZ(7,"span"),e._uU(8,"Editar"),e.qZA(),e.qZA(),e.YNc(9,et,3,0,"button",29),e.YNc(10,tt,3,0,"button",29),e.YNc(11,ot,3,0,"button",29),e.qZA(),e.qZA()}if(2&a){const t=e.MAs(5),o=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",t),e.xp6(8),e.Q6J("ngIf",!o.bloqueable&&!o.isdefaultfleet),e.xp6(1),e.Q6J("ngIf",o.bloqueable&&!o.isdefaultfleet),e.xp6(1),e.Q6J("ngIf",!o.isdefaultfleet)}}function nt(a,n){1&a&&e._UZ(0,"tr",30)}function rt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",31),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().updateFleet(s)}),e.qZA()}}const it=function(){return["Tables"]},st=[{path:"",component:(()=>{class a{constructor(t,o,r,s,l,m,C,Z){this.dialog=t,this.fileUploaderDialog=o,this.fleetsService=r,this.groupRulesService=s,this._jobsService=l,this._dbUtilitiesService=m,this.snackbar=C,this._filesUploaderService=Z,this.subject$=new ee.t(1),this.data$=this.subject$.asObservable(),this.bloqueable=!0,this.isdefaultfleet=!1,this.groupRules=[],this.columns=[{name:"Id Flota",property:"id",visible:!0,isModelProperty:!0},{name:"Nombre",property:"NAME",visible:!0,isModelProperty:!0},{name:"C\xf3digo",property:"code",visible:!0,isModelProperty:!0},{name:"Regla",property:"default_rule",visible:!0,isModelProperty:!0},{name:"Estatus",property:"status",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10}getLabel(t,o){if(null!=t){if("Regla"==t){for(var r=0;r<this.groupRules.length;r++)if(o==this.groupRules[r].id)return this.groupRules[r].NAME;return"Regla no definida"}return"C\xf3digo"==t?(this.isdefaultfleet=99999==o,o):"Estatus"==t?(this.bloqueable=2==o&&!this.isdefaultfleet,2==o?"Activo":"Desactivado"):o}}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}getData(){this.fleetsService.getAll().subscribe(t=>{this.fleets=t,this.dataSource=new d.by(t),this.dataSource=new d.by(this.fleets),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},t=>{console.log(t)})}getGroupRules(){this.groupRulesService.getAll().subscribe(t=>{this.groupRules=t},t=>{console.log(t)})}ngOnInit(){this.dataSource=new d.by,this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(t=>!!t)).subscribe(t=>{this.fleets=t,this.dataSource.data=this.fleets})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}createFleet(){this.dialog.open(X).afterClosed().subscribe(t=>{t&&(this.subject$.next(this.fleets),this.getGroupRules(),this.getData(),this._jobsService.push({type:"fleets",object:t}).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})}))})}updateFleet(t){this.dialog.open(X,{data:t}).afterClosed().subscribe(o=>{o&&(this.subject$.next(this.fleets),this.getGroupRules(),this.getData(),this._jobsService.push({type:"fleets",object:o}).subscribe(r=>{this.snackbar.open(r.message,null,{duration:5e3,panelClass:["green-snackbar"]})},r=>{this.snackbar.open(r.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})}))})}changeStatusOfFleet(t){t.status=2==t.status?1:2,this.updateTheFleet(t)}deleteFleet(t){t.status=0,this.updateTheFleet(t)}updateTheFleet(t){console.log("updateTheFleet",t),this.fleetsService.update(t).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.subject$.next(this.fleets),this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(r=>!!r)).subscribe(r=>{this.fleets=r,this.dataSource.data=r}),this._jobsService.push({type:"fleets",object:t}).subscribe(r=>{this.snackbar.open(r.message,null,{duration:5e3,panelClass:["green-snackbar"]})},r=>{this.snackbar.open(r.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})}onFilterChange(t){!this.dataSource||(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}ngOnDestroy(){}exportFleets(){this._dbUtilitiesService.getRecordsByModel("fleets").subscribe(t=>{this._filesUploaderService.getFile(t.filename).subscribe(o=>{let r=o.file;console.log(r);const s=atob(r),l=new Array(s.length);for(let Z=0;Z<s.length;Z++)l[Z]=s.charCodeAt(Z);const m=new Uint8Array(l),C=new Blob([m],{type:"application/gzip"});(0,je.saveAs)(C,t.filename)})},t=>{console.log(t.message)})}importFleets(){this.fileUploaderDialog.open(Ye.G).afterClosed().subscribe(t=>{console.log("importing",t),this._dbUtilitiesService.uploadBackup(t).subscribe(o=>{this.snackbar.open(o.message,null,{duration:5e3,panelClass:["green-snackbar"]}),this.subject$.next(this.fleets),this.getGroupRules(),this.getData(),this.data$.pipe((0,T.h)(r=>!!r)).subscribe(r=>{this.fleets=r,this.dataSource.data=r})},o=>{this.snackbar.open(o.error.message,null,{duration:5e3,panelClass:["red-snackbar"]})})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(u.uw),e.Y36(u.uw),e.Y36(de.V),e.Y36(G.o),e.Y36(re.e),e.Y36($e.y),e.Y36(M.ux),e.Y36(ce.a))},a.\u0275cmp=e.Xpm({type:a,selectors:[["fleets-table"]],viewQuery:function(t,o){if(1&t&&(e.Gf(I.NW,7),e.Gf(x.YE,7)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},inputs:{columns:"columns"},decls:21,vars:12,consts:[["mode","card"],["current","Flotas",3,"crumbs"],["name","Flotas",3,"columns","filterChange"],["fxLayoutGap","8px",1,"actions"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["type","button","mat-mini-fab","","color","primary","alt","Export fleets",1,"create",3,"click"],["svgIcon","export"],["type","button","mat-mini-fab","","color","primary","alt","Import fleets",1,"create",3,"click"],["svgIcon","import"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"fury-page-layout",0),e.TgZ(1,"fury-page-layout-header"),e._UZ(2,"fury-breadcrumbs",1),e.qZA(),e.TgZ(3,"fury-page-layout-content"),e.TgZ(4,"fury-list",2),e.NdJ("filterChange",function(s){return o.onFilterChange(s)}),e.TgZ(5,"div",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return o.createFleet()}),e.TgZ(7,"mat-icon"),e._uU(8,"add"),e.qZA(),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return o.exportFleets()}),e._UZ(10,"mat-icon",6),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return o.importFleets()}),e._UZ(12,"mat-icon",8),e.qZA(),e.qZA(),e.TgZ(13,"table",9),e.YNc(14,Xe,2,1,"ng-container",10),e.ynx(15,11),e.YNc(16,Ke,1,0,"th",12),e.YNc(17,at,12,4,"td",13),e.BQk(),e.YNc(18,nt,1,0,"tr",14),e.YNc(19,rt,1,0,"tr",15),e.qZA(),e._UZ(20,"mat-paginator",16),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("@fadeInRight",void 0)("crumbs",e.DdM(11,it)),e.xp6(1),e.Q6J("@fadeInUp",void 0),e.xp6(1),e.Q6J("columns",o.columns),e.xp6(6),e.Q6J("@scaleIn",void 0),e.xp6(2),e.Q6J("@scaleIn",void 0),e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(1),e.Q6J("ngForOf",o.columns),e.xp6(4),e.Q6J("matHeaderRowDef",o.visibleColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.visibleColumns),e.xp6(1),e.Q6J("pageSize",o.pageSize))},directives:[W.N,j.U,Y.n,$.d,ie.n,p.SQ,k.lW,v.Hw,d.BZ,x.YE,_.sg,d.w1,d.fO,d.Dz,d.as,d.nj,I.NW,_.O5,d.ge,x.nU,d.ev,A.p6,A.VK,A.OP,d.XQ,d.Gk],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:[w.M,D.X,U.K]}}),a})()}];let lt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[h.Bz.forChild(st)],h.Bz]}),a})();const ct=[{path:"",component:X}];let ue=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[h.Bz.forChild(ct)],h.Bz]}),a})(),dt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,ue,N.Z,i.UX,q.q,S.JF,B.rK]]}),a})();const ut=[{path:"",component:se}];let pe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[h.Bz.forChild(ut)],h.Bz]}),a})(),pt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,pe,i.u5,q.q,N.Z,P.p,O.J]]}),a})();const mt=[{path:"",component:L}];let me=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[h.Bz.forChild(mt)],h.Bz]}),a})(),_t=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,me,N.Z,i.UX,q.q]]}),a})();var ht=c(74519);const ft=[{path:"",component:le}];let _e=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[h.Bz.forChild(ft)],h.Bz]}),a})(),gt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[O.J,_.ez,i.u5,i.UX,P.p,q.q,ht.O,N.Z,_e,b.dp]]}),a})(),bt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,lt,i.u5,i.UX,q.q,N.Z,dt,ue,pt,pe,_t,me,gt,_e,P.p,O.J]]}),a})()}}]);