"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[9863],{19863:(qt,ye,h)=>{h.r(ye),h.d(ye,{MarimbasModule:()=>Wt});var E=h(69808),_=h(93075),ke=h(61264),re=h(4940),ie=h(7057),oe=h(72467),Q=h(3299),y=h(70655),a=h(5e3),H=h(48966),q=h(86087),k=h(84847),O=h(32075),xe=h(96831),Ce=h(92198),ne=h(88914),se=h(14499),we=h(96166),We=h(12983),Pe=h.n(We),Me=h(2223),le=h(33344),Oe=h(2728),ue=h(74002),Te=h(60198),ce=h(53580),U=h(30277),_e=h(36551),W=h(47423),K=h(25245),Fe=h(19165),Se=h(94927),ee=h(92181);function $e(l,s){if(1&l&&(a.TgZ(0,"th",22),a._uU(1),a.qZA()),2&l){const e=a.oxw(2).$implicit;a.xp6(1),a.hij(" ",e.name,"")}}function qe(l,s){if(1&l&&(a.TgZ(0,"td",23),a._uU(1),a.qZA()),2&l){const e=s.$implicit,t=a.oxw(2).$implicit,r=a.oxw();a.xp6(1),a.Oqu(r.getLabel(t.name,e[t.property]))}}function Ke(l,s){if(1&l&&(a.TgZ(0,"td",24),a._uU(1),a.qZA()),2&l){const e=a.oxw(2).$implicit,t=a.oxw();a.xp6(1),a.Oqu(t.getTotals(e.property))}}function et(l,s){if(1&l&&(a.ynx(0,18),a.YNc(1,$e,2,1,"th",19),a.YNc(2,qe,2,1,"td",20),a.YNc(3,Ke,2,1,"td",21),a.BQk()),2&l){const e=a.oxw().$implicit;a.Q6J("matColumnDef",e.property)}}function tt(l,s){if(1&l&&(a.ynx(0),a.YNc(1,et,4,1,"ng-container",17),a.BQk()),2&l){const e=s.$implicit;a.xp6(1),a.Q6J("ngIf",e.isModelProperty&&e.visible)}}function at(l,s){1&l&&a._UZ(0,"th",25)}function rt(l,s){if(1&l&&(a.TgZ(0,"td",26),a.TgZ(1,"button",27),a.NdJ("click",function(t){return t.stopPropagation()}),a.TgZ(2,"mat-icon"),a._uU(3,"more_horiz"),a.qZA(),a.qZA(),a._UZ(4,"mat-menu",28,29),a.qZA()),2&l){const e=a.MAs(5);a.xp6(1),a.Q6J("matMenuTriggerFor",e)}}function it(l,s){1&l&&a._UZ(0,"tr",30)}function ot(l,s){1&l&&a._UZ(0,"tr",31)}function nt(l,s){1&l&&a._UZ(0,"tr",32)}let De=(()=>{class l{constructor(e,t,r,i,n,o){this.data=e,this._excelerService=t,this._tokenStorageService=r,this._transactionsService=i,this._generalSettingsService=n,this._filesUploaderService=o,this.subject$=new xe.t(1),this.data$=this.subject$.asObservable(),this.bloqueable=!0,this.columns=[{name:"Id transacci\xf3n",property:"id",visible:!0,isModelProperty:!0,displayFn:!0},{name:"Fecha y hora",property:"TIMESTAMP",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Cantidad de recarga",property:"refill_quantity",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Cantidad de despacho",property:"transaction_quantity",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Existencia te\xf3rica",property:"theoretical_existence",visible:!0,isModelProperty:!0,displayFn:!1}],this.pageSize=10}getLabel(e,t){if(null!=e)return t}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}getData(){this.dataSource=new O.by(this.data.report.details),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnInit(){this._generalSettingsService.getAll().subscribe(e=>{this.generalSettings=e,this._filesUploaderService.getFileBase64(e.logo_filename).subscribe(t=>{this.generalLogoString=t.file},t=>{console.log(t)})},e=>{console.log(e)}),this.dataSource=new O.by,this._transactionsService.getServerTimestamp().subscribe(e=>{this.datetime=e.message}),this.getData(),this.data$.pipe((0,Ce.h)(e=>!!e)).subscribe(e=>{this.dataSource.data=e})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}onFilterChange(e){!this.dataSource||(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}getTotals(e){return"refill_quantity"==e||"transaction_quantity"==e?(Math.round(100*this.data.report.details.map(t=>t[e]).reduce((t,r)=>t+r,0))/100).toFixed(2):"theoretical_existence"==e?(Math.round(100*this.data.report.details.map(t=>t[e]).reduce((t,r)=>r,0))/100).toFixed(2):"id"==e?"Totales:":""}round(e){return(Math.round(100*e)/100).toFixed(2)}pdfMe(){var e=[],t=[],r=[],i=[];this.columns.forEach(p=>{p.visible&&(t.push({title:p.name,dataKey:p.property}),r.push(p.property),i.push(p.name))});var n=0,o={refill_quantity:0,transaction_quantity:0};this.dataSource.filteredData.forEach(p=>{e[n]={},r.forEach(f=>{o[f]="id"==f?"Totales":"refill_quantity"==f||"transaction_quantity"==f?o[f]+p[f]:"theoretical_existence"==f?+p[f]:"",e[n][f]=p[f]}),n++}),e[n]=o;var c=new we.jsPDF({orientation:"portrait",unit:"mm",format:"letter"});c.setFillColor("#152235"),c.roundedRect(10,15,195,30,2,2,"DF"),c.setFontSize(11),c.setTextColor("white"),c.text("Reporte mensual de estaci\xf3n m\xf3vil: "+this.data.filter.station_name,15,38),c.setFontSize(9),c.text("Correspondiente a "+this.data.filter.month_name+" del "+this.data.filter.year,15,43),c.addImage("./../../../../../assets/img/maacsa.png","PNG",15,20,62,10.3),c.addImage(this.generalLogoString,"PNG",161.1,20,38.9,13.22),c.setFontSize(8),c.text("Generado por "+this._tokenStorageService.getUser().user+"("+this._tokenStorageService.getUser().name+") "+this.datetime,120,43),Pe()(c,{body:e,columns:t,startY:50,headStyles:{fontStyle:"bold",fillColor:"#152235",halign:"center"},willDrawCell:function(p){var f=p.doc,m=p.table.body;1===m.length||p.row.index===m.length-1&&(f.setFillColor("#152235"),f.setTextColor("white"),f.setFont(f.getFont().fontName,"bold"))}});let d=c.lastAutoTable.finalY;d+=10,c.output("dataurlnewwindow")}orderDataset(e,t){var r=[],i=[],n=[],o=[];t.forEach(u=>{r.push({title:u,dataKey:u}),i.push(u),n.push(u)});var c=0;return e.forEach(u=>{o[c]={},i.forEach(d=>{o[c][d]=u[d]}),c++}),o}excelMe(){return(0,y.mG)(this,void 0,void 0,function*(){var e=0,t={},r=[];t.refill_quantity=0,t.transaction_quantity=0,this.data.report.details.forEach(c=>{r[e]={},this.data.report.hdetails.forEach(u=>{t[u]="id"==u?"Totales":"refill_quantity"==u||"transaction_quantity"==u?t[u]+c[u]:"theoretical_existence"==u?+c[u]:"",r[e][u]=c[u]}),e++}),r[e]=t;var i=this.orderDataset(r,this.data.report.hdetails),n=[];this.data.report.hdetails.forEach(function(c,u){"id"==c?(this[u]="Id transacci\xf3n",n.push({width:20,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"TIMESTAMP"==c?(this[u]="Fecha y hora",n.push({width:20,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"refill_quantity"==c?(this[u]="Cantidad de recarga",n.push({width:20,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"transaction_quantity"==c?(this[u]="Cantidad de despacho",n.push({width:20,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"theoretical_existence"==c?(this[u]="Existencia te\xf3rica",n.push({width:20,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):n.push({width:20,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})},this.data.report.hdetails),this._excelerService.excelIt([{worksheet:"detalle",datas:[{title:{vector:["Detalle de movimientos de estaci\xf3n m\xf3vil"],font:{name:"Verdana",size:14,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},header:{filter:!1,vector:this.data.report.hdetails,font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"e6e5e5"}}},body:{matrix:i,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:n}}]}],"detalle_marimba_"+this.data.filter.station_name+"_"+this.data.filter.month+"_"+this.data.filter.year)})}ngOnDestroy(){}}return l.\u0275fac=function(e){return new(e||l)(a.Y36(H.WI),a.Y36(Me.N),a.Y36(le.i),a.Y36(Oe.v),a.Y36(ue.b),a.Y36(Te.a))},l.\u0275cmp=a.Xpm({type:l,selectors:[["marimba-detail-modal-table"]],viewQuery:function(e,t){if(1&e&&(a.Gf(q.NW,7),a.Gf(k.YE,7)),2&e){let r;a.iGM(r=a.CRH())&&(t.paginator=r.first),a.iGM(r=a.CRH())&&(t.sort=r.first)}},inputs:{columns:"columns"},decls:23,vars:11,consts:[["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","end",1,"buttons-set"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["svgIcon","excel"],["svgIcon","pdf"],[1,"page-modal"],["name","Totales",3,"columns","filterChange"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","route-animations-elements","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","","class","totals",4,"matFooterCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell","",1,"totals"],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-header-row",""],["mat-row","",1,"route-animations-elements"],["mat-footer-row",""]],template:function(e,t){1&e&&(a.TgZ(0,"fury-page-layout-header"),a.TgZ(1,"div",0),a.TgZ(2,"div",1),a.TgZ(3,"fury-title"),a._uU(4),a.qZA(),a.TgZ(5,"fury-title"),a._uU(6),a.qZA(),a.qZA(),a.TgZ(7,"div",2),a.TgZ(8,"button",3),a.NdJ("click",function(){return t.excelMe()}),a._UZ(9,"mat-icon",4),a.qZA(),a.TgZ(10,"button",3),a.NdJ("click",function(){return t.pdfMe()}),a._UZ(11,"mat-icon",5),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"fury-page-layout-content",6),a.TgZ(13,"fury-list",7),a.NdJ("filterChange",function(i){return t.onFilterChange(i)}),a.TgZ(14,"table",8),a.YNc(15,tt,2,1,"ng-container",9),a.ynx(16,10),a.YNc(17,at,1,0,"th",11),a.YNc(18,rt,6,1,"td",12),a.BQk(),a.YNc(19,it,1,0,"tr",13),a.YNc(20,ot,1,0,"tr",14),a.YNc(21,nt,1,0,"tr",15),a.qZA(),a._UZ(22,"mat-paginator",16),a.qZA(),a.qZA()),2&e&&(a.xp6(4),a.AsE("Periodo: ",t.data.filter.month,"/",t.data.filter.year,""),a.xp6(2),a.hij("Estaciones: ",t.data.filter.station_name,""),a.xp6(6),a.Q6J("@fadeInUp",void 0),a.xp6(1),a.Q6J("columns",t.columns),a.xp6(1),a.Q6J("dataSource",t.dataSource),a.xp6(1),a.Q6J("ngForOf",t.columns),a.xp6(4),a.Q6J("matHeaderRowDef",t.visibleColumns),a.xp6(1),a.Q6J("matRowDefColumns",t.visibleColumns),a.xp6(1),a.Q6J("matFooterRowDef",t.visibleColumns),a.xp6(1),a.Q6J("pageSize",t.pageSize))},directives:[ce.U,U.xw,U.SQ,_e.M,U.Wh,W.lW,K.Hw,Fe.d,Se.n,O.BZ,k.YE,E.sg,O.w1,O.fO,O.Dz,O.as,O.nj,O.Ke,q.NW,E.O5,O.mD,O.ge,k.nU,O.ev,O.yh,ee.p6,ee.VK,O.XQ,O.Gk,O.Q2],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}.title[_ngcontent-%COMP%]{color:#000}.page-modal[_ngcontent-%COMP%]{overflow:scroll;max-height:600px;margin:24px;padding:2px;box-shadow:0 3px 3px -2px #0003,0 3px 4px #00000024,0 1px 8px #0000001f}.page-modal[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.page-modal[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:5px}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.page-modal[_ngcontent-%COMP%]   .information-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:100%}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:410px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:245px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;width:245px}.page-modal[_ngcontent-%COMP%]   .text-icon[_ngcontent-%COMP%]{max-width:49.5%}.page-modal[_ngcontent-%COMP%]   .indented-right[_ngcontent-%COMP%]{margin-left:40px}.page-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}.numerical[_ngcontent-%COMP%]{text-align:end}.fury-title[_ngcontent-%COMP%]{color:#f5f5f5}.buttons-set[_ngcontent-%COMP%]{margin-left:60px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]{text-align:center;width:70px;height:70px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:40px;height:40px}.totals[_ngcontent-%COMP%]{color:#000;font-weight:700}"],data:{animation:[ne.M,se.X]}}),l})();var fe,Ae=h(81041),te=h(20365),B=h(48230),V=h(71872),ae=h(48271),st=function(l){function s(){var e=null!==l&&l.apply(this,arguments)||this;return Object.defineProperty(e,"_index",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(e,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._afterNewApplyThemes.call(this)}}),Object.defineProperty(s.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(l.prototype._beforeChanged.call(this),this.isDirty("sprite")){var e=this.get("sprite");e&&(e.setAll({position:"absolute",role:"figure"}),this._disposers.push(e))}(this.isDirty("locationX")||this.isDirty("locationY"))&&this.series&&this.series._positionBullet(this)}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Bullet"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ae.JH.classNames.concat([s.className])}),s}(ae.JH),de=h(50314),lt=function(l){function s(){return null!==l&&l.apply(this,arguments)||this}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._beforeChanged.call(this),this.isDirty("radius")&&(this._clear=!0)}}),Object.defineProperty(s.prototype,"_changed",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._changed.call(this),this._clear&&this._display.drawCircle(0,0,this.get("radius",10))}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Circle"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:de.T.classNames.concat([s.className])}),s}(de.T),ut=h(58453),ct=h(55777),je=h(97950),F=h(59660),S=h(8256),dt=h(45106),$=h(57166),ft=h(19070),pt=function(l){function s(){var e=null!==l&&l.apply(this,arguments)||this;return Object.defineProperty(e,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(e,"_itemMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),e}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=$.Fy(this._settings.themeTags,["axis"]),this.fields.push("category"),this.setPrivateRaw("name","category"),this.addTag("category"),l.prototype._afterNew.call(this)}}),Object.defineProperty(s.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;l.prototype._prepareChildren.call(this);var t=this.dataItems.length,r=0;this._valuesDirty&&(F.S6(this.dataItems,function(i){i.setRaw("index",r),e._itemMap[i.get("category")]=i,r++}),this.setPrivateRaw("maxZoomFactor",t)),this.setPrivateRaw("startIndex",Math.max(Math.round(this.get("start",0)*t),0)),this.setPrivateRaw("endIndex",Math.min(Math.round(this.get("end",1)*t),t)),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("endIndex")||this.isPrivateDirty("startIndex")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&this.dataItems.length>0&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges())}}),Object.defineProperty(s.prototype,"_handleRangeChange",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;F.S6(this.series,function(t){var r=e.dataItems[e.startIndex()].get("category"),i=e.dataItems[e.endIndex()-1].get("category"),n=t.get("baseAxis"),o=t.get("xAxis"),c=t.get("yAxis");if(o instanceof s&&c instanceof s)t._markDirtyAxes();else if(n===e){var u=void 0,d=void 0,p=c;if(o===n?(t.get("categoryXField")&&(u="categoryX"),t.get("openCategoryXField")&&(d="openCategoryX")):c===n&&(t.get("categoryYField")&&(u="categoryY"),t.get("openCategoryYField")&&(d="openCategoryY"),p=o),"ValueAxis"==p.className&&(u||d)){for(var f=void 0,m=void 0,g=0,x=t.dataItems.length;g<x;g++){var b=t.dataItems[g];if(u&&b.get(u)===r){f=b;break}if(d&&b.get(d)===r){f=b;break}}for(g=t.dataItems.length-1;g>=0;g--){if(b=t.dataItems[g],u&&b.get(u)===i){m=b;break}if(d&&b.get(d)===i){m=b;break}}f&&t.setPrivate("startIndex",t.dataItems.indexOf(f)),m&&t.setPrivate("endIndex",t.dataItems.indexOf(m)+1)}t._markDirtyAxes()}})}}),Object.defineProperty(s.prototype,"_prepareAxisItems",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.get("renderer"),t=this.dataItems.length,r=this.startIndex();r>0&&r--;var i=this.endIndex();i<t&&i++;var n=e.axisLength()/Math.max(e.get("minGridDistance"),1/Number.MAX_SAFE_INTEGER),o=Math.max(1,Math.min(t,Math.ceil((i-r)/n)));r=Math.floor(r/o)*o,this._frequency=o;for(var c=0;c<t;c++)this.dataItems[c].hide();for(var u=this.dataItems[r].get("index",0),d=r;d<i;d+=o){var p=this.dataItems[d];this._createAssets(p,[]),p.isHidden()&&p.show(),this._prepareDataItem(p,u,o),u++}this._updateGhost()}}),Object.defineProperty(s.prototype,"_prepareDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var i=this.get("renderer"),n=e.get("categoryLocation",0),o=e.get("endCategoryLocation",1),c=e.get("index");S.hj(c)||(c=this.categoryToIndex(e.get("category")));var p,u=this.indexToPosition(c,n),d=e.get("endCategory");d?(p=this.categoryToIndex(d),S.hj(p)||(p=c)):p=c;var m,g,f=this.indexToPosition(p,o);m=e.get("isRange")?p:c+this._frequency-1,g=this.indexToPosition(m,o),i.updateLabel(e.get("label"),u,f,r),i.updateGrid(e.get("grid"),u,f),i.updateTick(e.get("tick"),u,f,r),i.updateFill(e.get("axisFill"),u,g),this._processBullet(e),i.updateBullet(e.get("bullet"),u,f);var x=this.get("fillRule");x&&x(e,t)}}),Object.defineProperty(s.prototype,"startIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.dataItems.length;return Math.min(Math.max(this.getPrivate("startIndex",0),0),e-1)}}),Object.defineProperty(s.prototype,"endIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.dataItems.length;return Math.max(1,Math.min(this.getPrivate("endIndex",e),e))}}),Object.defineProperty(s.prototype,"baseValue",{enumerable:!1,configurable:!0,writable:!0,value:function(){}}),Object.defineProperty(s.prototype,"basePosition",{enumerable:!1,configurable:!0,writable:!0,value:function(){return 0}}),Object.defineProperty(s.prototype,"getX",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}}),Object.defineProperty(s.prototype,"getY",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}}),Object.defineProperty(s.prototype,"getDataItemPositionX",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){var n=e.get(t),o=this._itemMap[n];return o?this.indexToPosition(o.get("index",0),r):NaN}}),Object.defineProperty(s.prototype,"getDataItemCoordinateX",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,r,i))}}),Object.defineProperty(s.prototype,"getDataItemPositionY",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){var n=e.get(t),o=this._itemMap[n];return o?this.indexToPosition(o.get("index",0),r):NaN}}),Object.defineProperty(s.prototype,"getDataItemCoordinateY",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,r,i))}}),Object.defineProperty(s.prototype,"indexToPosition",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){S.hj(t)||(t=.5);var r=this.dataItems.length,i=this.get("startLocation",0);r-=i;var o=(e+t-i)/(r-=1-this.get("endLocation",1)),c=this.dataItems[e];return c&&(o+=c.get("deltaPosition",0)),o}}),Object.defineProperty(s.prototype,"categoryToIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this._itemMap[e];return t?t.get("index"):NaN}}),Object.defineProperty(s.prototype,"dataItemToPosition",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.indexToPosition(e.get("index"))}}),Object.defineProperty(s.prototype,"roundAxisPosition",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.indexToPosition(this.axisPositionToIndex(e),t)}}),Object.defineProperty(s.prototype,"axisPositionToIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.dataItems.length;return dt.C7(Math.floor(e*t),0,t-1)}}),Object.defineProperty(s.prototype,"getTooltipText",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.dataItems[this.axisPositionToIndex(e)];if(t){var r=t.get("label");if(r)return(0,ft.q)(r,this.get("tooltipText",""))}}}),Object.defineProperty(s.prototype,"_updateTooltipText",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e._setDataItem(this.dataItems[this.axisPositionToIndex(t)]),e.label.text.markDirtyText()}}),Object.defineProperty(s.prototype,"getSeriesItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(this.dataItems.length>0){var r=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),i=this.axisPositionToIndex(t),n=e.dataItems[i],o=this.dataItems[i],c=o.get("category");if(n&&o&&n.get(r)===c)return n;for(var u=0,d=e.dataItems.length;u<d;u++){var p=e.dataItems[u];if(p.get(r)===c)return p}}}}),Object.defineProperty(s.prototype,"zoomToIndexes",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var i=this.dataItems.length;this.zoom(e/i,t/i,r)}}),Object.defineProperty(s.prototype,"zoomToCategories",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){this.zoomToIndexes(this.categoryToIndex(e),this.categoryToIndex(t)+1,r)}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CategoryAxis"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:je.R.classNames.concat([s.className])}),s}(je.R),ht=h(28810),Re=h(62827),Ze=h(36519),Ne=h(55441),Le=function(l){function s(){var e=null!==l&&l.apply(this,arguments)||this;return Object.defineProperty(e,"_ph",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(e,"_pw",{enumerable:!0,configurable:!0,writable:!0,value:0}),e}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"_makeGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.makeColumn(t,e)}}),Object.defineProperty(s.prototype,"_makeFieldNames",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._makeFieldNames.call(this);var e=this.get("xAxis"),t=this.get("yAxis"),r="CategoryAxis",i="ValueAxis";e.isType(r)&&(this.get("openCategoryXField")||(this._xOpenField=this._xField)),e.isType(i)&&(this.get("openValueXField")||(this._xOpenField=this._xField)),t.isType(r)&&(this.get("openCategoryYField")||(this._yOpenField=this._yField)),t.isType(i)&&(this.get("openValueYField")||(this._yOpenField=this._yField))}}),Object.defineProperty(s.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._prepareChildren.call(this);var e=this.get("xAxis"),t=this.get("yAxis"),r=this.dataItems.length,i=Math.max(0,this.startIndex()-2),n=Math.min(this.endIndex()+2,r-1);if(e.inited&&t.inited)for(var o=i;o<=n;o++)this._createGraphics(this.dataItems[o])}}),Object.defineProperty(s.prototype,"_updateChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this.chart;t&&(this._ph=t.plotContainer.height(),this._pw=t.plotContainer.width());var r=this.get("xAxis"),i=this.get("yAxis"),n=this.get("baseAxis"),o=this.columns.template;this.isDirty("fill")&&null==o.get("fill")&&o.set("fill",this.get("fill")),this.isDirty("stroke")&&null==o.get("stroke")&&o.set("stroke",this.get("stroke"));var c=0,u=0,d=0;F.S6(n.series,function(I){if(I instanceof s){var X=I.get("stacked");X&&0==d&&u++,!X&&I.get("clustered")&&u++}I===e&&(c=u-1),d++}),this.get("clustered")||(c=0,u=1),0===u&&(u=1,c=0);var p=r.get("renderer"),f=i.get("renderer"),m="cellStartLocation",g="cellEndLocation",x=p.get(m,0),b=p.get(g,1),w=f.get(m,0),M=f.get(g,1);if(this._aLocationX0=x+c/u*(b-x),this._aLocationX1=x+(c+1)/u*(b-x),this._aLocationY0=w+c/u*(M-w),this._aLocationY1=w+(c+1)/u*(M-w),r.inited&&i.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty){for(var C=this.dataItems.length,v=Math.max(0,this.startIndex()-2),P=Math.min(this.endIndex()+2,C-1),G=0;G<v;G++)this._toggleColumn(this.dataItems[G],!1);for(var Y=this.dataItems[v],N=v;N<=P;N++)if(null!=(J=this.dataItems[N]).get("valueX")&&null!=J.get("valueY")){if(Y=J,N>0&&v>0)for(var T=N-1;T>=0;T--){var L=this.dataItems[T];if(null!=L.get("valueX")&&null!=L.get("valueY")){Y=L;break}}break}for(var D=v;D<=P;D++){var J;this._updateGraphics(J=this.dataItems[D],Y),null!=J.get("valueX")&&null!=J.get("valueY")&&(Y=J)}for(var A=P+1;A<C;A++)this._toggleColumn(this.dataItems[A],!1)}}else this._skipped=!0;l.prototype._updateChildren.call(this)}}),Object.defineProperty(s.prototype,"_createGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,r=e.get("graphics");if(!r){r=this._makeGraphics(this.columns,e),e.set("graphics",r),r._setDataItem(e);var i=e.get("legendDataItem");if(i){var n=i.get("markerRectangle");n&&n.setAll({fill:r.get("fill"),stroke:r.get("stroke")})}this.axisRanges.each(function(o){var c=o.container,u=e.get("rangeGraphics",[]);e.set("rangeGraphics",u);var d=t._makeGraphics(o.columns,e);u.push(d),d.setPrivate("list",o.columns),c.children.push(d)})}}}),Object.defineProperty(s.prototype,"_updateGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this,i=e.get("graphics"),n=this._xField,o=this._yField,c=e.get(n),u=e.get(o);if(null!=c&&null!=u){var T,L,D,A,d=this._xOpenField,p=this._yOpenField,f=this.get("locationX",e.get("locationX",.5)),m=this.get("locationY",e.get("locationY",.5)),g=this.get("openLocationX",e.get("openLocationX",f)),x=this.get("openLocationY",e.get("openLocationY",m)),b=i.get("width"),w=i.get("height"),M=this.get("stacked"),C=this.get("xAxis"),v=this.get("yAxis"),P=this.get("baseAxis"),G=C.get("start"),Y=C.get("end"),N=v.get("start"),J=v.get("end"),I=this.get("vcy",1),X=this.get("vcx",1),me=!1,ge=!1;if(v.isType("CategoryAxis")&&C.isType("CategoryAxis")){var j=this._aLocationX0+g-.5,R=this._aLocationX1+f-.5;b instanceof V.gG&&(j+=z=(R-j)*(1-b.value)/2,R-=z),T=C.getDataItemPositionX(e,d,j,X),L=C.getDataItemPositionX(e,n,R,X),j=this._aLocationY0+x-.5,R=this._aLocationY1+m-.5,w instanceof V.gG&&(j+=z=(R-j)*(1-w.value)/2,R-=z),D=v.getDataItemPositionY(e,p,j,I),A=v.getDataItemPositionY(e,o,R,I),e.setRaw("point",{x:T+(L-T)/2,y:D+(A-D)/2})}else if(C===P){if(j=this._aLocationX0+g-.5,R=this._aLocationX1+f-.5,b instanceof V.gG&&(j+=z=(R-j)*(1-b.value)/2,R-=z),T=C.getDataItemPositionX(e,d,j,X),L=C.getDataItemPositionX(e,n,R,X),D=v.getDataItemPositionY(e,o,m,I),this._yOpenField!==this._yField)A=v.getDataItemPositionY(e,p,x,I);else if(M){var be=e.get("stackToItemY");A=be?v.getDataItemPositionY(be,o,x,be.component.get("vcy")):v.basePosition()}else A=v.basePosition();e.setRaw("point",{x:T+(L-T)/2,y:D}),ge=!0}else if(v===P){var z;if(j=this._aLocationY0+x-.5,R=this._aLocationY1+m-.5,w instanceof V.gG&&(j+=z=(R-j)*(1-w.value)/2,R-=z),D=v.getDataItemPositionY(e,p,j,I),A=v.getDataItemPositionY(e,o,R,I),L=C.getDataItemPositionX(e,n,f,X),this._xOpenField!==this._xField)T=C.getDataItemPositionX(e,d,g,X);else if(M){var ve=e.get("stackToItemX");T=ve?C.getDataItemPositionX(ve,n,g,ve.component.get("vcx")):C.basePosition()}else T=C.basePosition();me=!0,e.setRaw("point",{x:L,y:D+(A-D)/2})}this._updateSeriesGraphics(e,i,T,L,D,A,me,ge),this._toggleColumn(e,!(T<G&&L<G||T>Y&&L>Y||D<N&&A<N||D>J&&A>J));var He=e.get("rangeGraphics");He&&F.S6(He,function($t){r._updateSeriesGraphics(e,$t,T,L,D,A,me,ge)}),this._applyGraphicsStates(e,t)}}}),Object.defineProperty(s.prototype,"_updateSeriesGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i,n,o,c,u){var M,d=t.get("width"),p=t.get("height"),f=t.get("maxWidth"),m=t.get("maxHeight"),g=this.getPoint(r,n),x=this.getPoint(i,o),b=e.get("point");if(b){var w=this.getPoint(b.x,b.y);b.x=w.x+this._x,b.y=w.y+this._y}r=g.x,i=x.x,n=g.y,o=x.y,S.hj(d)&&(r+=M=(i-r-d)/2,i-=M),S.hj(f)&&f<Math.abs(i-r)&&(r+=M=(i-r-f)/2,i-=M),S.hj(p)&&(n+=M=(o-n-p)/2,o-=M),S.hj(m)&&m<Math.abs(o-n)&&(n+=M=(o-n-m)/2,o-=M),this.get("adjustBulletPosition")&&(c&&(i=Math.min(Math.max(0,i),this._pw),r=Math.min(Math.max(0,r),this._pw)),u&&(n=Math.min(Math.max(0,n),this._ph),o=Math.min(Math.max(0,o),this._ph))),e.setRaw("left",r),e.setRaw("right",i),e.setRaw("top",n),e.setRaw("bottom",o),t.setPrivate("width",i-r),t.setPrivate("height",o-n),t.set("x",r),t.set("y",o-(o-n))}}),Object.defineProperty(s.prototype,"_handleDataSetChange",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;l.prototype._handleDataSetChange.call(this),F.S6(this._dataItems,function(t){e._toggleColumn(t,!1)})}}),Object.defineProperty(s.prototype,"_applyGraphicsStates",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=e.get("graphics"),i=r.states.lookup("dropFromOpen"),n=r.states.lookup("riseFromOpen"),o=r.states.lookup("dropFromPrevious"),c=r.states.lookup("riseFromPrevious");if(i||o||n||c){var f,m,u=this.get("xAxis"),d=this.get("yAxis"),p=this.get("baseAxis"),g=void 0;p===u&&d.isType("ValueAxis")?(f=e.get(this._yOpenField),m=e.get(this._yField),g=t.get(this._yField)):p===d&&u.isType("ValueAxis")&&(f=e.get(this._xOpenField),m=e.get(this._xField),g=t.get(this._xField)),S.hj(f)&&S.hj(m)&&(m<f?i&&i.apply():n&&n.apply(),S.hj(g)&&(m<g?o&&o.apply():c&&c.apply()))}}}),Object.defineProperty(s.prototype,"disposeDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e){l.prototype.disposeDataItem.call(this,e);var t=e.get("graphics");t&&(this.columns.removeValue(t),t.dispose());var r=e.get("rangeGraphics");r&&F.S6(r,function(i){var n=i.getPrivate("list");n&&n.removeValue(i),i.dispose()})}}),Object.defineProperty(s.prototype,"hideDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var r,i,n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return r=[l.prototype.hideDataItem.call(this,e,t)],(i=e.get("graphics"))&&r.push(i.hide(t)),(n=e.get("rangeGraphics"))&&F.S6(n,function(c){r.push(c.hide(t))}),[4,Promise.all(r)];case 1:return o.sent(),[2]}})})}}),Object.defineProperty(s.prototype,"_toggleColumn",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=e.get("graphics");r&&r.setPrivate("visible",t);var i=e.get("rangeGraphics");i&&F.S6(i,function(o){o.setPrivate("visible",t)});var n=e.bullets;n&&F.S6(n,function(o){o.setPrivate("hidden",!t)})}}),Object.defineProperty(s.prototype,"showDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var r,i,n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return r=[l.prototype.showDataItem.call(this,e,t)],(i=e.get("graphics"))&&r.push(i.show(t)),(n=e.get("rangeGraphics"))&&F.S6(n,function(c){r.push(c.show(t))}),[4,Promise.all(r)];case 1:return o.sent(),[2]}})})}}),Object.defineProperty(s.prototype,"updateLegendMarker",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,r=this.get("legendDataItem");if(this.get("useLastColorForLegendMarker")&&!e){var i=this.dataItems[this.endIndex()-1];i&&(e=i)}if(r){var n=this.columns.template;if(e){var o=e.get("graphics");o&&(n=o)}var c=r.get("markerRectangle");c&&(r.get("itemContainer").get("disabled")||F.S6(de.u,function(u){c.set(u,n.get(u,t.get(u)))}))}}}),Object.defineProperty(s.prototype,"_getTooltipTarget",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return"bullet"==this.get("seriesTooltipTarget")?l.prototype._getTooltipTarget.call(this,e):e.get("graphics")||this}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"BaseColumnSeries"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ne.o.classNames.concat([s.className])}),s}(Ne.o),Ye=h(5344),Ge=h(87379),Je=h(81519),Ie=function(l){function s(){var e=null!==l&&l.apply(this,arguments)||this;return Object.defineProperty(e,"columns",{enumerable:!0,configurable:!0,writable:!0,value:new Ge.o(Ye.YS.new({}),function(){return Je.c._new(e._root,{position:"absolute",themeTags:$.Fy(e.columns.template.get("themeTags",[]),["series","column"])},[e.columns.template])})}),e}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"makeColumn",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=this.mainContainer.children.push(t.make());return r._setDataItem(e),t.push(r),r}}),Object.defineProperty(s.prototype,"_processAxisRange",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;l.prototype._processAxisRange.call(this,e),e.columns=new Ge.o(Ye.YS.new({}),function(){return Je.c._new(t._root,{position:"absolute",themeTags:$.Fy(e.columns.template.get("themeTags",[]),["series","column"])},[t.columns.template,e.columns.template])})}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColumnSeries"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Le.classNames.concat([s.className])}),s}(Le),mt=h(78350),gt=h(12143),bt=h(2893),Z=h(70533),yt=function(l){function s(){return null!==l&&l.apply(this,arguments)||this}return(0,y.ZT)(s,l),Object.defineProperty(s.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){l.prototype._afterNew.call(this),this._setRawDefault("filePrefix","chart"),this._setRawDefault("charset","utf-8"),this._setRawDefault("numericFields",[]),this._setRawDefault("dateFields",[]),this._setRawDefault("durationFields",[]),this._setRawDefault("extraImages",[]),this._setRawDefault("pngOptions",{quality:1,maintainPixelRatio:!1}),this._setRawDefault("jpgOptions",{quality:.8,maintainPixelRatio:!1}),this._setRawDefault("printOptions",{quality:1,maintainPixelRatio:!1,delay:500,printMethod:"iframe",imageFormat:"png"}),this._setRawDefault("jsonOptions",{indent:2,renameFields:!0}),this._setRawDefault("csvOptions",{separator:",",addColumnNames:!0,emptyAs:"",addBOM:!0}),this._setRawDefault("htmlOptions",{emptyAs:"-",addColumnNames:!0}),this._setRawDefault("xlsxOptions",{emptyAs:"",addColumnNames:!0}),this._setRawDefault("pdfOptions",{fontSize:14,imageFormat:"png",align:"left",addURL:!0}),this._setRawDefault("pdfdataOptions",{emptyAs:"",addColumnNames:!0}),this._root.addDisposer(this)}}),Object.defineProperty(s.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(l.prototype._beforeChanged.call(this),this.isDirty("menu")){var e=this.get("menu");e&&e.set("exporting",this)}}}),Object.defineProperty(s.prototype,"_getFormatOptions",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var r=Z.JG(this.get(e+"Options",{}));return t&&Z.S6(t,function(i,n){r[i]=n}),r}}),Object.defineProperty(s.prototype,"download",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var r,i,n,o;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return r="pdfdata"==e?"pdf":e,i=this.get("filePrefix","chart")+"."+r,n=this._getFormatOptions(e,t),this.events.dispatch("downloadstarted",{type:"downloadstarted",format:e,options:n,fileName:i,target:this}),[4,this.export(e,n)];case 1:return o=c.sent(),this.streamFile(o,i,n&&n.addBOM),[2]}})})}}),Object.defineProperty(s.prototype,"print",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t=this._getFormatOptions("print",e),this.events.dispatch("printstarted",{type:"printstarted",format:"print",options:t,target:this}),[4,this.export(t.imageFormat||"png",t)];case 1:return r=i.sent(),this.initiatePrint(r,t,this.get("title")),[2]}})})}}),Object.defineProperty(s.prototype,"export",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var r;return(0,y.Jh)(this,function(i){switch(r=this._getFormatOptions(e,t),this.events.dispatch("exportstarted",{type:"exportstarted",format:e,options:r,target:this}),e){case"png":case"jpg":return[2,this.exportImage(e,r)];case"json":return[2,this.exportJSON(r)];case"csv":return[2,this.exportCSV(r)];case"html":return[2,this.exportHTML(r)];case"xlsx":return[2,this.exportXLSX(r)];case"pdf":return[2,this.exportPDF(r)];case"pdfdata":return[2,this.exportPDFData(r)]}return this.events.dispatch("exportfinished",{type:"exportfinished",format:e,options:r,target:this}),[2,""]})})}}),Object.defineProperty(s.prototype,"exportImage",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return r=this._getFormatOptions(e,t),[4,this.getCanvas(r)];case 1:return[2,i.sent().toDataURL(this.getContentType(e),r.quality||1)]}})})}}),Object.defineProperty(s.prototype,"exportCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(r){switch(r.label){case 0:return t=this._getFormatOptions("canvas",e),[4,this.getCanvas(t)];case 1:return[2,r.sent().toDataURL(this.getContentType("canvas"),t.quality||1)]}})})}}),Object.defineProperty(s.prototype,"getCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r,i,n,o,c,u,d,p,f,m,g,x,b,w,M;return(0,y.Jh)(this,function(C){return t=this._root._renderer.getCanvas(this._root._rootContainer._display,e),r=this.get("extraImages",[]),i=0,n=0,o=t.width,c=t.height,u=0,d=0,p=[],F.S6(r,function(v){var P;(P=v instanceof Ae.f?{source:v,position:"bottom"}:v).position=P.position||"bottom",P.marginTop=P.marginTop||0,P.marginRight=P.marginRight||0,P.marginBottom=P.marginBottom||0,P.marginLeft=P.marginLeft||0;var G=P.source._renderer.getCanvas(P.source._rootContainer._display,e),Y=G.width+P.marginLeft+P.marginRight,N=G.height+P.marginTop+P.marginBottom;"top"==P.position?(o=P.crop?c:Math.max(o,Y),n+=N):"right"==P.position?(c=P.crop?c:Math.max(c,N),u+=Y):"left"==P.position?(c=P.crop?c:Math.max(c,N),i+=Y):"bottom"===P.position&&(o=P.crop?c:Math.max(o,Y),d+=N),p.push({canvas:G,position:P.position,left:P.marginLeft,top:P.marginTop,width:Y,height:N})}),(f=this.getDisposableCanvas()).width=i+o+u,f.height=n+c+d,m=f.getContext("2d"),(g=this.get("backgroundColor",this.findBackgroundColor(this._root.dom)))&&(m.fillStyle=g.toCSS(),m.fillRect(0,0,f.width,f.height)),w=(x=i)+o,M=(b=n)+c,F.S6(p,function(v){"top"==v.position?m.drawImage(v.canvas,i+v.left,(b-=v.height)+v.top):"right"==v.position?(m.drawImage(v.canvas,w+v.left,n+v.top),w+=v.width):"left"==v.position?m.drawImage(v.canvas,(x-=v.width)+v.left,n+v.top):"bottom"===v.position&&(m.drawImage(v.canvas,i+v.left,M+v.top),M+=v.height)}),m.drawImage(t,i,n),[2,f]})})}}),Object.defineProperty(s.prototype,"exportJSON",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("json")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getJSON(e)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"getJSON",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r=this;return(0,y.Jh)(this,function(i){return t=this._getFormatOptions("json",e),[2,JSON.stringify(this.getData("json",e,t.renameFields),function(n,o){return S.Kn(o)&&Z.S6(o,function(c,u){o[c]=r.convertToSpecialFormat(c,u,t)}),o},t.indent)]})})}}),Object.defineProperty(s.prototype,"exportCSV",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("csv")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getCSV(e)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"getCSV",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r,i,n,o,c,u,d,p,f=this;return(0,y.Jh)(this,function(m){if(t=this._getFormatOptions("csv",e),r="",i="",n=this.getData("csv",t),o=this.getDataFields(n),t.pivot)c=this.get("dataFieldsOrder",[]),Z.JE(o,function(g,x){var b=[];t.addColumnNames&&b.push(x);for(var w=n.length,M=0;M<w;M++)b.push(f.convertToSpecialFormat(g,n[M][g],t,!0));r+=i+f.getCSVRow(b,t,void 0,!0),i="\n"},function(g,x){var b=c.indexOf(g),w=c.indexOf(x);return b>w?-1:b<w?1:0});else{for(u=n.length,d=0;d<u;d++)p=this.getCSVRow(n[d],t,o),t.reverse?r=p+i+r:r+=i+p,i="\n";t.addColumnNames&&(r=this.getCSVRow(o,t,void 0,!0)+i+r)}return[2,r]})})}}),Object.defineProperty(s.prototype,"getCSVRow",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){var n=this;void 0===i&&(i=!1);var o=t.separator||",",c=[];r||(r={},Z.S6(e,function(d,p){r[d]=p}));var u=this.get("dataFieldsOrder",[]);return Z.JE(r,function(d,p){var f=n.convertEmptyValue(d,e[d],t),m=i?f:n.convertToSpecialFormat(d,f,t);m=(m=""+m).replace(/"/g,'""'),(t.forceQuotes||m.search(new RegExp('"|\n|'+o,"g"))>=0)&&(m='"'+m+'"'),c.push(m)},function(d,p){var f=u.indexOf(d),m=u.indexOf(p);return f>m?1:f<m?-1:0}),c.join(o)}}),Object.defineProperty(s.prototype,"exportHTML",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("html")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getHTML(e)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"getHTML",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r,i,n,o,c,u,d=this;return(0,y.Jh)(this,function(p){if(t=this._getFormatOptions("html",e),r="<table>",t.tableClass&&(r='<table class="'+t.tableClass+'">'),i=this.getData("html",t),n=this.getDataFields(i),t.pivot)o=this.get("dataFieldsOrder",[]),r+="\n<tbody>",Z.JE(n,function(f,m){var g=[];t.addColumnNames&&g.push(m);for(var x=i.length,b=0;b<x;b++)g.push(d.convertToSpecialFormat(f,i[b][f],t,!0));r+="\n"+d.getHTMLRow(g,t,void 0,!0)},function(f,m){var g=o.indexOf(f),x=o.indexOf(m);return g>x?-1:g<x?1:0}),r+="\n</tbody>";else{for(t.addColumnNames&&(r+="\n<thead>\n"+this.getHTMLRow(n,t,void 0,!0,!0)+"\n</thead>"),r+="\n<tbody>",c=i.length,u=0;u<c;u++)r+="\n"+this.getHTMLRow(i[u],t,n);r+="\n</tbody>"}return[2,r+="\n</table>"]})})}}),Object.defineProperty(s.prototype,"getHTMLRow",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i,n){var o=this;void 0===i&&(i=!1),void 0===n&&(n=!1);var c="\t<tr>";t.rowClass&&(c='\t<tr class="'+t.rowClass+'">'),r||(r=e);var u=this.get("dataFieldsOrder",[]),d=n?"th":"td",p=!0;return Z.JE(r,function(f,m){var g=o.convertEmptyValue(f,e[f],t),x=i?g:o.convertToSpecialFormat(f,g,t);x=(x=""+x).replace(/[\u00A0-\u9999<>\&]/gim,function(w){return"&#"+w.charCodeAt(0)+";"});var b=d;t.pivot&&p&&(b="th"),c+=t.cellClass?"\n\t\t<"+b+' class="'+t.cellClass+'">'+x+"</"+b+">":"\n\t\t<"+b+">"+x+"</"+b+">",p=!1},function(f,m){var g=u.indexOf(f),x=u.indexOf(m);return g>x?1:g<x?-1:0}),c+="\n\t</tr>"}}),Object.defineProperty(s.prototype,"exportXLSX",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("xlsx")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getXLSX(e)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"getXLSX",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r,i,n,o,c,u,d,p,f,m,g=this;return(0,y.Jh)(this,function(x){switch(x.label){case 0:return t=this._getFormatOptions("xlsx",e),[4,this.getXLSXLib()];case 1:if(r=x.sent(),i={bookType:"xlsx",bookSST:!1,type:"base64"},n=this._normalizeExcelSheetName(this.get("title",this._t("Data"))),o={SheetNames:[n],Sheets:{}},c=[],u=this.getData("html",t),d=this.getDataFields(u),t.pivot)p=this.get("dataFieldsOrder",[]),Z.JE(d,function(b,w){var M=[];t.addColumnNames&&M.push(w);for(var C=u.length,v=0;v<C;v++)M.push(g.convertToSpecialFormat(b,u[v][b],t,!0));c.push(g.getXLSXRow(M,t,void 0,!0))},function(b,w){var M=p.indexOf(b),C=p.indexOf(w);return M>C?1:M<C?-1:0});else for(t.addColumnNames&&c.push(this.getXLSXRow(d,t,void 0,!0)),f=u.length,m=0;m<f;m++)c.push(this.getXLSXRow(u[m],t,d));return o.Sheets[n]=r.utils.aoa_to_sheet(c),this.events.dispatch("workbookready",{type:"workbookready",format:"xlsx",options:t,workbook:o,workbookOptions:i,xlsx:r,target:this}),[2,r.write(o,i)]}})})}}),Object.defineProperty(s.prototype,"_normalizeExcelSheetName",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(e=e.replace(/([:\\\/?*\[\]]+)/g," ")).length>30?e.substr(0,30)+"...":e}}),Object.defineProperty(s.prototype,"getXLSXRow",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){var n=this;void 0===i&&(i=!1);var o=[];r||(r=e);var c=this.get("dataFieldsOrder",[]);return Z.JE(r,function(u,d){var p=n.convertEmptyValue(u,e[u],t),f=i?p:n.convertToSpecialFormat(u,p,t,!0);o.push(f)},function(u,d){var p=c.indexOf(u),f=c.indexOf(d);return p>f?1:p<f?-1:0}),o}}),Object.defineProperty(s.prototype,"_xlsx",{enumerable:!1,configurable:!0,writable:!0,value:function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,h.e(4297).then(h.t.bind(h,59921,23))];case 1:return[2,e.sent()]}})})}}),Object.defineProperty(s.prototype,"getXLSXLib",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._xlsx()}}),Object.defineProperty(s.prototype,"exportPDF",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("pdf")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getPDF(e,!0)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"exportPDFData",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return t="data:"+this.getContentType("pdf")+";"+this.get("charset","utf-8")+",",r=encodeURIComponent,[4,this.getPDF(e,!1,!0)];case 1:return[2,t+r.apply(void 0,[i.sent()])]}})})}}),Object.defineProperty(s.prototype,"getPDF",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=!1),(0,y.mG)(this,void 0,void 0,function(){function i(C){var v={};v.normal=C.normal.path,w[C.normal.path]=C.normal.bytes,C.bold?(v.bold=C.bold.path,w[C.bold.path]=C.bold.bytes):v.bold=C.normal.path,C.italics?(v.italics=C.italics.path,w[C.italics.path]=C.italics.bytes):v.italics=C.normal.path,C.bolditalics?(v.bolditalics=C.bolditalics.path,w[C.bolditalics.path]=C.bolditalics.bytes):v.bolditalics=C.normal.path,b[C.name]=v}var n,o,c,u,d,p,f,m,g,x,b,w,M;return(0,y.Jh)(this,function(C){switch(C.label){case 0:return n=this._getFormatOptions("pdf",e),o=this._getFormatOptions("pdfdata",e),t?[4,this.exportImage(n.imageFormat||"png",n)]:[3,2];case 1:c=C.sent(),C.label=2;case 2:return[4,this.getPdfmake()];case 3:return u=C.sent(),d=[30,30,30,30],p={pageSize:n.pageSize||"A4",pageOrientation:n.pageOrientation||"portrait",pageMargins:n.pageMargins||d,defaultStyle:{font:n.font?n.font.name:void 0},content:[]},f=this.get("title"),m=0,f&&(p.content.push({text:f,fontSize:n.fontSize||14,bold:!0,margin:[0,0,0,15]}),m+=50),n.addURL&&(p.content.push({text:this._t("Saved from")+": "+document.location.href,fontSize:n.fontSize,margin:[0,0,0,15]}),m+=50),t&&c&&p.content.push({image:c,alignment:n.align||"left",fit:this.getPageSizeFit(p.pageSize,p.pageMargins,m)}),(r||n.includeData)&&this.hasData()?(x=(g=p.content).push,M={},[4,this.getPDFData(o)]):[3,5];case 4:x.apply(g,[(M.table=C.sent(),M.fontSize=n.fontSize||14,M)]),C.label=5;case 5:return b=null,w=null,n.font&&(b={},w={},i(n.font),n.extraFonts&&F.S6(n.extraFonts,i)),this.events.dispatch("pdfdocready",{type:"pdfdocready",format:"pdf",options:n,doc:p,target:this}),[2,new Promise(function(v,P){u.createPdf(p,null,b,w).getBase64(function(G){v(G)})})]}})})}}),Object.defineProperty(s.prototype,"getPDFData",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,r,i,n,o,c,u,d=this;return(0,y.Jh)(this,function(p){if(t=this._getFormatOptions("pdfdata",e),r={body:[]},i=this.getData("html",t),n=this.getDataFields(i),t.pivot)o=this.get("dataFieldsOrder",[]),Z.JE(n,function(f,m){var g=[];t.addColumnNames&&g.push(m);for(var x=i.length,b=0;b<x;b++)g.push(d.convertToSpecialFormat(f,i[b][f],t,!0));r.body.push(d.getPDFDataRow(g,t,void 0,!0))},function(f,m){var g=o.indexOf(f),x=o.indexOf(m);return g>x?1:g<x?-1:0});else for(t.addColumnNames&&(r.body.push(this.getPDFDataRow(n,t,void 0,!0)),r.headerRows=1),c=i.length,u=0;u<c;u++)r.body.push(this.getPDFDataRow(i[u],t,n));return[2,r]})})}}),Object.defineProperty(s.prototype,"getPDFDataRow",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){var n=this;void 0===i&&(i=!1);var o=[];r||(r=e);var c=this.get("dataFieldsOrder",[]);return Z.JE(r,function(u,d){var p=n.convertEmptyValue(u,e[u],t),f=i?p:n.convertToSpecialFormat(u,p,t);o.push(f=""+f)},function(u,d){var p=c.indexOf(u),f=c.indexOf(d);return p>f?1:p<f?-1:0}),o}}),Object.defineProperty(s.prototype,"getPdfmake",{enumerable:!1,configurable:!0,writable:!0,value:function(){return void 0===fe&&(fe=function vt(){return(0,y.mG)(this,void 0,void 0,function(){var l,s,e,t;return(0,y.Jh)(this,function(r){switch(r.label){case 0:return[4,Promise.all([Promise.all([h.e(7757),h.e(643)]).then(h.t.bind(h,54641,23)),Promise.all([h.e(7757),h.e(643)]).then(h.bind(h,59473))])];case 1:return l=r.sent(),s=l[0],e=l[1],(t=window).pdfMake=t.pdfMake||{},t.pdfMake.vfs=e.default,s.vfs=e.default,[2,s]}})})}()),fe}}),Object.defineProperty(s.prototype,"getPageSizeFit",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){void 0===r&&(r=0);var i=[0,0,0,0];S.hj(t)?i=[t,t,t,t]:2==t.length?i=[t[0],t[1],t[0],t[1]]:4==t.length&&(i=t);var o={"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]}[e];return o[0]-=i[0]+i[2],o[1]-=i[1]+i[3]+r,o}}),Object.defineProperty(s.prototype,"hasData",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.get("dataSource");return!(!S.kJ(e)||!e.length)}}),Object.defineProperty(s.prototype,"getData",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var i=this;void 0===r&&(r=!1);var n=this._getFormatOptions(e,t),o=this.get("dataSource",[]),c=o,u=this.get("dataFields");u&&S.kJ(o)&&(c=[],F.S6(o,function(p){if(S.Kn(p)){var f={};Z.S6(u,function(m,g){null!=u[m]&&(f[r?g:m]=i.convertToSpecialFormat(m,p[m],n))}),c.push(f)}}));var d={type:"dataprocessed",format:e,options:n,data:c,target:this};return this.events.dispatch("dataprocessed",d),d.data}}),Object.defineProperty(s.prototype,"getDataFields",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.get("dataFields");return t||(t={},S.kJ(e)&&e.length&&F.S6(e,function(r){Z.S6(r,function(i,n){null==t[i]&&(t[i]=i)})})),t}}),Object.defineProperty(s.prototype,"convertEmptyValue",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){return null!=t?t:r.emptyAs}}),Object.defineProperty(s.prototype,"convertToSpecialFormat",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r,i){if("number"==typeof t)if(this.isDateField(e))t=new Date(t);else{if(this.isNumericField(e)&&this.get("numberFormat"))return this._root.numberFormatter.format(t,this.get("numberFormat"));if(this.isDurationField(e))return this._root.durationFormatter.format(t,this.get("durationFormat"),this.get("durationUnit"))}return t instanceof Date&&(r.useTimestamps?t=t.getTime():r.useLocale?i||(t=t.toLocaleString()):t=this._root.dateFormatter.format(t,this.get("dateFormat"))),t}}),Object.defineProperty(s.prototype,"isDateField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return-1!==this.get("dateFields").indexOf(e)}}),Object.defineProperty(s.prototype,"isNumericField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return-1!==this.get("numericFields").indexOf(e)}}),Object.defineProperty(s.prototype,"isDurationField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return-1!==this.get("durationFields").indexOf(e)}}),Object.defineProperty(s.prototype,"getContentType",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t="";switch(e){case"png":t="image/"+e;break;case"jpg":t="image/jpeg";break;case"csv":t="text/csv";break;case"json":t="application/json";break;case"html":t="text/html";break;case"pdf":case"pdfdata":t="application/pdf";break;case"xlsx":t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;default:t="application/octet-stream"}return t}}),Object.defineProperty(s.prototype,"getDisposableCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="-10000px",document.body.appendChild(e),e}}),Object.defineProperty(s.prototype,"disposeCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(e){document.body.removeChild(e)}}),Object.defineProperty(s.prototype,"findBackgroundColor",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=1,r=getComputedStyle(e,"background-color").getPropertyValue("background-color");if((r.match(/[^,]*,[^,]*,[^,]*,[ ]?0/)||"transparent"==r)&&(t=0),0==t){var i=e.parentElement;return i?this.findBackgroundColor(i):B.Il.fromHex(16777215)}return B.Il.fromCSS(r)}}),Object.defineProperty(s.prototype,"streamFile",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){if(void 0===r&&(r=!1),this.blobDownloadSupport()){var i=document.createElement("a");i.download=t,document.body.appendChild(i);var n=e.split(";"),o=n.shift().replace(/data:/,"");if(e=decodeURIComponent(n.join(";").replace(/^[^,]*,/,"")),-1!=["image/svg+xml","application/json","text/csv","text/html"].indexOf(o)){r&&(e="\ufeff"+e);var u=new Blob([e],{type:o}),d=window.URL.createObjectURL(u);return i.href=d,i.download=t,i.click(),setTimeout(function(){document.body.removeChild(i),window.URL.revokeObjectURL(d)},100),!0}try{e=atob(e)}catch(w){return!1}for(var p=new Array(e.length),f=0;f<e.length;++f){var m=e.charCodeAt(f);p[f]=m}r&&(p=[239,187,191].concat(p));var g=new Blob([new Uint8Array(p)],{type:o}),x=window.URL.createObjectURL(g);i.href=x,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout(function(){window.URL.revokeObjectURL(x)},100)}else if(this.linkDownloadSupport()){var b=document.createElement("a");b.download=t,b.href=e,document.body.appendChild(b),b.click(),document.body.removeChild(b)}else window.location.href=e;return!0}}),Object.defineProperty(s.prototype,"downloadSupport",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.linkDownloadSupport()}}),Object.defineProperty(s.prototype,"linkDownloadSupport",{enumerable:!1,configurable:!0,writable:!0,value:function(){return void 0!==document.createElement("a").download}}),Object.defineProperty(s.prototype,"blobDownloadSupport",{enumerable:!1,configurable:!0,writable:!0,value:function(){return null!=window.Blob}}),Object.defineProperty(s.prototype,"initiatePrint",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var i=this._getFormatOptions("print",t);"css"==i.printMethod?this._printViaCSS(e,i,r):this._printViaIframe(e,i,r)}}),Object.defineProperty(s.prototype,"_printViaCSS",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var u,n=this._getFormatOptions("print",t).delay||500,o=document.documentElement.scrollTop||document.body.scrollTop,c=new $.u0($.Ay(this._root.dom),"body > *",{display:"none",position:"fixed",visibility:"hidden",opacity:"0",clipPath:"polygon(0px 0px,0px 0px,0px 0px,0px 0px);"},this._root.nonce);r&&document&&document.title&&(u=document.title,document.title=r);var d=new Image;d.src=e,d.style.maxWidth="100%",d.style.display="block",d.style.position="relative",d.style.visibility="visible",d.style.opacity="1",d.style.clipPath="none",document.body.appendChild(d),this.setTimeout(function(){window.print()},50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&n<1e3?n=1e3:n<100&&(n=100),this.setTimeout(function(){document.body.removeChild(d),c.dispose(),u&&(document.title=document.title),document.documentElement.scrollTop=document.body.scrollTop=o},n||500)}}),Object.defineProperty(s.prototype,"_printViaIframe",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){var n=this._getFormatOptions("print",t).delay||500,o=document.createElement("iframe");o.style.visibility="hidden",document.body.appendChild(o),o.contentWindow.document.open(),o.contentWindow.document.close();var c=new Image;c.src=e,c.style.maxWidth="100%",c.style.height="auto",r&&(o.contentWindow.document.title=r),o.contentWindow.document.body.appendChild(c),o.load=function(){o.contentWindow.document.body.appendChild(c)},this.setTimeout(function(){try{o.contentWindow.document.execCommand("print",!1,null)||o.contentWindow.print()}catch(d){o.contentWindow.print()}},n||50),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&n<1e3?n=1e3:n<100&&(n=100),this.setTimeout(function(){document.body.removeChild(o)},n+50||100)}}),Object.defineProperty(s.prototype,"supportedFormats",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=[],r=this.hasData(),i=this.downloadSupport();return F.S6(["png","jpg","canvas","pdf","xlsx","csv","json","html","pdfdata","print"],function(n){!0!==e._getFormatOptions(n).disabled&&(-1==["xlsx","csv","json","html","pdfdata"].indexOf(n)||r&&i)&&t.push(n)}),t}}),Object.defineProperty(s.prototype,"supportedExportTypes",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=["image","print"];return this.downloadSupport()&&this.hasData()&&e.push("data"),e}}),Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Exporting"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ae.JH.classNames.concat([s.className])}),s}(ae.JH),pe=h(40520),ze=h(98545);let Ee=(()=>{class l{constructor(e,t){this.http=e,this.tokenStorage=t}getHeaders(){var e=new pe.WM,t=this.tokenStorage.getToken();return e.set("token",t||"{}")}getReport(e){var t=this.getHeaders();const r=(new pe.LE).appendAll(e);return this.http.get(ze._.settings.apiServer.API_URL_BASE+ze._.settings.apiServer.REPORTS,{params:r,headers:t})}}return l.\u0275fac=function(e){return new(e||l)(a.LFG(pe.eN),a.LFG(le.i))},l.\u0275prov=a.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var xt=h(57261);function Ct(l,s){if(1&l&&(a.TgZ(0,"th",23),a._uU(1),a.qZA()),2&l){const e=a.oxw(2).$implicit;a.xp6(1),a.hij(" ",e.name,"")}}function wt(l,s){if(1&l&&(a.TgZ(0,"td",24),a._uU(1),a.qZA()),2&l){const e=s.$implicit,t=a.oxw(2).$implicit,r=a.oxw();a.xp6(1),a.Oqu(r.getLabel(t.name,e[t.property]))}}function Pt(l,s){1&l&&a._UZ(0,"td",25)}function Mt(l,s){if(1&l&&(a.ynx(0,19),a.YNc(1,Ct,2,1,"th",20),a.YNc(2,wt,2,1,"td",21),a.YNc(3,Pt,1,0,"td",22),a.BQk()),2&l){const e=a.oxw().$implicit;a.Q6J("matColumnDef",e.property)}}function Ot(l,s){if(1&l&&(a.ynx(0),a.YNc(1,Mt,4,1,"ng-container",18),a.BQk()),2&l){const e=s.$implicit;a.xp6(1),a.Q6J("ngIf",e.isModelProperty&&e.visible)}}function Tt(l,s){1&l&&a._UZ(0,"th",26)}function _t(l,s){if(1&l&&(a.TgZ(0,"td",27),a.TgZ(1,"button",28),a.NdJ("click",function(t){return t.stopPropagation()}),a.TgZ(2,"mat-icon"),a._uU(3,"more_horiz"),a.qZA(),a.qZA(),a._UZ(4,"mat-menu",29,30),a.qZA()),2&l){const e=a.MAs(5);a.xp6(1),a.Q6J("matMenuTriggerFor",e)}}function Ft(l,s){1&l&&a._UZ(0,"tr",31)}function St(l,s){if(1&l){const e=a.EpF();a.TgZ(0,"tr",32),a.NdJ("click",function(){const i=a.CHM(e).$implicit;return a.oxw().detailsStation(i)}),a.qZA()}}function Dt(l,s){1&l&&a._UZ(0,"tr",33)}let Ue=(()=>{class l{constructor(e,t,r,i,n,o,c,u,d,p,f){this.data=e,this.platformId=t,this.dialog=r,this.zone=i,this._excelerService=n,this._tokenStorageService=o,this._transactionsService=c,this._generalSettingsService=u,this._filesUploaderService=d,this._reportsService=p,this.snackbar=f,this.subject$=new xe.t(1),this.data$=this.subject$.asObservable(),this.bloqueable=!0,this.columns=[{name:"Estaci\xf3n",property:"station_name",visible:!0,isModelProperty:!0,displayFn:!0},{name:"C\xf3digo",property:"site_code",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Traspasos",property:"refills",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Despachos",property:"fuel_volume",visible:!0,isModelProperty:!0,displayFn:!1},{name:"Diferencia",property:"difference",visible:!0,isModelProperty:!0,displayFn:!1}],this.pageSize=10}getLabel(e,t){if(null!=e)return t}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}getData(){this.dataSource=new O.by(this.data.report.totals),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnInit(){this._generalSettingsService.getAll().subscribe(e=>{this.generalSettings=e,this._filesUploaderService.getFileBase64(e.logo_filename).subscribe(t=>{this.generalLogoString=t.file},t=>{console.log(t)})},e=>{console.log(e)}),this.dataSource=new O.by,this._transactionsService.getServerTimestamp().subscribe(e=>{this.datetime=e.message}),this.getData(),this.data$.pipe((0,Ce.h)(e=>!!e)).subscribe(e=>{this.dataSource.data=e})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort;let e=Ae.f.new("chartdiv");e.setThemes([bt.Z.new(e)]);let t=e.container.children.push(ct.z.new(e,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX",layout:e.verticalLayout})),r=this.data.report.totals,i=t.xAxes.push(pt.new(e,{categoryField:"station_name",renderer:ht.n.new(e,{minGridDistance:30,scale:.5}),tooltip:te.u.new(e,{})}));i.get("renderer").labels.template.setAll({paddingTop:20,fontSize:10,rotation:-80,centerX:40,centerY:20}),i.data.setAll(r);let n=t.yAxes.push(Re.m.new(e,{renderer:Ze.j.new(e,{})}));var o=Ze.j.new(e,{opposite:!0}),c=t.yAxes.push(Re.m.new(e,{renderer:o,min:-5e4,max:5e4,strictMinMax:!0}));o.grid.template.set("forceHidden",!0),c.set("numberFormat","#,###.#0");let u=t.series.push(Ie.new(e,{name:"Recargas",xAxis:i,yAxis:n,valueYField:"refills",categoryXField:"station_name",stroke:B.$_("#96BC5A"),tooltip:te.u.new(e,{pointerOrientation:"horizontal",labelText:"{name} en {categoryX}: {valueY} {info}"})}));u.columns.template.setAll({tooltipY:V.aQ(10),templateField:"columnSettings",fillOpacity:1,strokeWidth:1,cornerRadiusTL:5,cornerRadiusTR:5,fill:B.$_("#96BC5A")}),u.data.setAll(r);let d=t.series.push(Ie.new(e,{name:"Despachos",xAxis:i,yAxis:n,valueYField:"fuel_volume",categoryXField:"station_name",stroke:B.$_("#F4EF38"),tooltip:te.u.new(e,{pointerOrientation:"horizontal",labelText:"{name} en {categoryX}: {valueY} {info}"})}));d.columns.template.setAll({tooltipY:V.aQ(10),templateField:"columnSettings",fillOpacity:.9,strokeWidth:0,cornerRadiusTL:5,cornerRadiusTR:5,fill:B.$_("#F4EF38")}),d.data.setAll(r);let p=t.series.push(mt.e.new(e,{name:"Diferencias",xAxis:i,yAxis:c,valueYField:"difference",categoryXField:"station_name",stroke:B.$_("#CF1104"),tooltip:te.u.new(e,{pointerOrientation:"horizontal",labelText:"{name} en {categoryX}: {valueY} {info}"})}));p.strokes.template.setAll({strokeWidth:3,templateField:"strokeSettings"}),p.data.setAll(r),p.bullets.push(function(){return st.new(e,{sprite:lt.new(e,{strokeWidth:3,stroke:p.get("stroke"),radius:5,fill:e.interfaceColors.get("background")})})}),t.set("cursor",gt.L.new(e,{})),t.children.push(ut.D.new(e,{centerX:V.CI,x:V.CI})).data.setAll(t.series.values),this.exporting=yt.new(e,{menu:null}),t.appear(1e3,100),u.appear(),this.root=e}onFilterChange(e){!this.dataSource||(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}getTotals(e){return(Math.round(100*this.data.transactions.consumos.map(t=>t[e]).reduce((t,r)=>t+r,0))/100).toFixed(2)}round(e){return(Math.round(100*e)/100).toFixed(2)}browserOnly(e){(0,E.NF)(this.platformId)&&this.zone.runOutsideAngular(()=>{e()})}pdfMe(){this.exporting.exportImage("png").then(e=>{this.graphImage=e}).catch(e=>console.error(e)).finally(()=>{var e=[],t=[],r=[],i=[];this.columns.forEach(u=>{u.visible&&(t.push({title:u.name,dataKey:u.property}),r.push(u.property),i.push(u.name))});var n=0;this.dataSource.filteredData.forEach(u=>{e[n]={},r.forEach(d=>{e[n][d]=""+u[d]}),n++});var o=new we.jsPDF({orientation:"portrait",unit:"mm",format:"letter"});o.setFillColor("#152235"),o.roundedRect(10,15,195,30,2,2,"DF"),o.setFontSize(11),o.setTextColor("white"),o.text("Reporte mensual de estaciones m\xf3viles",15,38),o.setFontSize(9),o.text("Correspondiente a "+this.data.filter.month_name+" del "+this.data.filter.year,15,43),o.addImage("./../../../../../assets/img/maacsa.png","PNG",15,20,62,10.3),o.addImage(this.generalLogoString,"PNG",161.1,20,38.9,13.22),o.setFontSize(8),o.text("Generado por "+this._tokenStorageService.getUser().user+"("+this._tokenStorageService.getUser().name+") "+this.datetime,120,43),Pe()(o,{body:e,columns:t,startY:50,headStyles:{fontStyle:"bold",fillColor:"#152235",halign:"center"}});let c=o.lastAutoTable.finalY;c+=10,o.addImage(this.graphImage,"PNG",15,c,185,92.5),o.output("dataurlnewwindow")})}orderDataset(e,t){var r=[],i=[],n=[],o=[];t.forEach(u=>{r.push({title:u,dataKey:u}),i.push(u),n.push(u)});var c=0;return e.forEach(u=>{o[c]={},i.forEach(d=>{o[c][d]=u[d]}),c++}),o}excelMe(){return(0,y.mG)(this,void 0,void 0,function*(){var e=this.orderDataset(this.data.report.refills,this.data.report.hrefills),t=this.orderDataset(this.data.report.transactions,this.data.report.htransactions),r=this.orderDataset(this.data.report.totals,this.data.report.htotals);this.exporting.exportImage("png").then(i=>{this.graphImage=i}).catch(i=>console.error(i)).finally(()=>{var i=[];this.data.report.hrefills.forEach(function(u,d){"site_code"==u?(this[d]="C\xf3digo de estaci\xf3n",i.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"station_name"==u?(this[d]="Dispositivo",i.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"totales"==u?(this[d]="Total",i.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):i.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})},this.data.report.hrefills);var n=[];this.data.report.htransactions.forEach(function(u,d){"site_code"==u?(this[d]="C\xf3digo de estaci\xf3n",n.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"station_name"==u?(this[d]="Estaci\xf3n",n.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"totales"==u?(this[d]="Total",n.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}}})):n.push({width:14,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})},this.data.report.htransactions);var o=[];this.data.report.htotals.forEach(function(u,d){"site_code"==u?(this[d]="C\xf3digo de estaci\xf3n",o.push({width:14,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"station_name"==u?(this[d]="Estaci\xf3n",o.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"refills"==u?(this[d]="Recargas",o.push({width:18,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"fuel_volume"==u?(this[d]="Consumos",o.push({width:18,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):"difference"==u?(this[d]="Diferencia",o.push({width:18,style:{numFmt:"#,##0.00;[Red]-#,##0.00"},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})):o.push({width:18,style:{numFmt:""},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}}})},this.data.report.htotals),this._excelerService.excelIt([{worksheet:"conciliacion",datas:[{title:{vector:["Recargas de pipas en estaci\xf3n fija"],font:{name:"Verdana",size:14,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},header:{filter:!1,vector:this.data.report.hrefills,font:{name:"Verdana",size:10,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"e6e5e5"}}},body:{matrix:e,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:i}},{title:{vector:["Despachos de pipas a veh\xedculos en sitio"],font:{name:"Verdana",size:14,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},header:{filter:!1,vector:this.data.report.htransactions,font:{name:"Verdana",size:10,bold:!0,color:{argb:"ffffff"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"e6e5e5"}}},body:{matrix:t,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"dae0f1"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:n}},{title:{vector:["Conciliaci\xf3n de recargas vs despachos"],font:{name:"Verdana",size:14,bold:!0,color:{argb:"000000"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},header:{filter:!1,vector:this.data.report.htotals,font:{name:"Verdana",size:10,bold:!0,color:{argb:"ffffff"}},border:{top:{style:"double",color:{argb:"000000"}},left:{style:"double",color:{argb:"000000"}},bottom:{style:"double",color:{argb:"000000"}},right:{style:"double",color:{argb:"000000"}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"e6e5e5"}}},body:{matrix:r,fill:{odd_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"dae0f1"}},even_rows:{type:"pattern",pattern:"solid",fgColor:{argb:"ffffff"}}},font:{name:"Verdana",size:10,bold:!1,color:{argb:"000000"}},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}}},columns_types:o,graph_image:{filename:this.graphImage,extension:"png",width:800,height:400}}}]}],"marimbas_"+this.data.filter.month+"_"+this.data.filter.year)})})}ngOnDestroy(){this.browserOnly(()=>{this.root&&this.root.dispose()})}detailsStation(e){let t={type:"detail_marimba",station:e.site_code,station_name:e.station_name,month:this.data.filter.month,year:this.data.filter.year,days:this.data.filter.days,marimbas_schedule_time:this.data.filter.marimbas_schedule_time,month_name:this.data.filter.month_name};var r={filter:t,report:null};this._reportsService.getReport(t).subscribe(i=>{r.report=i,this.dialog.open(De,{data:r}).afterClosed().subscribe(n=>{n&&console.log("Cerrada la tabla reporte "+n)})})}}return l.\u0275fac=function(e){return new(e||l)(a.Y36(H.WI),a.Y36(a.Lbi),a.Y36(H.uw),a.Y36(a.R0b),a.Y36(Me.N),a.Y36(le.i),a.Y36(Oe.v),a.Y36(ue.b),a.Y36(Te.a),a.Y36(Ee),a.Y36(xt.ux))},l.\u0275cmp=a.Xpm({type:l,selectors:[["marimbas-modal-table"]],viewQuery:function(e,t){if(1&e&&(a.Gf(q.NW,7),a.Gf(k.YE,7)),2&e){let r;a.iGM(r=a.CRH())&&(t.paginator=r.first),a.iGM(r=a.CRH())&&(t.sort=r.first)}},inputs:{columns:"columns"},decls:24,vars:11,consts:[["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","end",1,"buttons-set"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["svgIcon","excel"],["svgIcon","pdf"],[1,"page-modal"],["name","Totales",3,"columns","filterChange"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class"," clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[1,"paginator",3,"pageSize"],["id","chartdiv",2,"width","800px","height","400px","overflow","scroll"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"],["mat-footer-row",""]],template:function(e,t){1&e&&(a.TgZ(0,"fury-page-layout-header"),a.TgZ(1,"div",0),a.TgZ(2,"div",1),a.TgZ(3,"fury-title"),a._uU(4),a.qZA(),a.TgZ(5,"fury-title"),a._uU(6),a.qZA(),a.qZA(),a.TgZ(7,"div",2),a.TgZ(8,"button",3),a.NdJ("click",function(){return t.excelMe()}),a._UZ(9,"mat-icon",4),a.qZA(),a.TgZ(10,"button",3),a.NdJ("click",function(){return t.pdfMe()}),a._UZ(11,"mat-icon",5),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"fury-page-layout-content",6),a.TgZ(13,"fury-list",7),a.NdJ("filterChange",function(i){return t.onFilterChange(i)}),a.TgZ(14,"table",8),a.YNc(15,Ot,2,1,"ng-container",9),a.ynx(16,10),a.YNc(17,Tt,1,0,"th",11),a.YNc(18,_t,6,1,"td",12),a.BQk(),a.YNc(19,Ft,1,0,"tr",13),a.YNc(20,St,1,0,"tr",14),a.YNc(21,Dt,1,0,"tr",15),a.qZA(),a._UZ(22,"mat-paginator",16),a.qZA(),a._UZ(23,"div",17),a.qZA()),2&e&&(a.xp6(4),a.AsE("Periodo: ",t.data.filter.month,"/",t.data.filter.year,""),a.xp6(2),a.hij("Estaciones: ",t.data.filter.stations_names,""),a.xp6(6),a.Q6J("@fadeInUp",void 0),a.xp6(1),a.Q6J("columns",t.columns),a.xp6(1),a.Q6J("dataSource",t.dataSource),a.xp6(1),a.Q6J("ngForOf",t.columns),a.xp6(4),a.Q6J("matHeaderRowDef",t.visibleColumns),a.xp6(1),a.Q6J("matRowDefColumns",t.visibleColumns),a.xp6(1),a.Q6J("matFooterRowDef",t.visibleColumns),a.xp6(1),a.Q6J("pageSize",t.pageSize))},directives:[ce.U,U.xw,U.SQ,_e.M,U.Wh,W.lW,K.Hw,Fe.d,Se.n,O.BZ,k.YE,E.sg,O.w1,O.fO,O.Dz,O.as,O.nj,O.Ke,q.NW,E.O5,O.mD,O.ge,k.nU,O.ev,O.yh,ee.p6,ee.VK,O.XQ,O.Gk,O.Q2],styles:[".clickable[_ngcontent-%COMP%]{cursor:pointer}.title[_ngcontent-%COMP%]{color:#000}.page-modal[_ngcontent-%COMP%]{overflow:scroll;max-height:600px;margin:24px;padding:2px;box-shadow:0 3px 3px -2px #0003,0 3px 4px #00000024,0 1px 8px #0000001f}.page-modal[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.page-modal[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:5px}.page-modal[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.page-modal[_ngcontent-%COMP%]   .information-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:100%}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]{border-radius:10px;padding:10px;border:solid gray;border-top-width:thin;border-right-width:thin;border-bottom-width:thin;border-left-width:thin;width:410px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px;width:245px}.page-modal[_ngcontent-%COMP%]   .validation-block[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:0;width:245px}.page-modal[_ngcontent-%COMP%]   .text-icon[_ngcontent-%COMP%]{max-width:49.5%}.page-modal[_ngcontent-%COMP%]   .indented-right[_ngcontent-%COMP%]{margin-left:40px}.page-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}.numerical[_ngcontent-%COMP%]{text-align:end}.fury-title[_ngcontent-%COMP%]{color:#f5f5f5}.buttons-set[_ngcontent-%COMP%]{margin-left:60px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]{text-align:center;width:70px;height:70px}.buttons-set[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:40px;height:40px}"],data:{animation:[ne.M,se.X]}}),l})();var At=h(52190),jt=h(39762),Rt=h(38932),Xe=h(67322),Zt=h(74107),Nt=h(90508);function Lt(l,s){if(1&l&&(a.TgZ(0,"mat-option",15),a._uU(1),a.qZA()),2&l){const e=s.$implicit;a.Q6J("value",e.site_code),a.xp6(1),a.Oqu(e.station_name)}}function Yt(l,s){if(1&l&&(a.TgZ(0,"mat-option",15),a._uU(1),a.qZA()),2&l){const e=s.$implicit;a.Q6J("value",e.id),a.xp6(1),a.Oqu(e.name)}}function Gt(l,s){if(1&l&&(a.TgZ(0,"mat-option",15),a._uU(1),a.qZA()),2&l){const e=s.$implicit;a.Q6J("value",e),a.xp6(1),a.Oqu(e)}}function Jt(l,s){if(1&l){const e=a.EpF();a.TgZ(0,"form",5),a.TgZ(1,"div",6),a.TgZ(2,"div",7),a.TgZ(3,"mat-form-field",8),a.TgZ(4,"mat-label"),a._uU(5,"Estaci\xf3n:"),a.qZA(),a.TgZ(6,"mat-select",9),a.YNc(7,Lt,2,2,"mat-option",10),a.qZA(),a.qZA(),a.TgZ(8,"mat-form-field",8),a.TgZ(9,"mat-label"),a._uU(10,"Mes:"),a.qZA(),a.TgZ(11,"mat-select",11),a.YNc(12,Yt,2,2,"mat-option",10),a.qZA(),a.qZA(),a.TgZ(13,"mat-form-field",8),a.TgZ(14,"mat-label"),a._uU(15,"A\xf1o:"),a.qZA(),a.TgZ(16,"mat-select",12),a.YNc(17,Gt,2,2,"mat-option",10),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(18,"div",13),a.TgZ(19,"button",14),a.NdJ("click",function(){return a.CHM(e),a.oxw().submit()}),a._uU(20,"CONSULTAR"),a.qZA(),a.qZA(),a.qZA()}if(2&l){const e=a.oxw();a.Q6J("formGroup",e.filterFormGroup),a.xp6(7),a.Q6J("ngForOf",e.stations),a.xp6(5),a.Q6J("ngForOf",e.months),a.xp6(5),a.Q6J("ngForOf",e.years),a.xp6(2),a.Q6J("disabled",e.filterFormGroup.invalid)}}const It=function(){return["Tables"]},zt=[{path:"",component:(()=>{class l{constructor(e,t,r,i){this.dialog=e,this._stationsService=t,this._reportsService=r,this._generalSettingsService=i,this.report=[],this.stations=[],this.filter={},this.configuration={},this.months=[{id:1,name:"Enero",days:31},{id:2,name:"Febrero",days:28},{id:3,name:"Marzo",days:31},{id:4,name:"Abril",days:30},{id:5,name:"Mayo",days:31},{id:6,name:"Junio",days:30},{id:7,name:"Julio",days:31},{id:8,name:"Agosto",days:31},{id:9,name:"Septiembre",days:30},{id:10,name:"Octubre",days:31},{id:11,name:"Noviembre",days:30},{id:12,name:"Diciembre",days:31}],this.years=[],this.today=new Date,this.filterFormGroup=new _.cw({month:new _.NI("",[_.kI.required]),year:new _.NI("",[_.kI.required,_.kI.minLength(4),_.kI.maxLength(4)]),stations:new _.NI([])})}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){this.fillYears(),this.stations=yield this.getStations(),this.filterFormGroup.controls.month.setValue(this.today.getMonth()+1),this.filterFormGroup.controls.year.setValue(this.today.getFullYear())})}submit(){return(0,y.mG)(this,void 0,void 0,function*(){this.configuration=yield this.getConfiguration();var e=[],t=this;this.filterFormGroup.controls.stations.value.forEach(i=>{let n=t.stations.find(o=>o.site_code==i).station_name;e.push(n)}),this.filter.type="marimbas",this.filter.stations=this.filterFormGroup.controls.stations.value.toString(),this.filter.month=this.filterFormGroup.controls.month.value,this.filter.year=this.filterFormGroup.controls.year.value,this.filter.days=2===this.filter.month&&this.leapYear(this.filter.year)?29:this.months.find(i=>i.id==this.filter.month).days,this.filter.marimbas_schedule_time=this.configuration.marimbas_schedule_time,this.filter.month_name=this.months.find(i=>i.id===this.filter.month).name,this.report=yield this.getReport(),this.filter.stations_names=e.length?e.toString():"Todas",this.dialog.open(Ue,{data:{filter:this.filter,report:this.report}}).afterClosed().subscribe(i=>{i&&console.log("Cerrada la tabla reporte"+i)})})}getReport(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this._reportsService.getReport(this.filter).toPromise()})}getStations(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this._stationsService.getMarimbas().toPromise()})}getConfiguration(){return(0,y.mG)(this,void 0,void 0,function*(){return yield this._generalSettingsService.getAll().toPromise()})}fillYears(){for(var e=this.today.getFullYear()-100,t=e+150;e<=t;e++)this.years.push(e)}leapYear(e){return e%4==0&&e%100!=0||e%400==0}onChangeFleet(){}}return l.\u0275fac=function(e){return new(e||l)(a.Y36(H.uw),a.Y36(At.w),a.Y36(Ee),a.Y36(ue.b))},l.\u0275cmp=a.Xpm({type:l,selectors:[["marimbas-report"]],decls:7,vars:5,consts:[["mode","card"],["current","Reporte de transacciones con marimbas",3,"crumbs"],[1,"card"],[1,"heading"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["fxLayout","column",1,"content"],["fxLayout","row","fxLayoutGap","8px",1,"content"],["appearance","outline","fxFlex","auto",1,"field"],["formControlName","stations","multiple",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","month"],["formControlName","year"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-raised-button","",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(a.TgZ(0,"fury-page-layout",0),a.TgZ(1,"fury-page-layout-header"),a._UZ(2,"fury-breadcrumbs",1),a.qZA(),a.TgZ(3,"div",2),a.TgZ(4,"div",3),a._uU(5,"Reporte mensual de transacciones con marimbas:"),a.qZA(),a.YNc(6,Jt,21,5,"form",4),a.qZA(),a.qZA()),2&e&&(a.xp6(2),a.Q6J("@fadeInRight",void 0)("crumbs",a.DdM(4,It)),a.xp6(1),a.Q6J("@fadeInUp",void 0),a.xp6(3),a.Q6J("ngIf",t.filterFormGroup))},directives:[jt.N,ce.U,Rt.n,E.O5,_._Y,_.JL,_.sg,U.xw,U.SQ,Xe.KE,U.yH,Xe.hX,Zt.gD,_.JJ,_.u,E.sg,U.Wh,W.lW,Nt.ey],styles:[".title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:scroll;padding:20px;box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:3px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{max-width:33%;min-width:33%}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.readonly-wrapper[_ngcontent-%COMP%]{cursor:not-allowed!important}.readonly-wrapper[_ngcontent-%COMP%]   .readonly-block[_ngcontent-%COMP%]{pointer-events:none!important}"],data:{animation:[ne.M,se.X]}}),l})()}];let Et=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[Q.Bz.forChild(zt)],Q.Bz]}),l})();var Ve=h(61620),Be=h(77531);const Ut=[{path:"",component:Ue}];let Xt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[Q.Bz.forChild(Ut)],Q.Bz]}),l})();const Vt=[{path:"",component:De}];let Bt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[Q.Bz.forChild(Vt)],Q.Bz]}),l})();var Qe=h(74519);let Qt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[E.ez,Ve.o9,ie.q,W.ot,H.Is,K.Ps,Be.c,Bt,oe.Z,re.p,Qe.O]]}),l})(),Ht=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[E.ez,Ve.o9,_.u5,_.UX,ie.q,W.ot,H.Is,K.Ps,Be.c,Xt,Qt,oe.Z,re.p,Qe.O]]}),l})();var he=h(70024),kt=h(59429);let Wt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=a.oAB({type:l}),l.\u0275inj=a.cJS({imports:[[E.ez,Et,_.u5,_.UX,ie.q,oe.Z,Ht,he.EC,he.Yy,he.K,kt.kx,re.p,ke.J]]}),l})()}}]);